{"file_contents":{"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/hooks/use-location.tsx":{"content":"import { useState, useEffect } from 'react';\n\ninterface Location {\n  latitude: number;\n  longitude: number;\n}\n\ninterface LocationError {\n  code: number;\n  message: string;\n}\n\ninterface UseLocationReturn {\n  location: Location | null;\n  error: LocationError | null;\n  loading: boolean;\n  getCurrentLocation: () => void;\n}\n\nexport function useLocation(): UseLocationReturn {\n  const [location, setLocation] = useState<Location | null>(null);\n  const [error, setError] = useState<LocationError | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  const getCurrentLocation = () => {\n    if (!navigator.geolocation) {\n      setError({\n        code: 0,\n        message: 'Geolocation is not supported by this browser.'\n      });\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        setLocation({\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude,\n        });\n        setLoading(false);\n      },\n      (err) => {\n        setError({\n          code: err.code,\n          message: err.message,\n        });\n        setLoading(false);\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 300000, // 5 minutes\n      }\n    );\n  };\n\n  useEffect(() => {\n    // Automatically get location on mount\n    getCurrentLocation();\n  }, []);\n\n  return {\n    location,\n    error,\n    loading,\n    getCurrentLocation,\n  };\n}\n\n// Helper function to calculate distance between two coordinates\nexport function calculateDistance(\n  lat1: number,\n  lon1: number,\n  lat2: number,\n  lon2: number\n): number {\n  const R = 6371; // Radius of the Earth in kilometers\n  const dLat = (lat2 - lat1) * (Math.PI / 180);\n  const dLon = (lon2 - lon1) * (Math.PI / 180);\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(lat1 * (Math.PI / 180)) *\n      Math.cos(lat2 * (Math.PI / 180)) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const distance = R * c; // Distance in kilometers\n  return Math.round(distance * 10) / 10; // Round to 1 decimal place\n}\n","size_bytes":2183},"client/src/pages/restaurants.tsx":{"content":"// client/src/pages/restaurants.tsx (FIXED AND CLEANED)\n\nimport { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, UtensilsCrossed, Star, MapPin, Phone, Clock, Calendar, Users, Leaf, Loader2 } from \"lucide-react\";\nimport type { ServiceProvider, User, ServiceCategory, RestaurantMenuItem } from \"@shared/schema\";\n\n// Type definitions\ntype RestaurantProvider = ServiceProvider & { user: User; category: ServiceCategory };\n\nconst cuisineTypes = [\n  { value: \"all\", label: \"All Cuisines\" },\n  { value: \"Indian\", label: \"Indian\" },\n  { value: \"Chinese\", label: \"Chinese\" },\n  { value: \"Italian\", label: \"Italian\" },\n  { value: \"Continental\", label: \"Continental\" },\n  { value: \"Mexican\", label: \"Mexican\" },\n  { value: \"Thai\", label: \"Thai\" },\n];\n\nconst menuCategories = [\n  { value: \"all\", label: \"All Items\" },\n  { value: \"Starters\", label: \"Starters\" },\n  { value: \"Main Course\", label: \"Main Course\" },\n  { value: \"Desserts\", label: \"Desserts\" },\n  { value: \"Beverages\", label: \"Beverages\" },\n];\n\nconst timeSlots = [\n  \"11:00 AM - 12:00 PM\",\n  \"12:00 PM - 1:00 PM\",\n  \"1:00 PM - 2:00 PM\",\n  \"2:00 PM - 3:00 PM\",\n  \"6:00 PM - 7:00 PM\",\n  \"7:00 PM - 8:00 PM\",\n  \"8:00 PM - 9:00 PM\",\n  \"9:00 PM - 10:00 PM\",\n];\n\nexport default function Restaurants() {\n  const { toast } = useToast();\n  const [selectedCuisine, setSelectedCuisine] = useState(\"all\");\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\n  const [vegOnly, setVegOnly] = useState(false);\n  const [selectedRestaurant, setSelectedRestaurant] = useState<RestaurantProvider | null>(null);\n  const [bookingOpen, setBookingOpen] = useState(false);\n\n  // Booking form state\n  const [bookingDate, setBookingDate] = useState(\"\");\n  const [timeSlot, setTimeSlot] = useState(\"\");\n  const [numberOfGuests, setNumberOfGuests] = useState(\"2\");\n  const [specialRequests, setSpecialRequests] = useState(\"\");\n\n  // --- Restaurant query (FIXED) ---\n  const { data: restaurants, isLoading: loadingRestaurants } = useQuery<RestaurantProvider[]>({\n    queryKey: [\"restaurantsList\", \"restaurants\"], \n    queryFn: () => \n      apiRequest(\"GET\", \"/api/service-providers?category=restaurants\")\n        .then(res => res.json()),\n  });\n\n  // --- Menu items query (FIXED) ---\n  const { data: allMenuItems, isLoading: loadingMenu } = useQuery<RestaurantMenuItem[]>({\n    queryKey: [\"allRestaurantMenuItems\"], \n    queryFn: () => \n      apiRequest(\"GET\", \"/api/restaurant-menu-items\") \n        .then(res => res.json()),\n  });\n\n  const bookingMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const response = await apiRequest(\"POST\", `/api/table-bookings`, data);\n      if (!response.ok) {\n        const err = await response.json();\n        throw new Error(err.message || \"Booking failed\");\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Booking Requested\",\n        description: \"Your table booking request has been sent to the restaurant.\",\n      });\n      setBookingOpen(false);\n      resetBookingForm();\n      queryClient.invalidateQueries({ queryKey: [\"userTableBookings\"] }); \n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Booking Failed\",\n        description: error.message || \"Failed to create booking. Are you logged in?\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const resetBookingForm = () => {\n    setBookingDate(\"\");\n    setTimeSlot(\"\");\n    setNumberOfGuests(\"2\");\n    setSpecialRequests(\"\");\n  };\n\n  const handleBookTable = () => {\n    if (!bookingDate || !timeSlot) {\n      toast({\n        title: \"Missing Information\",\n        description: \"Please select date and time slot\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    bookingMutation.mutate({\n      providerId: selectedRestaurant?.id,\n      date: new Date(bookingDate),\n      timeSlot,\n      numberOfGuests: parseInt(numberOfGuests),\n      specialRequests,\n    });\n  };\n\n  // Filter menu items\n  const filteredMenuItems = allMenuItems?.filter((item) => {\n    if (selectedCategory !== \"all\" && item.category !== selectedCategory) return false;\n\n    const restaurantForThisItem = restaurants?.find(r => r.id === item.providerId);\n    if (!restaurantForThisItem) return false; // Agar restaurant nahi mila toh item mat dikhao\n\n    if (selectedCuisine !== \"all\" && !restaurantForThisItem.specializations?.includes(selectedCuisine)) return false;\n\n    if (vegOnly && !item.isVeg) return false;\n    return true;\n  }) || [];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section */}\n      <section className=\"bg-gradient-to-r from-amber-500 to-orange-600 text-white py-12\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"mb-4 text-white hover:bg-white/20\" data-testid=\"button-back\">\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Home\n            </Button>\n          </Link>\n\n          <div className=\"flex items-center gap-3 mb-4\">\n            <UtensilsCrossed className=\"h-12 w-12\" />\n            <h1 className=\"text-4xl md:text-5xl font-bold\">Restaurants</h1>\n          </div>\n          <p className=\"text-lg md:text-xl opacity-90 max-w-3xl\">\n            Book tables at your favorite restaurants and explore diverse cuisines\n          </p>\n        </div>\n      </section>\n\n      {/* Filters Section */}\n      <section className=\"bg-muted/30 py-6 border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            <div className=\"flex-1\">\n              <Select value={selectedCuisine} onValueChange={setSelectedCuisine}>\n                <SelectTrigger data-testid=\"select-cuisine\">\n                  <SelectValue placeholder=\"Cuisine Type\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {cuisineTypes.map((cuisine) => (\n                    <SelectItem key={cuisine.value} value={cuisine.value}>\n                      {cuisine.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"flex-1\">\n              <Select value={selectedCategory} onValueChange={setSelectedCategory}>\n                <SelectTrigger data-testid=\"select-category\">\n                  <SelectValue placeholder=\"Menu Category\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {menuCategories.map((cat) => (\n                    <SelectItem key={cat.value} value={cat.value}>\n                      {cat.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <Button\n              variant={vegOnly ? \"default\" : \"outline\"}\n              onClick={() => setVegOnly(!vegOnly)}\n              className=\"flex items-center gap-2\"\n              data-testid=\"button-veg-filter\"\n            >\n              <Leaf className=\"h-4 w-4\" />\n              Veg Only\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Restaurants Section */}\n      <section className=\"py-12\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <h2 className=\"text-3xl font-bold mb-8\">Top Restaurants Near You</h2>\n\n          {loadingRestaurants ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[1, 2, 3].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"h-48 bg-muted rounded-lg mb-4\" />\n                    <div className=\"h-6 bg-muted rounded mb-2 w-3/4\" />\n                    <div className=\"h-4 bg-muted rounded w-full\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : restaurants && restaurants.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {restaurants.map((restaurant) => (\n                <Card key={restaurant.id} className=\"hover:shadow-lg transition-shadow\" data-testid={`card-restaurant-${restaurant.id}`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div>\n                        <h3 className=\"text-xl font-semibold mb-1\">{restaurant.businessName}</h3>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-2\">\n                          <MapPin className=\"h-3 w-3\" />\n                          <span>{restaurant.address}</span>\n                        </div>\n                      </div>\n                      {restaurant.rating && (\n                        <div className=\"flex items-center gap-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-100 px-2 py-1 rounded\">\n                          <Star className=\"h-3 w-3 fill-current\" />\n                          <span className=\"text-sm font-semibold\">{restaurant.rating}</span>\n                        </div>\n                      )}\n                    </div>\n\n                    {restaurant.description && (\n                      <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">\n                        {restaurant.description}\n                      </p>\n                    )}\n\n                    <div className=\"flex flex-wrap gap-2 mb-4\">\n                      {restaurant.specializations?.slice(0, 3).map((spec: string, idx: number) => (\n                        <Badge key={idx} variant=\"secondary\" className=\"text-xs\">\n                          {spec}\n                        </Badge>\n                      ))}\n                    </div>\n\n                    <div className=\"flex gap-2\">\n                      <Dialog open={bookingOpen && selectedRestaurant?.id === restaurant.id} onOpenChange={(open) => {\n                        setBookingOpen(open);\n                        if (open) setSelectedRestaurant(restaurant);\n                        if (!open) resetBookingForm(); \n                      }}>\n                        <DialogTrigger asChild>\n                          <Button className=\"flex-1\" data-testid={`button-book-${restaurant.id}`}>\n                            <Calendar className=\"h-4 w-4 mr-2\" />\n                            Book Table\n                          </Button>\n                        </DialogTrigger>\n                        <DialogContent>\n                          <DialogHeader>\n                            <DialogTitle>Book a Table at {restaurant.businessName}</DialogTitle>\n                          </DialogHeader>\n                          <div className=\"space-y-4 py-4\">\n                            <div>\n                              <Label htmlFor=\"date\">Date</Label>\n                              <Input\n                                id=\"date\"\n                                type=\"date\"\n                                value={bookingDate}\n                                onChange={(e) => setBookingDate(e.target.value)}\n                                min={new Date().toISOString().split('T')[0]}\n                                data-testid=\"input-booking-date\"\n                              />\n                            </div>\n                            <div>\n                              <Label htmlFor=\"time-slot\">Time Slot</Label>\n                              <Select value={timeSlot} onValueChange={setTimeSlot}>\n                                <SelectTrigger data-testid=\"select-time-slot\">\n                                  <SelectValue placeholder=\"Select time slot\" />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  {timeSlots.map((slot) => (\n                                    <SelectItem key={slot} value={slot}>\n                                      {slot}\n                                    </SelectItem>\n                                  ))}\n                                </SelectContent>\n                              </Select>\n                            </div>\n                            <div>\n                              <Label htmlFor=\"guests\">Number of Guests</Label>\n                              <Input\n                                id=\"guests\"\n                                type=\"number\"\n                                min=\"1\"\n                                max=\"20\"\n                                value={numberOfGuests}\n                                onChange={(e) => setNumberOfGuests(e.target.value)}\n                                data-testid=\"input-guests\"\n                              />\n                            </div>\n                            <div>\n                              <Label htmlFor=\"requests\">Special Requests (Optional)</Label>\n                              <Textarea\n                                id=\"requests\"\n                                value={specialRequests}\n                                onChange={(e) => setSpecialRequests(e.target.value)}\n                                placeholder=\"Any special requirements or dietary restrictions...\"\n                                data-testid=\"textarea-requests\"\n                              />\n                            </div>\n                            <Button \n                              onClick={handleBookTable} \n                              className=\"w-full\"\n                              disabled={bookingMutation.isPending}\n                              data-testid=\"button-confirm-booking\"\n                            >\n                              {bookingMutation.isPending ? <><Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> Booking...</> : \"Confirm Booking\"}\n                            </Button>\n                          </div>\n                        </DialogContent>\n                      </Dialog>\n                      <Button variant=\"outline\" size=\"icon\" data-testid={`button-call-${restaurant.id}`}>\n                        <Phone className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-12 text-center\">\n                <UtensilsCrossed className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground\" />\n                <p className=\"text-xl text-muted-foreground\">No restaurants found in your area</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">Try adjusting your location or check back later</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </section>\n\n      {/* Menu Items Section */}\n      <section className=\"py-12 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <h2 className=\"text-3xl font-bold mb-8\">Popular Dishes</h2>\n\n          {loadingMenu ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              {[1, 2, 3, 4].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <div className=\"h-48 bg-muted rounded-t-lg\" />\n                  <CardContent className=\"p-4\">\n                    <div className=\"h-5 bg-muted rounded mb-2 w-3/4\" />\n                    <div className=\"h-4 bg-muted rounded w-full\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredMenuItems.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              {filteredMenuItems.map((item) => (\n                <Card key={item.id} className=\"overflow-hidden hover:shadow-lg transition-shadow\" data-testid={`card-item-${item.id}`}>\n                  {item.imageUrl && (\n                    <div className=\"h-48 overflow-hidden\">\n                      <img \n                        src={item.imageUrl} \n                        alt={item.name}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    </div>\n                  )}\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between mb-2\">\n                      <h3 className=\"font-semibold text-lg\">{item.name}</h3>\n                      <div className=\"flex gap-1\">\n                        {item.isVeg && (\n                          <div className=\"border-2 border-green-600 p-0.5 w-5 h-5 flex items-center justify-center\">\n                            <div className=\"w-2 h-2 rounded-full bg-green-600\" />\n                          </div>\n                        )}\n                        {!item.isVeg && (\n                          <div className=\"border-2 border-red-600 p-0.5 w-5 h-5 flex items-center justify-center\">\n                            <div className=\"w-2 h-2 rounded-full bg-red-600\" />\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    {item.description && (\n                      <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                        {item.description}\n                      </p>\n                    )}\n\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <span className=\"text-xl font-bold text-primary\">â‚¹{item.price}</span>\n                      {item.cuisine && (\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {item.cuisine}\n                        </Badge>\n                      )}\n                    </div>\n\n                    {item.category && (\n                      <Badge variant=\"secondary\" className=\"text-xs mb-3\">\n                        {item.category}\n                      </Badge>\n                    )}\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-12 text-center\">\n                <p className=\"text-lg text-muted-foreground\">No items match your filters</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">Try adjusting your cuisine or category selection</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </section>\n    </div>\n  );\n}","size_bytes":19190},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/provider-card.tsx":{"content":"import { Link } from \"wouter\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Star, \n  MapPin, \n  Clock, \n  Briefcase, \n  CheckCircle\n} from \"lucide-react\";\n\ninterface ProviderCardProps {\n  provider: {\n    id: string;\n    businessName: string;\n    rating: string;\n    reviewCount: number;\n    experience: number;\n    address: string;\n    isVerified: boolean;\n    isAvailable: boolean;\n    specializations?: string[];\n    user: {\n      username: string;\n      email: string;\n    };\n  };\n  categorySlug?: string;\n}\n\nexport default function ProviderCard({ \n  provider,\n  categorySlug = \"electrician\"\n}: ProviderCardProps) {\n  const rating = parseFloat(provider.rating);\n  const distance = \"2.3 km\"; // Mock distance - in real app this would be calculated\n\n  return (\n    <Link href={`/${categorySlug}/${provider.id}`}>\n      <Card className=\"provider-card border border-border hover:shadow-lg transition-all cursor-pointer hover:border-primary\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n            <div className=\"flex items-start space-x-4 flex-1\">\n            {/* Provider Image */}\n            <div className=\"w-16 h-16 bg-muted rounded-lg overflow-hidden flex-shrink-0\">\n              <div className=\"w-full h-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-semibold\">\n                {provider.user.username.charAt(0).toUpperCase()}\n              </div>\n            </div>\n            \n            {/* Provider Details */}\n            <div className=\"flex-1\">\n              <div className=\"flex items-start justify-between mb-2\">\n                <div>\n                  <h4 className=\"font-semibold text-lg\">{provider.businessName}</h4>\n                  <div className=\"flex items-center space-x-1 mt-1\">\n                    <div className=\"flex items-center rating-stars\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star \n                          key={i}\n                          className={`h-4 w-4 ${\n                            i < Math.floor(rating) \n                              ? \"fill-current\" \n                              : i === Math.floor(rating) && rating % 1 >= 0.5\n                              ? \"fill-current opacity-50\"\n                              : \"text-muted-foreground\"\n                          }`}\n                        />\n                      ))}\n                    </div>\n                    <span className=\"text-sm font-medium\">{rating}</span>\n                    <span className=\"text-sm text-muted-foreground\">\n                      ({provider.reviewCount} reviews)\n                    </span>\n                  </div>\n                </div>\n                {provider.isVerified && (\n                  <Badge variant=\"secondary\" className=\"flex items-center\">\n                    <CheckCircle className=\"h-3 w-3 mr-1\" />\n                    Verified\n                  </Badge>\n                )}\n              </div>\n              \n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 mt-3\">\n                <div className=\"flex items-center space-x-2 text-sm\">\n                  <Briefcase className=\"h-4 w-4 text-muted-foreground\" />\n                  <span>{provider.experience} years exp.</span>\n                </div>\n                <div className=\"flex items-center space-x-2 text-sm\">\n                  <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                  <span>{distance} away</span>\n                </div>\n                <div className=\"flex items-center space-x-2 text-sm\">\n                  <Clock className=\"h-4 w-4 text-muted-foreground\" />\n                  <span>\n                    {provider.isAvailable ? \"Available Now\" : \"Busy\"}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"mt-3\">\n                <p className=\"text-sm text-muted-foreground\">{provider.address}</p>\n              </div>\n\n              {/* Specializations */}\n              {provider.specializations && provider.specializations.length > 0 && (\n                <div className=\"flex flex-wrap gap-2 mt-3\">\n                  {provider.specializations.map((spec, index) => (\n                    <Badge key={index} variant=\"outline\" className=\"text-xs\">\n                      {spec}\n                    </Badge>\n                  ))}\n                </div>\n              )}\n            </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </Link>\n  );\n}\n","size_bytes":4647},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/grocery/product-card.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ShoppingBag, Minus, Plus } from \"lucide-react\";\n\ninterface ProductCardProps {\n  product: {\n    id: string;\n    name: string;\n    price: string | number; // Price string ya number ho sakta hai\n    weight?: string;\n    imageUrl?: string;\n    category?: string;\n    inStock?: boolean;\n  };\n  onAddToCart: (product: any) => void;\n  quantity: number;\n  onIncreaseQuantity: () => void;\n  onDecreaseQuantity: () => void;\n}\n\nexport default function ProductCard({\n  product,\n  onAddToCart,\n  quantity,\n  onIncreaseQuantity,\n  onDecreaseQuantity,\n}: ProductCardProps) {\n  // Price ko number me convert karo\n  const priceAsNumber = parseFloat(product.price as string);\n\n  return (\n    <Card className=\"overflow-hidden hover:shadow-lg transition-shadow\">\n      {product.imageUrl ? (\n        <img\n          src={product.imageUrl}\n          alt={product.name}\n          className=\"w-full h-48 object-cover\"\n        />\n      ) : (\n        <div className=\"w-full h-48 bg-muted flex items-center justify-center\">\n          <ShoppingBag className=\"h-16 w-16 text-muted-foreground\" />\n        </div>\n      )}\n      <CardContent className=\"p-4\">\n        <h3 className=\"font-semibold text-lg truncate\">{product.name}</h3>\n        {product.weight && <p className=\"text-sm text-muted-foreground\">{product.weight}</p>}\n        <div className=\"flex items-center justify-between mt-4\">\n          {/* --- YAHAN BADLAV KIYA HAI --- */}\n          <span className=\"text-xl font-bold text-primary\">â‚¹{priceAsNumber.toFixed(2)}</span>\n          {product.category && <Badge variant=\"outline\">{product.category}</Badge>}\n        </div>\n\n        {quantity === 0 ? (\n          <Button\n            className=\"w-full mt-4\"\n            onClick={() => onAddToCart(product)}\n            disabled={!product.inStock}\n          >\n            {product.inStock ? 'Add to Cart' : 'Out of Stock'}\n          </Button>\n        ) : (\n          <div className=\"flex justify-between items-center mt-4 border rounded-lg p-1\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-primary\"\n              onClick={onDecreaseQuantity}\n              disabled={quantity <= 1}\n            >\n              <Minus className=\"h-4 w-4\" />\n            </Button>\n            <span className=\"font-medium text-lg\">{quantity}</span>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-primary\"\n              onClick={onIncreaseQuantity}\n            >\n              <Plus className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":2801},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"..\", \"dist\", \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n      res.sendFile(path.resolve(distPath, \"index.html\"));\n    });\n  }\n","size_bytes":2283},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/pages/grocery.tsx":{"content":"// client/src/pages/Grocery.tsx (MODIFIED FOR providerId)\nimport { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport ProductCard from \"@/components/grocery/product-card\";\nimport { useCartStore } from \"@/hooks/use-cart-store\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nimport {\n  ArrowLeft,\n  Search,\n  Filter,\n  Apple,\n  Carrot,\n  Milk,\n  Croissant,\n  Cookie,\n  Coffee,\n  ShoppingBag,\n  Sparkles,\n  Loader2, // Loader icon add kiya\n} from \"lucide-react\";\nimport type { ServiceProvider, User, ServiceCategory, GroceryProduct } from \"@shared/schema\"; // Types import kiye\n\n// Categories list wahi rahegi\nconst categories = [\n  { name: \"Fruits\", icon: Apple, slug: \"fruits\" },\n  { name: \"Vegetables\", icon: Carrot, slug: \"vegetables\" },\n  { name: \"Dairy\", icon: Milk, slug: \"dairy\" },\n  { name: \"Bakery\", icon: Croissant, slug: \"bakery\" },\n  { name: \"Snacks\", icon: Cookie, slug: \"snacks\" },\n  { name: \"Beverages\", icon: Coffee, slug: \"beverages\" },\n  { name: \"Staples\", icon: ShoppingBag, slug: \"staples\" },\n  { name: \"Toiletries\", icon: Sparkles, slug: \"toiletries\" },\n  { name: \"Personal Care\", icon: Sparkles, slug: \"personal-care\" },\n];\n\n// Type define kiya service provider ke liye\ntype GMartProvider = ServiceProvider & { user: User; category: ServiceCategory };\n\n// API function GMart provider ko fetch karne ke liye\nconst fetchGmartProvider = async (): Promise<GMartProvider | undefined> => {\n  const res = await fetch(`/api/service-providers?category=grocery`);\n  if (!res.ok) {\n    throw new Error('Failed to fetch GMart provider');\n  }\n  const providers: GMartProvider[] = await res.json();\n  // Hum assume kar rahe hain ki GMart ka ek hi official provider hai\n  return providers[0]; \n};\n\n// API function grocery products fetch karne ke liye (ab providerId lega)\nconst fetchGroceryProducts = async ({ queryKey }: { queryKey: [string, string | undefined, string] }): Promise<GroceryProduct[]> => {\n  const [, providerId, search] = queryKey;\n\n  if (!providerId) {\n    // Agar providerId nahi hai, toh fetch mat karo\n    return [];\n  }\n\n  const url = `/api/grocery-products?providerId=${providerId}&${search ? `search=${search}` : ''}`;\n  const res = await fetch(url);\n  if (!res.ok) {\n    throw new Error('Failed to fetch grocery products');\n  }\n  return res.json();\n};\n\n// --- YEH HAI NAYA LOADING COMPONENT ---\nfunction GMartLoading() {\n  return (\n    <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8\">\n      {[...Array(8)].map((_, i) => (\n        <Card key={i} className=\"animate-pulse\">\n          <div className=\"aspect-square bg-muted\"></div>\n          <CardContent className=\"p-3\">\n            <div className=\"h-4 bg-muted rounded mb-2\"></div>\n            <div className=\"h-3 bg-muted rounded mb-2\"></div>\n            <div className=\"flex justify-between items-center\">\n              <div className=\"h-4 bg-muted rounded w-16\"></div>\n              <div className=\"w-8 h-8 bg-muted rounded-full\"></div>\n            </div>\n          </CardContent>\n        </Card>\n      ))}\n    </div>\n  );\n}\n\nexport default function Grocery() {\n  const [, setLocation] = useLocation();\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"\"); // Yeh abhi sirf UI ke liye hai\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const { items, addItem, updateQuantity, getTotalPrice } = useCartStore();\n  const { toast } = useToast();\n\n  // --- STEP 1: GMart Provider ko fetch karo ---\n  const { data: gmartProvider, isLoading: isLoadingProvider } = useQuery({\n    queryKey: [\"gmartProvider\"],\n    queryFn: fetchGmartProvider,\n  });\n\n  const gmartProviderId = gmartProvider?.id;\n\n  // --- STEP 2: Provider ID milne ke baad hi products fetch karo ---\n  const { data: products, isLoading: isLoadingProducts } = useQuery({\n    queryKey: [\"groceryProducts\", gmartProviderId, searchQuery],\n    queryFn: fetchGroceryProducts,\n    enabled: !!gmartProviderId, // Yeh query tabhi chalegi jab providerId mil jayega\n  });\n\n  const handleCategorySelect = (categorySlug: string) => {\n    setSelectedCategory(selectedCategory === categorySlug ? \"\" : categorySlug);\n    // TODO: Ab category select pe client-side filter kar sakte hain,\n    // ya backend API ko update kar sakte hain ki woh providerId + category dono le.\n    // Abhi ke liye, yeh sirf UI highlight karega.\n  };\n\n  const handleAddToCart = (product: GroceryProduct) => {\n    const existingItem = items.find(item => item.id === product.id);\n    if (existingItem) {\n      updateQuantity(product.id, 1);\n      toast({\n        title: \"âž• Quantity Updated!\",\n        description: `${product.name} quantity increased to ${existingItem.quantity + 1}.`,\n      });\n    } else {\n      addItem({\n        id: product.id,\n        name: product.name,\n        price: parseFloat(product.price),\n        imageUrl: product.imageUrl || undefined,\n        quantity: 1, // Store 'quantity' 1 se start karega\n      });\n      toast({\n        title: \"âœ… Added to Cart!\",\n        description: `${product.name} has been added to your cart.`,\n      });\n    }\n  };\n\n  // Filtered products (client-side category filter)\n  const filteredProducts = products\n    ? products.filter(product => \n        selectedCategory ? product.category === selectedCategory : true\n      )\n    : [];\n\n  const isLoading = isLoadingProvider || isLoadingProducts;\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/\")}\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Services</span>\n        </Button>\n\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            {/* Ab provider ka naam dikha sakte hain */}\n            <h2 className=\"text-3xl font-bold mb-2\">\n              {gmartProvider ? gmartProvider.businessName : \"GMart Grocery\"}\n            </h2>\n            <p className=\"text-muted-foreground\">\n              {gmartProvider ? gmartProvider.description : \"Fresh groceries...\"}\n            </p>\n          </div>\n          <div className=\"text-right\">\n            <p className=\"text-sm text-muted-foreground\">Delivery Charges</p>\n            <p className=\"text-lg font-semibold\">â‚¹7 per km + 1% platform fee</p>\n          </div>\n        </div>\n\n        {/* Categories Navigation */}\n        <Card className=\"mb-6\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center space-x-4 overflow-x-auto pb-2\">\n              {categories.map((category) => (\n                <Button\n                  key={category.slug}\n                  variant={selectedCategory === category.slug ? \"default\" : \"ghost\"}\n                  className=\"flex-shrink-0 flex flex-col items-center p-3 h-auto\"\n                  onClick={() => handleCategorySelect(category.slug)}\n                >\n                  <div className={`w-12 h-12 rounded-full flex items-center justify-center mb-2 ${\n                    selectedCategory === category.slug\n                      ? \"bg-primary-foreground\"\n                      : \"bg-secondary/10\"\n                  }`}>\n                    <category.icon className={`h-6 w-6 ${\n                      selectedCategory === category.slug\n                        ? \"text-primary\"\n                        : \"text-secondary\"\n                    }`} />\n                  </div>\n                  <span className=\"text-xs font-medium\">{category.name}</span>\n                </Button>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Search and Filter */}\n        <div className=\"flex items-center space-x-4 mb-6\">\n          <div className=\"flex-1 relative\">\n            <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Search for products...\"\n              className=\"pl-12\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n            />\n          </div>\n          <Button variant=\"outline\" className=\"flex items-center space-x-2\">\n            <Filter className=\"h-4 w-4\" />\n            <span>Filter</span>\n          </Button>\n        </div>\n\n        {/* Products Grid */}\n        {isLoading ? (\n          <GMartLoading />\n        ) : filteredProducts.length === 0 ? (\n          <Card className=\"col-span-full\">\n            <CardContent className=\"p-8 text-center\">\n              <Search className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No products found</h3>\n              <p className=\"text-muted-foreground\">\n                {searchQuery ? 'Try a different search term' : 'Try selecting a different category or clearing filters.'}\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8\">\n            {filteredProducts.map((product: GroceryProduct) => (\n              <ProductCard\n                key={product.id}\n                product={product}\n                onAddToCart={() => handleAddToCart(product)}\n                quantity={items.find(item => item.id === product.id)?.quantity || 0}\n                onIncreaseQuantity={() => updateQuantity(product.id, 1)}\n                onDecreaseQuantity={() => updateQuantity(product.id, -1)}\n              />\n            ))}\n          </div>\n        )}\n\n        {/* Cart Summary (neeche waala bar) */}\n        {items.length > 0 && (\n          <div className=\"fixed bottom-0 left-0 right-0 bg-card p-4 shadow-lg border-t z-50 animate-slide-up-fast\">\n            <div className=\"max-w-7xl mx-auto flex justify-between items-center\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">{items.reduce((total, item) => total + item.quantity, 0)} Items</p>\n                <p className=\"text-xl font-bold\">â‚¹{getTotalPrice().toFixed(2)}</p>\n              </div>\n              <Button onClick={() => setLocation(\"/checkout\")} size=\"lg\">\n                Proceed to Checkout\n                <ShoppingBag className=\"ml-2 h-5 w-5\" />\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":10600},"replit.md":{"content":"# ServiceHub - Multi-Service Marketplace Platform\n\n## Overview\n\nServiceHub is a comprehensive multi-service marketplace platform that connects customers with local service providers across eight different categories: Electrician, Plumber, Beauty Parlor, Cake Shop, Grocery (GMart), Rental Properties, Street Food, and Restaurants. The platform operates on a hybrid model - offering free listings for service providers with optional paid features, while charging customers a 1-10% platform fee depending on the service category.\n\nThe application is built as a modern full-stack web application with a React-based frontend and Express.js backend, designed to facilitate service discovery, booking, and transactions in a user-friendly marketplace environment.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## Recent Updates\n\n### Electrician Booking System (Added: 2025-10-16)\n- **Problem Categories**: Updated with 6 device categories (AC, Refrigerator, TV, Water Heater, Washing Machine, Microwave) and 40+ specific problems\n- **Search & Filter**: Electrician listing page with search bar and appliance/problem filters\n- **Provider Profiles**: Detailed electrician pages showing all problems they can fix\n- **Slot Booking**: Complete booking system with date/time slot selection\n- **Notification System**: Provider dashboard for accepting/declining bookings, customer booking status page\n- **Routes Added**: `/electrician/:id`, `/provider-dashboard`, `/my-bookings`\n\n### Twilio SMS Notification System (Added: 2025-10-16)\n- **Status**: Active - Twilio connection configured successfully\n- **Implementation**: SMS notifications sent automatically when providers accept/decline bookings\n- **Features**: \n  - Provider accepts booking â†’ Customer receives SMS with confirmation and scheduled date\n  - Provider declines booking â†’ Customer receives SMS suggesting to find another provider\n  - Phone number validation with country code requirement in booking form\n- **Technical**: Custom `server/twilio-client.ts` utility using Replit Twilio connection\n- **Fallback**: In-app notifications available on provider dashboard and customer bookings page\n\n### Authentication System (Added: 2025-10-16)\n- **Session-Based Authentication**: Implemented with Express sessions and PostgreSQL session store\n- **User Management**: \n  - Login and signup flows with email/username/password\n  - Bcrypt password hashing for security\n  - Role-based access control (customer/provider/admin)\n- **Provider Onboarding**: Two-step registration process\n  - Step 1: Create user account with role selection\n  - Step 2: Complete business profile (for providers only)\n- **Auth Context**: React context (`useAuth` hook) provides global auth state\n  - User info available throughout the app\n  - Automatic redirect to login for unauthenticated users\n  - Role-based UI rendering (provider dashboard, customer bookings)\n- **Header Integration**: Dynamic user menu with login/signup or user dropdown\n  - Dropdown shows username, role-specific links (Provider Dashboard, My Bookings)\n  - Logout functionality clears session and redirects\n- **Protected Routes**: All booking and dashboard features use real authenticated user IDs\n  - Booking form uses `user.id` instead of mock IDs\n  - Provider dashboard fetches bookings by provider profile ID\n  - Customer bookings page shows user-specific bookings\n- **Routes**: `/login`, `/signup`, `/provider-onboarding`\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework & Build System**\n- React 18+ with TypeScript for type-safe component development\n- Vite as the build tool and development server for fast hot module replacement\n- Wouter for lightweight client-side routing\n- TanStack Query (React Query) for server state management with configured stale-time and refetch policies\n\n**UI Component System**\n- Radix UI primitives for accessible, unstyled component foundations\n- Shadcn/ui component library with \"new-york\" style variant\n- Tailwind CSS for utility-first styling with CSS variables for theming\n- Custom design system based on marketplace aesthetics (Airbnb-inspired cards, Swiggy-like service differentiation)\n\n**State Management Strategy**\n- Zustand for client-side cart state with persistence middleware\n- React Query for all server-state (service providers, products, bookings)\n- React Context for global authentication state (`AuthProvider` + `useAuth` hook)\n- Custom hooks for geolocation (`useLocation`) and responsive design (`useIsMobile`)\n\n**Key Design Patterns**\n- Component composition using Radix Slot pattern\n- Shared UI components in `/components/ui` following atomic design principles\n- Service-specific pages with dedicated filtering and booking flows\n- Responsive-first mobile design with conditional desktop layouts\n\n### Backend Architecture\n\n**Server Framework**\n- Express.js with TypeScript for API routes\n- ESM module system for modern JavaScript features\n- Development mode uses tsx for hot-reloading, production uses compiled bundles via esbuild\n\n**API Design**\n- RESTful endpoints organized by resource type\n- Middleware for request logging with response time tracking\n- JSON body parsing with raw body capture for webhook verification\n- CORS and security headers configured for cross-origin requests\n\n**Route Organization**\n- Service categories: `/api/service-categories`\n- Service providers: `/api/service-providers` (with location-based filtering)\n- Bookings: `/api/bookings` (for electrician/plumber/beauty services)\n- E-commerce: `/api/grocery-products`, `/api/grocery-orders`\n- Real estate: `/api/rental-properties`\n- Restaurants: `/api/table-bookings`, `/api/restaurant-menu-items`\n- Street food: `/api/street-food-items`\n\n**Business Logic Layer**\n- Storage abstraction layer (`server/storage.ts`) provides interface for data operations\n- Separation of concerns between route handlers and data access\n- Location-based search using latitude/longitude with configurable radius\n\n### Database Architecture\n\n**ORM & Schema Design**\n- Drizzle ORM for type-safe database queries with PostgreSQL dialect\n- Schema defined in `/shared/schema.ts` for sharing between frontend and backend\n- Zod schema generation for runtime validation using `drizzle-zod`\n\n**Data Models**\n- **Users**: Authentication, roles (customer/provider/admin), Stripe integration fields\n- **Service Categories**: Eight main categories with slug-based routing\n- **Service Providers**: Business profiles linked to users and categories, with geolocation data\n- **Service Problems**: Hierarchical problem categorization for electrician/plumber services\n- **Specialized Models**: Beauty services, cake products, grocery products, rental properties, restaurant menus, street food items\n- **Transactional Models**: Bookings, grocery orders, table bookings, reviews\n\n**Database Patterns**\n- UUID primary keys using `gen_random_uuid()`\n- Foreign key relationships with cascading constraints\n- JSONB columns for flexible data (specializations, problem details)\n- Timestamp tracking for created/updated records\n- Decimal precision for ratings (3,2) and geolocation (10,8 for lat, 11,8 for lng)\n\n### Authentication & Authorization\n\n**Session Management**\n- Express session with PostgreSQL store (`connect-pg-simple`)\n- Session-based authentication (cookie credentials included in fetch requests)\n- Role-based access control (customer, provider, admin roles)\n- Session secret stored securely in environment variables\n\n**Security Implementation**\n- Bcrypt password hashing with salt rounds (10)\n- Secure session configuration with httpOnly cookies\n- HTTPS enforcement expected in production environment\n- Auth middleware validates session on protected routes\n\n**Auth Flow**\n- `/api/auth/signup` - Creates new user with hashed password\n- `/api/auth/login` - Validates credentials and creates session\n- `/api/auth/logout` - Destroys session and clears cookies\n- `/api/auth/me` - Returns current user info if authenticated\n- `/api/provider/profile` - Returns provider profile for authenticated providers\n\n### Payment Processing\n\n**Stripe Integration**\n- Stripe.js SDK for frontend payment elements\n- Stripe React components for checkout flows\n- Backend Stripe SDK for payment intent creation and webhook handling\n- Customer and subscription ID tracking in user records\n- Raw body parsing for webhook signature verification\n\n**Payment Flow**\n- Platform fee calculation: 1-10% based on service category\n- Delivery fee for grocery orders calculated by distance (â‚¹7/km)\n- Payment confirmation with return URL handling\n- Subscription support for premium provider features\n\n### Communication Services\n\n**Twilio Integration (Optional)**\n- Call routing for connecting customers with providers\n- Configured only when environment variables are present\n- Used for \"Request Call\" functionality in electrician/plumber services\n\n## External Dependencies\n\n### Third-Party Services\n\n**Payment Gateway**\n- Stripe (v5.x for React, v8.x for JS SDK) - Payment processing and subscription management\n- Requires: `STRIPE_SECRET_KEY`, `VITE_STRIPE_PUBLIC_KEY`\n\n**Database**\n- Neon Serverless PostgreSQL with WebSocket support\n- Requires: `DATABASE_URL`\n- Connection pooling via `@neondatabase/serverless`\n\n**Communication (Optional)**\n- Twilio for voice call routing\n- Requires: `TWILIO_ACCOUNT_SID`, `TWILIO_AUTH_TOKEN`\n\n### Development & Build Tools\n\n**Core Dependencies**\n- React Query for data fetching and caching\n- React Hook Form with Zod resolvers for form validation\n- Date-fns for date manipulation\n- Nanoid for unique ID generation\n\n**Development Tools**\n- Replit-specific plugins (cartographer, dev banner, runtime error overlay)\n- Vite plugins for development experience\n- TypeScript for type safety across the stack\n- ESBuild for production bundling\n\n### UI & Styling Libraries\n\n**Component Libraries**\n- @radix-ui/* - 20+ accessible component primitives\n- cmdk - Command palette component\n- embla-carousel-react - Carousel functionality\n- vaul - Drawer component\n- recharts - Chart components for analytics\n\n**Styling**\n- Tailwind CSS with PostCSS\n- class-variance-authority for variant-based styling\n- clsx and tailwind-merge for className management\n\n### Font Loading\n- Google Fonts: Inter (primary), Roboto, Outfit (headings)\n- Preconnect optimization for faster font loading\n- CSS font-display configuration for performance\n\n### Asset Management\n- Custom Vite alias for attached assets: `@assets`\n- Image optimization expected for production deployment\n- External image URLs used for mock data (Unsplash)","size_bytes":10539},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/service-card.tsx":{"content":"import { Link } from \"wouter\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ArrowRight, CheckCircle } from \"lucide-react\";\nimport type { LucideIcon } from \"lucide-react\";\n\ninterface ServiceCardProps {\n  service: {\n    name: string;\n    slug: string;\n    icon: LucideIcon;\n    description: string;\n    badge: string;\n    color: string;\n  };\n}\n\nconst colorClasses = {\n  accent: \"bg-accent/10 text-accent\",\n  primary: \"bg-primary/10 text-primary\",\n  secondary: \"bg-secondary/10 text-secondary\",\n  destructive: \"bg-destructive/10 text-destructive\"\n};\n\nexport default function ServiceCard({ service }: ServiceCardProps) {\n  const { name, slug, icon: Icon, description, badge, color } = service;\n  const iconColorClass = colorClasses[color as keyof typeof colorClasses] || colorClasses.primary;\n\n  return (\n    <Link href={`/${slug}`}>\n      <Card className=\"service-card cursor-pointer border border-border hover:shadow-lg transition-all duration-300\">\n        <CardContent className=\"p-6\">\n          <div className={`w-16 h-16 ${iconColorClass} rounded-lg flex items-center justify-center mb-4`}>\n            <Icon className=\"h-8 w-8\" />\n          </div>\n          <h3 className=\"text-xl font-semibold mb-2 text-card-foreground\">{name}</h3>\n          <p className=\"text-muted-foreground mb-4\">{description}</p>\n          <div className=\"flex items-center justify-between\">\n            <Badge \n              variant=\"secondary\" \n              className=\"text-secondary font-medium flex items-center\"\n            >\n              <CheckCircle className=\"h-3 w-3 mr-1\" />\n              {badge}\n            </Badge>\n            <ArrowRight className=\"h-4 w-4 text-primary\" />\n          </div>\n        </CardContent>\n      </Card>\n    </Link>\n  );\n}\n","size_bytes":1809},"client/src/pages/street-food.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { ArrowLeft, Sandwich, Flame, Leaf, MapPin, Star, Phone } from \"lucide-react\";\n\n// --- YEH NAYE IMPORTS ADD KIYE HAIN ---\nimport { useCartStore } from \"@/hooks/use-cart-store\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst foodCategories = [\n  { value: \"all\", label: \"All Items\" },\n  { value: \"Chaat\", label: \"Chaat\" },\n  { value: \"Rolls\", label: \"Rolls & Wraps\" },\n  { value: \"Momos\", label: \"Momos\" },\n  { value: \"Snacks\", label: \"Snacks\" },\n  { value: \"Beverages\", label: \"Beverages\" },\n  { value: \"Sweets\", label: \"Sweets\" },\n];\n\nconst spiceLevels = [\n  { value: \"all\", label: \"All Spice Levels\" },\n  { value: \"Mild\", label: \"Mild\" },\n  { value: \"Medium\", label: \"Medium\" },\n  { value: \"Hot\", label: \"Hot\" },\n];\n\nexport default function StreetFood() {\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\n  const [selectedSpiceLevel, setSelectedSpiceLevel] = useState(\"all\");\n  const [vegOnly, setVegOnly] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  // --- YEH NAYI LINES ADD KI HAIN ---\n  const { toast } = useToast();\n  const addItemToCart = useCartStore((state) => state.addItem);\n\n  const handleOrderNow = (item: any) => {\n    addItemToCart({\n      id: item.id,\n      name: item.name,\n      price: parseFloat(item.price), // Price ko number me convert kiya\n      imageUrl: item.imageUrl,\n    });\n    toast({\n      title: \"âœ… Added to Cart!\",\n      description: `${item.name} has been added to your cart.`,\n    });\n  };\n  // --- END OF NEW LINES ---\n\n  const { data: providers, isLoading: loadingProviders } = useQuery<any[]>({\n    queryKey: [\"/api/service-providers\", \"street-food\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/service-providers?category=street-food\");\n      if (!res.ok) {\n        throw new Error('Failed to fetch vendors');\n      }\n      return res.json();\n    },\n  });\n\n  const { data: items, isLoading: loadingItems } = useQuery<any[]>({\n    queryKey: [\"/api/street-food-items\", searchTerm],\n    queryFn: async () => {\n      // âœ… Naya, Smarter URL\n      const url = searchTerm\n        ? `/api/street-food-items?search=${encodeURIComponent(searchTerm)}`\n        : \"/api/street-food-items\";\n\n      const res = await fetch(url); // Sahi URL use karna\n\n      if (!res.ok) {\n        throw new Error('Failed to fetch street food items');\n      }\n      return res.json();\n    },\n  });\n  const filteredItems = items?.filter((item) => {\n    if (selectedCategory !== \"all\" && item.category !== selectedCategory) return false;\n    if (selectedSpiceLevel !== \"all\" && item.spicyLevel !== selectedSpiceLevel) return false;\n    if (vegOnly && !item.isVeg) return false;\n    return true;\n  }) || [];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <section className=\"py-8 border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h1 className=\"text-3xl font-bold\">Street Food</h1>\n            <Link href=\"/\">\n              <Button variant=\"outline\" data-testid=\"button-back\">\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Back\n              </Button>\n            </Link>\n          </div>\n\n          <div className=\"flex flex-col md:flex-row gap-4 items-center\">\n            <div className=\"flex-1 w-full\">\n              <Input\n                type=\"text\"\n                placeholder=\"Search for momos, chaat, etc...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full\"\n                data-testid=\"input-search\"\n              />\n            </div>\n            <div className=\"flex-1 w-full\">\n              <Select value={selectedCategory} onValueChange={setSelectedCategory}>\n                <SelectTrigger data-testid=\"select-category\">\n                  <SelectValue placeholder=\"Category\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {foodCategories.map((cat) => (\n                    <SelectItem key={cat.value} value={cat.value}>\n                      {cat.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"flex-1 w-full\">\n              <Select value={selectedSpiceLevel} onValueChange={setSelectedSpiceLevel}>\n                <SelectTrigger data-testid=\"select-spice\">\n                  <SelectValue placeholder=\"Spice Level\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {spiceLevels.map((level) => (\n                    <SelectItem key={level.value} value={level.value}>\n                      {level.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <Button\n              variant={vegOnly ? \"default\" : \"outline\"}\n              onClick={() => setVegOnly(!vegOnly)}\n              className=\"flex items-center gap-2\"\n              data-testid=\"button-veg-filter\"\n            >\n              <Leaf className=\"h-4 w-4\" />\n              Veg Only\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Vendors Section */}\n      <section className=\"py-12\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <h2 className=\"text-3xl font-bold mb-8\">Popular Vendors Near You</h2>\n\n          {loadingProviders ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[1, 2, 3].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"h-48 bg-muted rounded-lg mb-4\" />\n                    <div className=\"h-6 bg-muted rounded mb-2 w-3/4\" />\n                    <div className=\"h-4 bg-muted rounded w-full\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : providers && providers.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {providers.map((vendor) => (\n                <Card key={vendor.id} className=\"hover:shadow-lg transition-shadow\" data-testid={`card-vendor-${vendor.id}`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div>\n                        <h3 className=\"text-xl font-semibold mb-1\">{vendor.businessName}</h3>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <MapPin className=\"h-3 w-3\" />\n                          <span>{vendor.address}</span>\n                        </div>\n                      </div>\n                      {vendor.rating && (\n                        <div className=\"flex items-center gap-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-100 px-2 py-1 rounded\">\n                          <Star className=\"h-3 w-3 fill-current\" />\n                          <span className=\"text-sm font-semibold\">{vendor.rating}</span>\n                        </div>\n                      )}\n                    </div>\n\n                    {vendor.description && (\n                      <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">\n                        {vendor.description}\n                      </p>\n                    )}\n\n                    <div className=\"flex gap-2 mb-4\">\n                      {vendor.specializations?.slice(0, 3).map((spec: string, idx: number) => (\n                        <Badge key={idx} variant=\"secondary\" className=\"text-xs\">\n                          {spec}\n                        </Badge>\n                      ))}\n                    </div>\n\n                    <div className=\"flex gap-2\">\n                      <Link href={`/street-food/${vendor.id}`}>\n                        <Button as=\"a\" className=\"flex-1\" data-testid={`button-menu-${vendor.id}`}>\n                          View Menu\n                        </Button>\n                      </Link>\n                      <Button variant=\"outline\" size=\"icon\" data-testid={`button-call-${vendor.id}`}>\n                        <Phone className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-12 text-center\">\n                <Sandwich className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground\" />\n                <p className=\"text-xl text-muted-foreground\">No vendors found in your area</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">Try adjusting your location or check back later</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </section>\n\n      {/* Menu Items Section */}\n      <section className=\"py-12 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <h2 className=\"text-3xl font-bold mb-8\">Popular Items</h2>\n\n          {loadingItems ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              {[1, 2, 3, 4].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <div className=\"h-48 bg-muted rounded-t-lg\" />\n                  <CardContent className=\"p-4\">\n                    <div className=\"h-5 bg-muted rounded mb-2 w-3/4\" />\n                    <div className=\"h-4 bg-muted rounded w-full\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredItems.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              {filteredItems.map((item) => (\n                <Card key={item.id} className=\"overflow-hidden hover:shadow-lg transition-shadow\" data-testid={`card-item-${item.id}`}>\n                  {item.imageUrl && (\n                    <div className=\"h-48 overflow-hidden\">\n                      <img\n                        src={item.imageUrl}\n                        alt={item.name}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    </div>\n                  )}\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between mb-2\">\n                      <h3 className=\"font-semibold text-lg\">{item.name}</h3>\n                      <div className=\"flex gap-1\">\n                        {item.isVeg && (\n                          <div className=\"border-2 border-green-600 p-0.5 w-5 h-5 flex items-center justify-center\">\n                            <div className=\"w-2 h-2 rounded-full bg-green-600\" />\n                          </div>\n                        )}\n                        {!item.isVeg && (\n                          <div className=\"border-2 border-red-600 p-0.5 w-5 h-5 flex items-center justify-center\">\n                            <div className=\"w-2 h-2 rounded-full bg-red-600\" />\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    {item.description && (\n                      <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                        {item.description}\n                      </p>\n                    )}\n\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <span className=\"text-xl font-bold text-primary\">â‚¹{item.price}</span>\n                      {item.spicyLevel && (\n                        <Badge variant={\n                          item.spicyLevel === 'Hot' ? 'destructive' :\n                          item.spicyLevel === 'Medium' ? 'default' : 'secondary'\n                        } className=\"flex items-center gap-1\">\n                          <Flame className=\"h-3 w-3\" />\n                          {item.spicyLevel}\n                        </Badge>\n                      )}\n                    </div>\n\n                    {item.category && (\n                      <Badge variant=\"outline\" className=\"text-xs mb-3\">\n                        {item.category}\n                      </Badge>\n                    )}\n\n                    <Button\n                      className=\"w-full\"\n                      disabled={!item.isAvailable}\n                      data-testid={`button-order-${item.id}`}\n                      onClick={() => handleOrderNow(item)} // <-- YEH LINE ADD KI HAI\n                    >\n                      {item.isAvailable ? 'Order Now' : 'Out of Stock'}\n                    </Button>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-12 text-center\">\n                <p className=\"text-lg text-muted-foreground\">No items match your filters</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">Try adjusting your filters</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </section>\n    </div>\n  );\n}","size_bytes":13663},"client/src/components/grocery/cart-summary.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronUp, ChevronDown, Plus, Minus, Trash2 } from \"lucide-react\";\nimport type { CartItem } from \"@/hooks/use-cart\";\n\ninterface CartSummaryProps {\n  items: CartItem[];\n  onUpdateQuantity: (id: string, quantity: number) => void;\n  onProceedToCheckout: () => void;\n}\n\nexport default function CartSummary({ \n  items, \n  onUpdateQuantity, \n  onProceedToCheckout \n}: CartSummaryProps) {\n  const [expanded, setExpanded] = useState(false);\n  \n  const subtotal = items.reduce((total, item) => total + (item.price * item.quantity), 0);\n  const platformFee = subtotal * 0.01; // 1% platform fee\n  const distance = 3.5; // Mock distance - in real app this would be calculated\n  const deliveryFee = distance * 7; // â‚¹7 per km\n  const total = subtotal + platformFee + deliveryFee;\n\n  const totalItems = items.reduce((total, item) => total + item.quantity, 0);\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 md:relative bg-card border-t md:border rounded-t-xl md:rounded-xl shadow-2xl p-4 z-40\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Collapsed View */}\n        <div className=\"flex items-center justify-between mb-3\">\n          <div>\n            <p className=\"text-sm text-muted-foreground\">\n              {totalItems} item{totalItems !== 1 ? 's' : ''} â€¢ Subtotal\n            </p>\n            <p className=\"text-2xl font-bold\">â‚¹{subtotal.toFixed(2)}</p>\n          </div>\n          <Button\n            variant=\"ghost\"\n            onClick={() => setExpanded(!expanded)}\n            className=\"text-primary font-medium flex items-center space-x-1\"\n            data-testid=\"button-toggle-cart\"\n          >\n            <span>View Cart</span>\n            {expanded ? (\n              <ChevronDown className=\"h-4 w-4\" />\n            ) : (\n              <ChevronUp className=\"h-4 w-4\" />\n            )}\n          </Button>\n        </div>\n\n        {/* Expanded View */}\n        {expanded && (\n          <div className=\"border-t border-border pt-4 mb-4 max-h-60 overflow-y-auto\">\n            <h4 className=\"font-medium mb-3\">Cart Items</h4>\n            <div className=\"space-y-3\">\n              {items.map((item) => (\n                <div key={item.id} className=\"flex items-center justify-between p-2 border rounded-lg\">\n                  <div className=\"flex items-center space-x-3 flex-1\">\n                    {item.imageUrl && (\n                      <img \n                        src={item.imageUrl} \n                        alt={item.name}\n                        className=\"w-10 h-10 rounded object-cover\"\n                      />\n                    )}\n                    <div className=\"flex-1\">\n                      <p className=\"font-medium text-sm\">{item.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">{item.weight}</p>\n                      <p className=\"text-sm font-medium\">â‚¹{item.price}</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button\n                      size=\"icon\"\n                      variant=\"outline\"\n                      className=\"h-6 w-6\"\n                      onClick={() => onUpdateQuantity(item.id, Math.max(0, item.quantity - 1))}\n                      data-testid={`button-decrease-${item.id}`}\n                    >\n                      {item.quantity === 1 ? (\n                        <Trash2 className=\"h-3 w-3\" />\n                      ) : (\n                        <Minus className=\"h-3 w-3\" />\n                      )}\n                    </Button>\n                    <Badge variant=\"secondary\" className=\"min-w-[2rem] text-center\">\n                      {item.quantity}\n                    </Badge>\n                    <Button\n                      size=\"icon\"\n                      variant=\"outline\"\n                      className=\"h-6 w-6\"\n                      onClick={() => onUpdateQuantity(item.id, item.quantity + 1)}\n                      data-testid={`button-increase-${item.id}`}\n                    >\n                      <Plus className=\"h-3 w-3\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Price Breakdown */}\n        <div className=\"space-y-2 text-sm\">\n          <div className=\"flex justify-between\">\n            <span className=\"text-muted-foreground\">Subtotal</span>\n            <span>â‚¹{subtotal.toFixed(2)}</span>\n          </div>\n          <div className=\"flex justify-between\">\n            <span className=\"text-muted-foreground\">Platform Fee (1%)</span>\n            <span>â‚¹{platformFee.toFixed(2)}</span>\n          </div>\n          <div className=\"flex justify-between\">\n            <span className=\"text-muted-foreground\">\n              Delivery Charges ({distance} km Ã— â‚¹7)\n            </span>\n            <span>â‚¹{deliveryFee.toFixed(2)}</span>\n          </div>\n          <div className=\"border-t border-border pt-2 flex justify-between font-semibold\">\n            <span>Total</span>\n            <span>â‚¹{total.toFixed(2)}</span>\n          </div>\n        </div>\n\n        <Button \n          className=\"w-full bg-secondary hover:bg-secondary/90 text-secondary-foreground py-3 mt-3\"\n          onClick={onProceedToCheckout}\n          data-testid=\"button-checkout\"\n        >\n          Proceed to Checkout\n        </Button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5584},"client/src/pages/home.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport ServiceCard from \"@/components/service-card\";\nimport {\n  MapPin,\n  Search,\n  Zap,\n  Wrench,\n  Scissors,\n  Cake,\n  ShoppingBasket,\n  Home as HomeIcon,\n  Gift,\n  Percent,\n  Sparkles,\n  Share,\n  Sandwich,\n  UtensilsCrossed,\n  Loader2,\n  ChevronRight, // Layout element for sections\n  Bell, // Top Notification Icon\n} from \"lucide-react\";\n\n// NOTE: Yeh static data tumhari original file se hai.\nconst services = [\n  { name: \"Electrician\", slug: \"electrician\", icon: Zap, description: \"Find certified electricians near you for all electrical work\", badge: \"Available 24/7\", color: \"accent\" },\n  { name: \"Plumber\", slug: \"plumber\", icon: Wrench, description: \"Expert plumbing services for repairs and installations\", badge: \"Quick Response\", color: \"primary\" },\n  { name: \"Beauty Parlor\", slug: \"beauty\", icon: Scissors, description: \"Professional beauty services at your convenience\", badge: \"10% Platform Fee\", color: \"secondary\" },\n  { name: \"Cake Shop\", slug: \"cake-shop\", icon: Cake, description: \"Order delicious custom cakes for every occasion\", badge: \"View Gallery\", color: \"destructive\" },\n  { name: \"Grocery (GMart)\", slug: \"grocery\", icon: ShoppingBasket, description: \"Order fresh groceries with fast home delivery\", badge: \"â‚¹7/km delivery\", color: \"secondary\" },\n  { name: \"No Brokerage\", slug: \"rental\", icon: HomeIcon, description: \"Find rental properties directly from owners\", badge: \"Zero Brokerage\", color: \"primary\" },\n  { name: \"Street Food\", slug: \"street-food\", icon: Sandwich, description: \"Discover delicious street food vendors nearby\", badge: \"Hot Deals\", color: \"accent\" },\n  { name: \"Restaurants\", slug: \"restaurants\", icon: UtensilsCrossed, description: \"Book tables and browse menus from top restaurants\", badge: \"Reserve Now\", color: \"destructive\" },\n];\n\nconst offers = [\n  { title: \"50% OFF\", subtitle: \"On your first electrician or plumber service\", code: \"WELCOME50\", badge: \"New User\", color: \"accent\", icon: Gift },\n  { title: \"Free Delivery\", subtitle: \"On orders above â‚¹500 from GMart\", code: \"FREEDEL500\", badge: \"Grocery\", color: \"secondary\", icon: Percent },\n  { title: \"20% Cashback\", subtitle: \"On all beauty parlor bookings this week\", code: \"BEAUTY20\", badge: \"Beauty\", color: \"primary\", icon: Sparkles },\n];\n\n\nexport default function Home() {\n  const [, navigate] = useLocation();\n\n  const [selectedService, setSelectedService] = useState(\"\"); \n  const [location, setLocation] = useState(\"Current GPS Location\"); // Location bar ke liye initial value\n  const [latitude, setLatitude] = useState<number | null>(null);\n  const [longitude, setLongitude] = useState<number | null>(null);\n  const [locationStatus, setLocationStatus] = useState<'idle' | 'loading' | 'success' | 'error'>('idle');\n\n  // useQuery call abhi bhi rakha hai, for best practice\n  const { data: serviceCategories, isLoading } = useQuery({ \n    queryKey: [\"/api/service-categories\"],\n  });\n\n  const handleLocationClick = () => {\n    // Geolocation logic remains the same\n    if (!navigator.geolocation) {\n      setLocationStatus('error');\n      alert(\"Geolocation is not supported by your browser.\");\n      return;\n    }\n    setLocationStatus('loading');\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        setLatitude(position.coords.latitude);\n        setLongitude(position.coords.longitude);\n        setLocationStatus('success');\n        setLocation(\"Current GPS Location (Captured)\");\n      },\n      (error) => {\n        console.error(\"Geolocation Error:\", error);\n        setLocationStatus('error');\n        alert(\"Unable to retrieve your location. Please type manually.\");\n        setLatitude(null);\n        setLongitude(null);\n        setLocation(\"\");\n      },\n      { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\n    );\n  };\n\n  const handleSearch = () => {\n    // Navigation to a generic search results page\n    if (selectedService && (location || (latitude && longitude))) {\n      const coords = (latitude && longitude) ? `&lat=${latitude}&lng=${longitude}` : '';\n      navigate(`/search?term=${encodeURIComponent(selectedService)}&location=${encodeURIComponent(location)}${coords}`);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 pb-16\"> \n\n      {/* 1. Top Location Bar (Image Reference: Top Bar) */}\n      <header className=\"sticky top-0 z-40 bg-white border-b border-gray-200 p-4 shadow-md\">\n        <div className=\"flex items-center justify-between max-w-7xl mx-auto\">\n          <div className=\"flex items-center space-x-2 text-sm font-medium text-gray-800 cursor-pointer\" onClick={handleLocationClick}>\n            <MapPin className=\"h-5 w-5 text-primary\" />\n            <span className=\"text-gray-500 text-xs truncate max-w-[200px] hover:text-primary\">\n                {locationStatus === 'loading' ? 'Fetching Location...' : location}\n            </span>\n            <ChevronRight className=\"h-4 w-4 text-gray-500\" />\n          </div>\n          <Bell className=\"h-5 w-5 text-gray-500 cursor-pointer hover:text-primary\" />\n        </div>\n      </header>\n\n      {/* 2. Unified Search Bar (Image Reference: Are you hungry) */}\n      <section className=\"p-4 bg-white shadow-sm sticky top-[61px] z-30\"> \n        <div className=\"max-w-7xl mx-auto flex gap-4\">\n            <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                <Input\n                    type=\"text\"\n                    placeholder=\"Search for Services or Products (Electrician, Cake, Rental...)\"\n                    className=\"w-full pl-10 pr-4 py-2 h-12 rounded-lg border border-gray-300 focus:ring-primary focus:border-primary\"\n                    value={selectedService}\n                    onChange={(e) => setSelectedService(e.target.value)}\n                    onKeyDown={(e) => {\n                        if (e.key === 'Enter') handleSearch();\n                    }}\n                />\n            </div>\n            {/* GPS/Search Button - Isse ab sirf search hoga, GPS toh upar handle ho raha hai */}\n            <Button\n                className=\"h-12 w-24 flex-shrink-0\"\n                onClick={handleSearch}\n                disabled={!selectedService}\n                data-testid=\"button-hero-search\"\n            >\n                Go\n            </Button>\n        </div>\n      </section>\n\n      {/* 3. Services Section (Image Reference: What's on Your Mind? - Categories) */}\n      <section id=\"services\" className=\"pt-8 pb-4 bg-background\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n\n          {/* Header jaisa Food UI mein tha */}\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-xl font-bold text-foreground\">Explore Categories</h2>\n            <Link href=\"/categories\" className=\"flex items-center text-primary text-sm font-medium hover:underline\">\n              View All <ChevronRight className=\"h-4 w-4\" />\n            </Link>\n          </div>\n\n          {/* Service Card Grid (Minimal) */}\n          <div className=\"grid grid-cols-4 sm:grid-cols-8 lg:grid-cols-8 gap-4 overflow-x-auto pb-2\">\n            {/* Ab yahan hum services array ko map karenge, jaisa Food UI mein gol buttons the */}\n            {services.slice(0, 8).map((service) => ( // Top 8 services dikhao\n              <div key={service.slug} className=\"flex flex-col items-center min-w-[70px]\">\n                {/* ServiceCard ki jagah, chota icon button banao */}\n                <Link to={`/${service.slug}`} className=\"p-3 bg-white border border-gray-200 rounded-full shadow-md hover:shadow-lg transition-all\">\n                    <service.icon className={`h-6 w-6 text-primary`} />\n                </Link>\n                <span className=\"text-xs text-center mt-1 font-medium text-gray-600 truncate max-w-full\">{service.name}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* 4. Special Offers Section (Image Reference: Listing Section jaisa) */}\n      <section id=\"offers\" className=\"py-4 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-foreground\">Exclusive Offers</h2>\n                <Link href=\"/offers\" className=\"flex items-center text-primary text-sm font-medium hover:underline\">\n                    View More <ChevronRight className=\"h-4 w-4\" />\n                </Link>\n            </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {offers.map((offer, index) => (\n              <Card\n                key={index}\n                // Styling changed to look like a prominent banner/listing card\n                className={`bg-gradient-to-br ${\n                  offer.color === \"accent\"\n                    ? \"from-accent to-accent/80\"\n                    : offer.color === \"secondary\"\n                    ? \"from-secondary to-secondary/80\"\n                    : \"from-primary to-primary/80\"\n                } text-white shadow-xl`}\n                data-testid={`card-offer-${index}`}\n              >\n                <CardContent className=\"p-4 flex items-center justify-between\">\n                  <div>\n                    <span className=\"bg-white/20 text-white px-2 py-0.5 rounded-full text-xs font-bold uppercase\">\n                      {offer.badge}\n                    </span>\n                    <h3 className=\"text-xl font-bold mt-1\">{offer.title}</h3>\n                    <p className=\"text-sm opacity-90\">{offer.subtitle}</p>\n                  </div>\n                  <offer.icon className=\"h-8 w-8 opacity-80\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* 5. Listing Placeholder (Yahan tumhare Top Rated Providers aayenge) */}\n      <section className=\"mt-6 px-4\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-xl font-bold text-foreground\">Top Rated Services (Electrician, Plumber)</h2>\n            <Link href=\"/top-providers\" className=\"flex items-center text-primary text-sm font-medium hover:underline\">\n              View All <ChevronRight className=\"h-4 w-4\" />\n            </Link>\n          </div>\n          {/* Yahan Provider Cards render honge. Abhi ke liye placeholder hai */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {/* Placeholder Card 1 */}\n            <Card><CardContent className=\"p-4\">Best Electrician</CardContent></Card>\n            {/* Placeholder Card 2 */}\n            <Card><CardContent className=\"p-4\">Best Plumber</CardContent></Card>\n            {/* Placeholder Card 3 */}\n            <Card><CardContent className=\"p-4\">Best Cake Shop</CardContent></Card>\n          </div>\n        </div>\n      </section>\n\n      {/* NOTE: Bottom Navbar ko abhi delete kiya hai, kyunki wo tumhare app structure par depend karega */}\n    </div>\n  );\n}","size_bytes":11377},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/pages/beauty.tsx":{"content":"import { useState, useMemo } from \"react\"; \nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation, Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  ArrowLeft, Star, MapPin, Sparkles,\n} from \"lucide-react\";\n\n// --- Data (Minimal for Listing) ---\nconst NESTED_SERVICES = {\n  \"Hair Services\": [], \"Nail Services\": [], \"Skincare Services\": [], \"Makeup Services\": [], \"Bridal & Special Events\": [],\n};\nconst MAIN_BEAUTY_CATEGORIES = Object.keys(NESTED_SERVICES);\n\nconst mockBeautyParlors = [\n{\nid: \"1\",\nname: \"Glamour Beauty Lounge (Top Rated)\",\nimage: \"https://images.unsplash.com/photo-1560066984-138dadb4c035?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200\",\n    rating: 4.7, reviews: 234, address: \"Sector 22, Near Metro Station\", distance: \"1.2 km\",\n    categories: [\"Hair Services\", \"Skincare Services\", \"Nail Services\"]\n},\n{\nid: \"2\",\nname: \"Sparkle & Shine Studio\",\nimage: \"https://images.unsplash.com/photo-1522335613345-cd4468f7f7c6?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200\",\n    rating: 4.5, reviews: 150, address: \"Sector 18, City Center\", distance: \"3.5 km\",\n    categories: [\"Nail Services\", \"Makeup Services\", \"Hair Services\"] \n}\n];\n// --- End Data ---\n\nexport default function Beauty() {\n  const [, setLocation] = useLocation();\n  const [filterMainCategory, setFilterMainCategory] = useState(\"All\");\n\n  const { data: beautyParlors, isLoading } = useQuery({\n    queryKey: [\"/api/service-providers\", { category: \"beauty\" }],\n    queryFn: () => Promise.resolve(mockBeautyParlors), \n  });\n\n  const filteredParlors = useMemo(() => {\n    if (!beautyParlors) return [];\n\n    if (filterMainCategory === \"All\") {\n      return beautyParlors;\n    }\n    return beautyParlors.filter((parlor: any) => \n        parlor.categories.includes(filterMainCategory)\n    );\n  }, [beautyParlors, filterMainCategory]);\n\n\n  return (\n    <div className=\"py-8 md:py-12 bg-gray-50 min-h-screen\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n\n        {/* Header & Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Services</span>\n        </Button>\n\n        {/* Horizontal Scrollable Main Categories (Filter Buttons) */}\n        <div className=\"flex overflow-x-auto scrollbar-hide space-x-3 mb-6 pb-2 border-b border-gray-200\">\n            <Button\n                variant={filterMainCategory === \"All\" ? \"default\" : \"outline\"}\n                size=\"sm\"\n                onClick={() => setFilterMainCategory(\"All\")}\n                className=\"flex-shrink-0\"\n            >\n                All Parlors\n            </Button>\n\n            {MAIN_BEAUTY_CATEGORIES.map((cat) => (\n                <Button\n                    key={cat}\n                    variant={filterMainCategory === cat ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    onClick={() => setFilterMainCategory(cat)}\n                    className=\"flex-shrink-0\"\n                >\n                    {cat}\n                </Button>\n            ))}\n        </div>\n\n\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\">Book Your Beauty Services</h2>\n          <p className=\"text-muted-foreground\">\n            Top-rated salons and spas near you. Click on a parlor to view the full menu.\n          </p>\n        </div>\n\n        {/* Beauty Parlor Cards */}\n        <div className=\"space-y-6\">\n          {isLoading ? (\n            <div className=\"space-y-6\">\n              {[1, 2].map((i) => (\n                <Card key={i} className=\"animate-pulse\"><CardContent className=\"p-6 h-32 bg-gray-200 rounded-lg\"></CardContent></Card>\n              ))}\n            </div>\n          ) : filteredParlors && filteredParlors.length === 0 ? (\n            <Card><CardContent className=\"p-8 text-center\">No parlors found for the selected category. Try 'All Parlors'.</CardContent></Card>\n          ) : (\n            filteredParlors?.map((parlor: any) => (\n              <Card key={parlor.id} className=\"shadow-xl hover:shadow-2xl transition-all\">\n                <Link to={`/beauty/${parlor.id}`} className=\"block hover:no-underline\">\n                <CardContent className=\"p-0\">\n\n                  {/* Parlor Info Header */}\n                  <div className=\"p-6 flex items-center justify-between cursor-pointer\">\n                    <div className=\"flex items-start space-x-4\">\n                      <div className=\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0\">\n                        <img src={parlor.image} alt={parlor.name} className=\"w-full h-full object-cover\"/>\n                      </div>\n                      <div>\n                        <h3 className=\"text-xl font-semibold\">{parlor.name}</h3>\n                        <div className=\"flex items-center space-x-2 mt-2 text-sm text-muted-foreground\">\n                          <Star className=\"h-4 w-4 text-yellow-500 fill-current\" />\n                          <span>{parlor.rating} ({parlor.reviews})</span>\n                          <MapPin className=\"h-4 w-4\" />\n                          <span>{parlor.distance} away</span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex flex-col items-end space-y-1\">\n                      <Badge variant=\"secondary\" className=\"flex items-center mb-2\"><Sparkles className=\"h-3 w-3 mr-1\" />Verified</Badge>\n                      <Button size=\"sm\" variant=\"default\" onClick={(e) => { e.preventDefault(); setLocation(`/beauty/${parlor.id}`); }}>\n                        View Menu\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n                </Link>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":6074},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"server/seed.ts":{"content":"// server/seed.ts (MODIFIED AND FIXED)\n\nimport { db } from \"./db\";\nimport bcrypt from \"bcrypt\";\nimport { \n  users, serviceCategories, serviceProviders, serviceProblems,\n  streetFoodItems, restaurantMenuItems, groceryProducts\n} from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\nasync function seed() {\n  console.log(\"ðŸŒ± Seeding database...\");\n\n  try {\n    // Create service categories (if they don't exist)\n    await db.insert(serviceCategories).values([\n      { name: \"Technician & Electrician\", slug: \"electrician\", description: \"Professional electrical services\" },\n      { name: \"Plumber\", slug: \"plumber\", description: \"Expert plumbing solutions\" },\n      { name: \"Beauty Parlor\", slug: \"beauty\", description: \"Beauty and grooming services\" },\n      { name: \"Cake Shop\", slug: \"cake-shop\", description: \"Custom cakes for all occasions\" },\n      { name: \"Grocery\", slug: \"grocery\", description: \"Fresh groceries delivered\" },\n      { name: \"Rental\", slug: \"rental\", description: \"No brokerage property rentals\" },\n      { name: \"Street Food\", slug: \"street-food\", description: \"Delicious street food vendors\" },\n      { name: \"Restaurants\", slug: \"restaurants\", description: \"Dine-in and table reservations\" },\n    ]).onConflictDoNothing();\n\n    // Fetch all categories\n    const categories = await db.select().from(serviceCategories);\n    console.log(`âœ… Found ${categories.length} service categories`);\n\n    const hashedPassword = await bcrypt.hash(\"password123\", 10);\n\n    // Try to create sample users (ignore if they already exist)\n    await db.insert(users).values([\n      // Electricians\n      { username: \"rajesh_electrician\", email: \"rajesh.electrician@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543210\" },\n      { username: \"amit_electrical\", email: \"amit.electrical@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543211\" },\n      { username: \"suresh_repairs\", email: \"suresh.repairs@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543212\" },\n\n      // Plumbers\n      { username: \"vikram_plumber\", email: \"vikram.plumber@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543213\" },\n      { username: \"rahul_plumbing\", email: \"rahul.plumbing@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543214\" },\n\n      // Beauty Parlors\n      { username: \"priya_beauty\", email: \"priya.beauty@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543215\" },\n      { username: \"sonal_salon\", email: \"sonal.salon@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543216\" },\n\n      // Cake Shops\n      { username: \"sweetdreams_cakes\", email: \"sweetdreams@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543217\" },\n      { username: \"cakehub_delights\", email: \"cakehub@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543218\" },\n\n      // Street Food\n      { username: \"chacha_chaat\", email: \"chacha.chaat@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543219\" },\n      { username: \"momos_king\", email: \"momos.king@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543220\" },\n\n      // Restaurants\n      { username: \"punjabi_dhaba\", email: \"punjabi.dhaba@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543221\" },\n      { username: \"chinese_wok\", email: \"chinese.wok@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543222\" },\n\n      // --- YEH HAI NAYA GMART USER ---\n      { username: \"gmart_manager\", email: \"gmart@example.com\", password: hashedPassword, role: \"provider\", phone: \"+919876543223\" },\n    ]).onConflictDoNothing();\n\n    // Fetch the users (whether just created or already existing)\n    const usernames = [\n      \"rajesh_electrician\", \"amit_electrical\", \"suresh_repairs\",\n      \"vikram_plumber\", \"rahul_plumbing\",\n      \"priya_beauty\", \"sonal_salon\",\n      \"sweetdreams_cakes\", \"cakehub_delights\",\n      \"chacha_chaat\", \"momos_king\",\n      \"punjabi_dhaba\", \"chinese_wok\",\n      \"gmart_manager\" // --- NAYA GMART USER ADDED ---\n    ];\n\n    const sampleUsers = [];\n    for (const username of usernames) {\n      const user = await db.select().from(users).where(sql`${users.username} = ${username}`).limit(1);\n      if (user.length > 0) {\n        sampleUsers.push(user[0]);\n      }\n    }\n\n    console.log(`âœ… Found ${sampleUsers.length} sample users`);\n\n    // Get category IDs\n    const electricianCat = categories.find(c => c.slug === \"electrician\");\n    const plumberCat = categories.find(c => c.slug === \"plumber\");\n    const beautyCat = categories.find(c => c.slug === \"beauty\");\n    const cakeCat = categories.find(c => c.slug === \"cake-shop\");\n    const streetFoodCat = categories.find(c => c.slug === \"street-food\");\n    const restaurantCat = categories.find(c => c.slug === \"restaurants\");\n    const groceryCat = categories.find(c => c.slug === \"grocery\"); // --- NAYI GROCERY CATEGORY ---\n\n    // Create service providers\n    const providers = [];\n\n    // ... (Saare puraane providers waise hi rahenge: Electrician, Plumber, Beauty, Cake, Street Food, Restaurants) ...\n\n    // (Electrician providers... code yahaan hai)\n    if (electricianCat && sampleUsers.length >= 3) {\n      const electricians = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[0].id,\n          categoryId: electricianCat.id,\n          businessName: \"Rajesh Electrical Works\",\n          description: \"Expert in AC, refrigerator, and TV repairs with 15 years of experience. 24/7 emergency service available.\",\n          experience: 15,\n          address: \"Shop 12, Malviya Nagar, Delhi\",\n          latitude: \"28.5355\",\n          longitude: \"77.2090\",\n          rating: \"4.8\",\n          reviewCount: 127,\n          serviceArea: 15,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"AC Repair\", \"Refrigerator\", \"TV Repair\", \"Microwave\"],\n        },\n        {\n          userId: sampleUsers[1].id,\n          categoryId: electricianCat.id,\n          businessName: \"Amit Electronics Repair\",\n          description: \"Specialized in washing machine and microwave repairs. Quick and reliable service.\",\n          experience: 10,\n          address: \"Sector 18, Noida\",\n          latitude: \"28.5678\",\n          longitude: \"77.3249\",\n          rating: \"4.6\",\n          reviewCount: 89,\n          serviceArea: 12,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Washing Machine\", \"Microwave\", \"Dishwasher\", \"Water Heater\"],\n        },\n        {\n          userId: sampleUsers[2].id,\n          categoryId: electricianCat.id,\n          businessName: \"Suresh Home Appliances\",\n          description: \"Water heater installation and all home appliance repairs at affordable rates.\",\n          experience: 8,\n          address: \"Tilak Nagar, Delhi\",\n          latitude: \"28.6412\",\n          longitude: \"77.0912\",\n          rating: \"4.7\",\n          reviewCount: 56,\n          serviceArea: 10,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Water Heater\", \"AC\", \"All Appliances\"],\n        },\n      ]).onConflictDoNothing().returning();\n      providers.push(...electricians);\n      console.log(`âœ… Created ${electricians.length} electrician providers`);\n    }\n\n    // (Plumber providers... code yahaan hai)\n    if (plumberCat && sampleUsers.length >= 5) {\n      const plumbers = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[3].id,\n          categoryId: plumberCat.id,\n          businessName: \"Vikram Plumbing Services\",\n          description: \"24/7 emergency plumbing services. Pipe leaks, blockages, and bathroom fittings specialist.\",\n          experience: 12,\n          address: \"Dwarka Sector 10, Delhi\",\n          latitude: \"28.5921\",\n          longitude: \"77.0460\",\n          rating: \"4.7\",\n          reviewCount: 98,\n          serviceArea: 12,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Pipe Repair\", \"Drain Cleaning\", \"Bathroom Fitting\"],\n        },\n        {\n          userId: sampleUsers[4].id,\n          categoryId: plumberCat.id,\n          businessName: \"Rahul Quick Fix Plumbing\",\n          description: \"Expert in tap repairs, drain cleaning, and water tank installation. Same day service.\",\n          experience: 8,\n          address: \"Rohini Sector 15, Delhi\",\n          latitude: \"28.7417\",\n          longitude: \"77.1025\",\n          rating: \"4.5\",\n          reviewCount: 67,\n          serviceArea: 10,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Tap Repair\", \"Tank Installation\", \"Emergency Service\"],\n        },\n      ]).onConflictDoNothing().returning();\n      providers.push(...plumbers);\n      console.log(`âœ… Created ${plumbers.length} plumber providers`);\n    }\n\n    // (Beauty parlor providers... code yahaan hai)\n    if (beautyCat && sampleUsers.length >= 7) {\n      const beautyProviders = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[5].id,\n          categoryId: beautyCat.id,\n          businessName: \"Priya's Beauty Lounge\",\n          description: \"Premium beauty services - Hair, Makeup, Spa, and Bridal packages. Experienced beauticians.\",\n          experience: 10,\n          address: \"Karol Bagh, Delhi\",\n          latitude: \"28.6519\",\n          longitude: \"77.1900\",\n          rating: \"4.9\",\n          reviewCount: 156,\n          serviceArea: 10,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Hair Styling\", \"Bridal Makeup\", \"Spa\", \"Facial\"],\n        },\n        {\n          userId: sampleUsers[6].id,\n          categoryId: beautyCat.id,\n          businessName: \"Sonal Unisex Salon\",\n          description: \"Complete beauty solutions for men and women. Expert stylists and modern equipment.\",\n          experience: 7,\n          address: \"Lajpat Nagar, Delhi\",\n          latitude: \"28.5677\",\n          longitude: \"77.2430\",\n          rating: \"4.6\",\n          reviewCount: 92,\n          serviceArea: 8,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Hair Cut\", \"Facial\", \"Makeup\", \"Manicure\"],\n        },\n      ]).onConflictDoNothing().returning();\n      providers.push(...beautyProviders);\n      console.log(`âœ… Created ${beautyProviders.length} beauty parlor providers`);\n    }\n\n    // (Cake shop providers... code yahaan hai)\n    if (cakeCat && sampleUsers.length >= 9) {\n      const cakeShops = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[7].id,\n          categoryId: cakeCat.id,\n          businessName: \"Sweet Dreams Bakery\",\n          description: \"Custom cakes for birthdays, anniversaries, and weddings. Eggless options available.\",\n          experience: 8,\n          address: \"Connaught Place, Delhi\",\n          latitude: \"28.6304\",\n          longitude: \"77.2177\",\n          rating: \"4.8\",\n          reviewCount: 234,\n          serviceArea: 20,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Birthday Cakes\", \"Wedding Cakes\", \"Eggless\", \"Custom Design\"],\n        },\n        {\n          userId: sampleUsers[8].id,\n          categoryId: cakeCat.id,\n          businessName: \"Cake Hub & Delights\",\n          description: \"Delicious designer cakes and cupcakes. Same-day delivery available for select items.\",\n          experience: 5,\n          address: \"Saket, Delhi\",\n          latitude: \"28.5244\",\n          longitude: \"77.2066\",\n          rating: \"4.7\",\n          reviewCount: 178,\n          serviceArea: 15,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Designer Cakes\", \"Cupcakes\", \"Fast Delivery\", \"Photo Cakes\"],\n        },\n      ]).onConflictDoNothing().returning();\n      providers.push(...cakeShops);\n      console.log(`âœ… Created ${cakeShops.length} cake shop providers`);\n    }\n\n    // (Street food vendors... code yahaan hai)\n    if (streetFoodCat && sampleUsers.length >= 11) {\n      const streetFoodVendors = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[9].id,\n          categoryId: streetFoodCat.id,\n          businessName: \"Chacha's Chaat Corner\",\n          description: \"Famous for Pani Puri, Bhel Puri, and Papdi Chaat. 25 years of authentic street food experience.\",\n          experience: 25,\n          address: \"Chandni Chowk, Delhi\",\n          latitude: \"28.6507\",\n          longitude: \"77.2334\",\n          rating: \"4.9\",\n          reviewCount: 567,\n          serviceArea: 5,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Pani Puri\", \"Bhel Puri\", \"Chaat\", \"Papdi\"],\n        },\n        {\n          userId: sampleUsers[10].id,\n          categoryId: streetFoodCat.id,\n          businessName: \"Momos King\",\n          description: \"Steamed and fried momos with special sauces. Fresh made daily with hygiene standards.\",\n          experience: 6,\n          address: \"Nehru Place, Delhi\",\n          latitude: \"28.5494\",\n          longitude: \"77.2501\",\n          rating: \"4.6\",\n          reviewCount: 345,\n          serviceArea: 5,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Momos\", \"Spring Rolls\", \"Fried Snacks\"],\n        },\n      ]).onConflictDoNothing().returning();\n      providers.push(...streetFoodVendors);\n      console.log(`âœ… Created ${streetFoodVendors.length} street food vendors`);\n\n      // Add street food items\n      if (streetFoodVendors.length > 0) {\n        const streetFoodMenuItems = await db.insert(streetFoodItems).values([\n          // ... (street food items ka code yahaan hai) ...\n          {\n            providerId: streetFoodVendors[0].id,\n            name: \"Pani Puri\",\n            description: \"Crispy puris with tangy tamarind water and potato filling\",\n            category: \"Chaat\",\n            price: \"40\",\n            isVeg: true,\n            isAvailable: true,\n            spicyLevel: \"Medium\",\n          },\n          {\n            providerId: streetFoodVendors[0].id,\n            name: \"Bhel Puri\",\n            description: \"Puffed rice mixed with vegetables and chutneys\",\n            category: \"Chaat\",\n            price: \"50\",\n            isVeg: true,\n            isAvailable: true,\n            spicyLevel: \"Mild\",\n          },\n          {\n            providerId: streetFoodVendors[0].id,\n            name: \"Papdi Chaat\",\n            description: \"Crispy wafers topped with yogurt, chutneys, and sev\",\n            category: \"Chaat\",\n            price: \"60\",\n            isVeg: true,\n            isAvailable: true,\n            spicyLevel: \"Medium\",\n          },\n          {\n            providerId: streetFoodVendors[1].id,\n            name: \"Veg Steamed Momos\",\n            description: \"Steamed dumplings with mixed vegetable filling\",\n            category: \"Momos\",\n            price: \"80\",\n            isVeg: true,\n            isAvailable: true,\n            spicyLevel: \"Mild\",\n          },\n          {\n            providerId: streetFoodVendors[1].id,\n            name: \"Chicken Fried Momos\",\n            description: \"Crispy fried momos with chicken filling\",\n            category: \"Momos\",\n            price: \"120\",\n            isVeg: false,\n            isAvailable: true,\n            spicyLevel: \"Medium\",\n          },\n          {\n            providerId: streetFoodVendors[1].id,\n            name: \"Paneer Momos\",\n            description: \"Steamed momos with spicy paneer filling\",\n            category: \"Momos\",\n            price: \"100\",\n            isVeg: true,\n            isAvailable: true,\n            spicyLevel: \"Hot\",\n          },\n        ]).onConflictDoNothing().returning();\n\n        console.log(`âœ… Created ${streetFoodMenuItems.length} street food items`);\n      }\n    }\n\n    // (Restaurant providers... code yahaan hai)\n    if (restaurantCat && sampleUsers.length >= 13) {\n      const restaurants = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[11].id,\n          categoryId: restaurantCat.id,\n          businessName: \"Punjabi Dhaba Restaurant\",\n          description: \"Authentic Punjabi cuisine. Family dining with live music on weekends.\",\n          experience: 15,\n          address: \"Rajouri Garden, Delhi\",\n          latitude: \"28.6410\",\n          longitude: \"77.1200\",\n          rating: \"4.7\",\n          reviewCount: 432,\n          serviceArea: 8,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"North Indian\", \"Punjabi\", \"Tandoor\", \"Dal Makhani\"],\n        },\n        {\n          userId: sampleUsers[12].id,\n          categoryId: restaurantCat.id,\n          businessName: \"Chinese Wok Express\",\n          description: \"Best Chinese and Thai food. Cozy ambiance with quick service.\",\n          experience: 8,\n          address: \"Greater Kailash, Delhi\",\n          latitude: \"28.5494\",\n          longitude: \"77.2428\",\n          rating: \"4.5\",\n          reviewCount: 289,\n          serviceArea: 6,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Chinese\", \"Thai\", \"Asian Fusion\", \"Noodles\"],\n        },\n      ]).onConflictDoNothing().returning();\n      providers.push(...restaurants);\n      console.log(`âœ… Created ${restaurants.length} restaurants`);\n\n      // Add restaurant menu items\n      if (restaurants.length > 0) {\n        const restaurantMenu = await db.insert(restaurantMenuItems).values([\n          // ... (restaurant items ka code yahaan hai) ...\n          {\n            providerId: restaurants[0].id,\n            name: \"Butter Chicken\",\n            description: \"Tender chicken in rich tomato and butter gravy\",\n            category: \"Main Course\",\n            price: \"380\",\n            isVeg: false,\n            isAvailable: true,\n            cuisine: \"Indian\",\n          },\n          {\n            providerId: restaurants[0].id,\n            name: \"Dal Makhani\",\n            description: \"Black lentils slow-cooked with butter and cream\",\n            category: \"Main Course\",\n            price: \"280\",\n            isVeg: true,\n            isAvailable: true,\n            cuisine: \"Indian\",\n          },\n          {\n            providerId: restaurants[0].id,\n            name: \"Paneer Tikka Masala\",\n            description: \"Grilled paneer in creamy tomato sauce\",\n            category: \"Main Course\",\n            price: \"320\",\n            isVeg: true,\n            isAvailable: true,\n            cuisine: \"Indian\",\n          },\n          {\n            providerId: restaurants[1].id,\n            name: \"Hakka Noodles\",\n            description: \"Stir-fried noodles with vegetables and sauces\",\n            category: \"Main Course\",\n            price: \"220\",\n            isVeg: true,\n            isAvailable: true,\n            cuisine: \"Chinese\",\n          },\n          {\n            providerId: restaurants[1].id,\n            name: \"Chicken Manchurian\",\n            description: \"Crispy chicken in spicy Manchurian sauce\",\n            category: \"Main Course\",\n            price: \"340\",\n            isVeg: false,\n            isAvailable: true,\n            cuisine: \"Chinese\",\n          },\n          {\n            providerId: restaurants[1].id,\n            name: \"Thai Green Curry\",\n            description: \"Aromatic green curry with vegetables and coconut milk\",\n            category: \"Main Course\",\n            price: \"360\",\n            isVeg: true,\n            isAvailable: true,\n            cuisine: \"Thai\",\n          },\n        ]).onConflictDoNothing().returning();\n\n        console.log(`âœ… Created ${restaurantMenu.length} restaurant menu items`);\n      }\n    }\n\n    // --- YEH HAI NAYA GMART PROVIDER BLOCK ---\n    let gmartProviderId: string | undefined = undefined;\n    if (groceryCat && sampleUsers.length >= 14) { // 14th user\n      const gmartProvider = await db.insert(serviceProviders).values([\n        {\n          userId: sampleUsers[13].id, // 14th user (index 13)\n          categoryId: groceryCat.id,\n          businessName: \"GMart Official Store\",\n          description: \"Fresh groceries delivered to your doorstep.\",\n          experience: 5,\n          address: \"GMart Warehouse, Shirur\",\n          latitude: \"18.8266\",\n          longitude: \"74.3411\",\n          rating: \"4.9\",\n          reviewCount: 1200,\n          serviceArea: 25,\n          isVerified: true,\n          isAvailable: true,\n          specializations: [\"Fresh Produce\", \"Dairy\", \"Staples\", \"Fast Delivery\"],\n        },\n      ]).onConflictDoNothing().returning();\n\n      if (gmartProvider.length > 0) {\n        providers.push(gmartProvider[0]);\n        gmartProviderId = gmartProvider[0].id;\n        console.log(`âœ… Created GMart provider`);\n      } else {\n        // Agar provider pehle se tha, toh usko fetch kar lo\n        const existingProvider = await db.query.serviceProviders.findFirst({\n            where: (sp, { eq }) => eq(sp.userId, sampleUsers[13].id)\n        });\n        if (existingProvider) {\n            gmartProviderId = existingProvider.id;\n            console.log(`âœ… Found existing GMart provider`);\n        }\n      }\n    }\n\n    // --- YEH HAI NAYA/FIXED GROCERY ITEMS BLOCK ---\n    if (!gmartProviderId) {\n      console.error(\"âŒ GMart provider ID not found! Cannot seed grocery items.\");\n      throw new Error(\"GMart provider setup failed.\");\n    }\n\n    // Purane items delete karo\n    await db.delete(groceryProducts);\n    console.log(\"âœ… Cleared existing grocery products\");\n\n    const groceryItems = await db.insert(groceryProducts).values([\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: \"Fresh Bananas\",\n        description: \"Premium quality ripe bananas\",\n        category: \"fruits\",\n        price: \"60.00\",\n        weight: \"1 dozen\",\n        unit: \"dozen\",\n        inStock: true,\n        stockQuantity: 50,\n        imageUrl: 'https://m.media-amazon.com/images/I/51eb+Yc523L._SL1000_.jpg',\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: \"Fresh Apples\",\n        description: \"Crisp and juicy red apples\",\n        category: \"fruits\",\n        price: \"150.00\",\n        weight: \"1 kg\",\n        unit: \"kg\",\n        inStock: true,\n        stockQuantity: 30,\n        imageUrl: 'https://cdn.shopify.com/s/files/1/0530/2369/products/FreshApples.jpg?v=1604130099',\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: \"Whole Wheat Bread\",\n        description: \"Freshly baked whole wheat bread\",\n        category: \"bakery\",\n        price: \"45.00\",\n        weight: \"400g\",\n        unit: \"pack\",\n        inStock: true,\n        stockQuantity: 30,\n        imageUrl: 'https://img.etimg.com/thumb/msid-68194451,width-1200,height-900,resizemode-4/.jpg',\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: \"Toned Milk\",\n        description: \"Fresh toned milk\",\n        category: \"dairy\",\n        price: \"56.00\",\n        weight: \"1L\",\n        unit: \"liter\",\n        inStock: true,\n        stockQuantity: 100,\n        imageUrl: 'https://media.istockphoto.com/id/1179754291/photo/milk-glass-and-bottle-with-milk-splashes-clip-art-milk-illustration-isolated-on-white.jpg?s=612x612&w=0&k=20&c=L_Jj9S_MhQdM-v3G1I_UvK27n-l894DqK4_kR36qR1w=',\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: \"Basmati Rice\",\n        description: \"Premium long grain basmati rice\",\n        category: \"staples\",\n        price: \"180.00\",\n        weight: \"1 kg\",\n        unit: \"kg\",\n        inStock: true,\n        stockQuantity: 40,\n        imageUrl: 'https://m.media-amazon.com/images/I/71u9yH0K2WL.jpg',\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: \"Fresh Tomatoes\",\n        description: \"Farm fresh red tomatoes\",\n        category: \"vegetables\",\n        price: \"35.00\",\n        weight: \"500g\",\n        unit: \"pack\",\n        inStock: true,\n        stockQuantity: 60,\n        imageUrl: 'https://upload.wikimedia.org/wikipedia/commons/8/89/Tomato_je.jpg',\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: 'Detergent Soap',\n        description: 'Lifebuoy Total 10 for germ protection',\n        category: 'toiletries',\n        price: '90.00',\n        weight: '125g',\n        unit: 'bar',\n        imageUrl: 'https://www.jiomart.com/images/product/original/491410756/lifebuoy-total-10-bathing-soap-125-g-product-images-o491410756-p590059341-0-202302281831.jpeg?im=Resize=(1000,1000)',\n        inStock: true,\n        stockQuantity: 50,\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: 'Colgate Toothpaste',\n        description: 'For strong teeth and fresh breath',\n        category: 'toiletries',\n        price: '110.00',\n        weight: '150g',\n        unit: 'tube',\n        imageUrl: 'https://www.colgate.com/content/dam/cp-sites/oral-care/oral-care-center/en-us/product-detail-pages/toothpaste/colgate-total-plaque-pro-release-paste-product.jpg',\n        inStock: true,\n        stockQuantity: 40,\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: 'Dettol Handwash',\n        description: 'Protects from 100 illness-causing germs',\n        category: 'personal-care',\n        price: '180.00',\n        weight: '250ml',\n        unit: 'bottle',\n        imageUrl: 'https://www.godrejprotekt.com/cdn/shop/products/3-min_8b4172f3-c5f1-460d-a06f-12c8b827e8a9.jpg?v=1661858599',\n        inStock: true,\n        stockQuantity: 60,\n      },\n      {\n        providerId: gmartProviderId, // <-- LINKED\n        name: 'Dove Shampoo',\n        description: 'For smooth and shiny hair',\n        category: 'personal-care',\n        price: '300.00',\n        weight: '360ml',\n        unit: 'bottle',\n        imageUrl: 'https://m.media-amazon.com/images/I/61N+p2uL7GL._SL1500_.jpg',\n        inStock: true,\n        stockQuantity: 35,\n      },\n    ]).returning(); // .onConflictDoNothing() hata diya kyunki hum pehle delete kar rahe hain\n\n\n    console.log(`âœ… Created ${groceryItems.length} grocery items`);\n\n    console.log(\"âœ¨ Database seeding completed successfully!\");\n    console.log(`ðŸ“Š Total providers created: ${providers.length}`);\n  } catch (error) {\n    console.error(\"âŒ Error seeding database:\", error);\n    throw error;\n  }\n}\n\n// Run the seed function\nseed()\n  .then(() => {\n    console.log(\"âœ… Seed script completed\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"âŒ Seed script failed:\", error);\n    process.exit(1);\n  });","size_bytes":26552},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(210, 20%, 98%);\n  --foreground: hsl(222, 47%, 11%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(222, 47%, 11%);\n  --popover: hsl(0, 0%, 100%);\n  --popover-foreground: hsl(222, 47%, 11%);\n  --primary: hsl(217, 91%, 60%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  --secondary: hsl(158, 64%, 52%);\n  --secondary-foreground: hsl(0, 0%, 100%);\n  --muted: hsl(210, 40%, 96%);\n  --muted-foreground: hsl(215, 16%, 47%);\n  --accent: hsl(38, 92%, 50%);\n  --accent-foreground: hsl(0, 0%, 100%);\n  --destructive: hsl(0, 84%, 60%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  --border: hsl(214, 32%, 91%);\n  --input: hsl(214, 32%, 91%);\n  --ring: hsl(217, 91%, 60%);\n  --chart-1: hsl(217, 91%, 60%);\n  --chart-2: hsl(158, 64%, 52%);\n  --chart-3: hsl(38, 92%, 50%);\n  --chart-4: hsl(147, 71%, 42%);\n  --chart-5: hsl(341, 75%, 51%);\n  --sidebar: hsl(0, 0%, 100%);\n  --sidebar-foreground: hsl(222, 47%, 11%);\n  --sidebar-primary: hsl(217, 91%, 60%);\n  --sidebar-primary-foreground: hsl(0, 0%, 100%);\n  --sidebar-accent: hsl(210, 40%, 96%);\n  --sidebar-accent-foreground: hsl(217, 91%, 60%);\n  --sidebar-border: hsl(214, 32%, 91%);\n  --sidebar-ring: hsl(217, 91%, 60%);\n  --font-sans: Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: 0.75rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 1px 2px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 1px 2px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 2px 4px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 4px 6px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 8px 10px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n}\n\n.dark {\n  --background: hsl(0, 0%, 0%);\n  --foreground: hsl(200, 7%, 91%);\n  --card: hsl(228, 10%, 10%);\n  --card-foreground: hsl(0, 0%, 85%);\n  --popover: hsl(0, 0%, 0%);\n  --popover-foreground: hsl(200, 7%, 91%);\n  --primary: hsl(217, 88%, 53%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  --secondary: hsl(195, 15%, 95%);\n  --secondary-foreground: hsl(222, 47%, 11%);\n  --muted: hsl(0, 0%, 9%);\n  --muted-foreground: hsl(210, 3%, 46%);\n  --accent: hsl(206, 70%, 8%);\n  --accent-foreground: hsl(217, 88%, 53%);\n  --destructive: hsl(0, 84%, 60%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  --border: hsl(210, 5%, 15%);\n  --input: hsl(208, 28%, 18%);\n  --ring: hsl(217, 91%, 60%);\n  --chart-1: hsl(217, 91%, 60%);\n  --chart-2: hsl(158, 64%, 52%);\n  --chart-3: hsl(38, 92%, 50%);\n  --chart-4: hsl(147, 71%, 42%);\n  --chart-5: hsl(341, 75%, 51%);\n  --sidebar: hsl(228, 10%, 10%);\n  --sidebar-foreground: hsl(0, 0%, 85%);\n  --sidebar-primary: hsl(217, 91%, 60%);\n  --sidebar-primary-foreground: hsl(0, 0%, 100%);\n  --sidebar-accent: hsl(206, 70%, 8%);\n  --sidebar-accent-foreground: hsl(217, 88%, 53%);\n  --sidebar-border: hsl(206, 16%, 26%);\n  --sidebar-ring: hsl(217, 91%, 60%);\n  --font-sans: Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: 0.75rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 1px 2px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 1px 2px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 2px 4px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 4px 6px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00), 0px 8px 10px -1px hsl(217, 91%, 60% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(217, 91%, 60% / 0.00);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@layer components {\n  .service-card {\n    transition: all 0.3s ease;\n  }\n\n  .service-card:hover {\n    transform: translateY(-4px);\n    box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);\n  }\n\n  .provider-card {\n    transition: all 0.2s ease;\n  }\n\n  .provider-card:hover {\n    box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\n  }\n\n  .rating-stars {\n    color: hsl(38, 92%, 50%);\n  }\n\n  .modal-overlay {\n    backdrop-filter: blur(4px);\n  }\n\n  .cart-badge {\n    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n  }\n\n  @keyframes slideUp {\n    from {\n      transform: translateY(100%);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n\n  .slide-up {\n    animation: slideUp 0.3s ease-out;\n  }\n\n  .category-pill {\n    transition: all 0.2s ease;\n  }\n\n  .category-pill:hover {\n    background: hsl(217, 91%, 60%);\n    color: white;\n  }\n}\n","size_bytes":5303},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/layout/footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { Network, Phone, Mail, MapPin } from \"lucide-react\";\n\nconst quickLinks = [\n  { name: \"About Us\", href: \"/about\" },\n  { name: \"How It Works\", href: \"/how-it-works\" },\n  { name: \"Pricing\", href: \"/pricing\" },\n  { name: \"Blog\", href: \"/blog\" },\n  { name: \"FAQs\", href: \"/faqs\" }\n];\n\nconst services = [\n  { name: \"Electrician\", href: \"/electrician\" },\n  { name: \"Plumber\", href: \"/plumber\" },\n  { name: \"Beauty Parlor\", href: \"/beauty\" },\n  { name: \"Cake Shop\", href: \"/cake-shop\" },\n  { name: \"Grocery\", href: \"/grocery\" },\n  { name: \"No Brokerage\", href: \"/rental\" },\n  { name: \"Street Food\", href: \"/street-food\" },\n  { name: \"Restaurants\", href: \"/restaurants\" }\n];\n\nconst socialLinks = [\n  { name: \"Facebook\", icon: \"fab fa-facebook-f\", href: \"#\" },\n  { name: \"Twitter\", icon: \"fab fa-twitter\", href: \"#\" },\n  { name: \"Instagram\", icon: \"fab fa-instagram\", href: \"#\" },\n  { name: \"LinkedIn\", icon: \"fab fa-linkedin-in\", href: \"#\" }\n];\n\nexport default function Footer() {\n  return (\n    <footer className=\"bg-card border-t border-border py-12\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          {/* Company Info */}\n          <div>\n            <div className=\"flex items-center text-xl font-bold text-primary mb-4\">\n              <Network className=\"h-6 w-6 mr-2\" />\n              ServiceHub\n            </div>\n            <p className=\"text-muted-foreground mb-4\">\n              Your trusted platform for all home and lifestyle services.\n            </p>\n            <div className=\"flex space-x-3\">\n              {socialLinks.map((social) => (\n                <a\n                  key={social.name}\n                  href={social.href}\n                  className=\"w-10 h-10 bg-muted rounded-full flex items-center justify-center hover:bg-primary hover:text-primary-foreground transition\"\n                  aria-label={social.name}\n                >\n                  <i className={social.icon}></i>\n                </a>\n              ))}\n            </div>\n          </div>\n\n          {/* Quick Links */}\n          <div>\n            <h4 className=\"font-semibold mb-4\">Quick Links</h4>\n            <ul className=\"space-y-2\">\n              {quickLinks.map((link) => (\n                <li key={link.name}>\n                  <Link href={link.href} className=\"text-muted-foreground hover:text-primary transition\">\n                    {link.name}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n\n          {/* Services */}\n          <div>\n            <h4 className=\"font-semibold mb-4\">Services</h4>\n            <ul className=\"space-y-2\">\n              {services.map((service) => (\n                <li key={service.name}>\n                  <Link href={service.href} className=\"text-muted-foreground hover:text-primary transition\">\n                    {service.name}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n\n          {/* Contact */}\n          <div>\n            <h4 className=\"font-semibold mb-4\">Contact Us</h4>\n            <ul className=\"space-y-3\">\n              <li className=\"flex items-start space-x-3\">\n                <MapPin className=\"h-4 w-4 text-primary mt-1 flex-shrink-0\" />\n                <span className=\"text-muted-foreground\">\n                  123 Service Street, Noida, UP 201301\n                </span>\n              </li>\n              <li className=\"flex items-center space-x-3\">\n                <Phone className=\"h-4 w-4 text-primary flex-shrink-0\" />\n                <span className=\"text-muted-foreground\">+91 98765 43210</span>\n              </li>\n              <li className=\"flex items-center space-x-3\">\n                <Mail className=\"h-4 w-4 text-primary flex-shrink-0\" />\n                <span className=\"text-muted-foreground\">support@servicehub.com</span>\n              </li>\n            </ul>\n          </div>\n        </div>\n\n        <div className=\"border-t border-border mt-8 pt-8 flex flex-col md:flex-row items-center justify-between\">\n          <p className=\"text-muted-foreground text-sm\">\n            Â© 2024 ServiceHub. All rights reserved.\n          </p>\n          <div className=\"flex space-x-6 mt-4 md:mt-0\">\n            <Link href=\"/privacy\" className=\"text-sm text-muted-foreground hover:text-primary transition\">\n              Privacy Policy\n            </Link>\n            <Link href=\"/terms\" className=\"text-sm text-muted-foreground hover:text-primary transition\">\n              Terms of Service\n            </Link>\n            <Link href=\"/cookies\" className=\"text-sm text-muted-foreground hover:text-primary transition\">\n              Cookie Policy\n            </Link>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","size_bytes":4827},"client/src/components/layout/header.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Menu, Home, Settings, LogOut, Package, User, LayoutDashboard } from \"lucide-react\"; // LayoutDashboard icon add kiya\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst navItems = [\n  { name: \"Home\", href: \"/\", icon: Home },\n  { name: \"My Bookings\", href: \"/my-bookings\", icon: Package },\n  // Settings link ko user-specific settings ke liye rakha hai\n  // Provider Dashboard ka link alag se handle kiya gaya hai\n];\n\nexport default function Header() {\n  const [, setLocation] = useLocation();\n  const [isOpen, setIsOpen] = useState(false);\n  const { user, isLoading, logout } = useAuth();\n  const { toast } = useToast();\n\n  const handleLogout = async () => {\n    try {\n      await logout(); // Ab yeh aaram se intezaar karega\n      toast({\n        title: \"ðŸ‘‹ Logged Out!\",\n        description: \"You have been successfully logged out.\",\n      });\n      setLocation(\"/login\"); // Logout poora hone ke baad, aaram se redirect hoga\n    } catch (error) {\n      toast({\n        title: \"Logout Failed\",\n        description: \"Something went wrong. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <header className=\"fixed top-0 left-0 right-0 z-50 bg-background border-b h-16 flex items-center px-4\">\n      <div className=\"max-w-7xl mx-auto flex justify-between items-center w-full\">\n        <div className=\"flex items-center gap-4\">\n          {/* Mobile Navigation */}\n          <Sheet open={isOpen} onOpenChange={setIsOpen}>\n            <SheetTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden\">\n                <Menu className=\"h-5 w-5\" />\n                <span className=\"sr-only\">Toggle Menu</span>\n              </Button>\n            </SheetTrigger>\n            <SheetContent side=\"left\" className=\"w-64\">\n              <nav className=\"flex flex-col gap-4 py-6\">\n                {navItems.map((item) => (\n                  <Button\n                    key={item.name}\n                    variant=\"ghost\"\n                    className=\"justify-start px-4 py-2 text-lg font-medium\"\n                    onClick={() => {\n                      setLocation(item.href);\n                      setIsOpen(false);\n                    }}\n                  >\n                    <item.icon className=\"mr-3 h-5 w-5\" />\n                    {item.name}\n                  </Button>\n                ))}\n\n                {/* Mobile: Provider Dashboard link */}\n                {user?.role === 'provider' && (\n                  <Button\n                    variant=\"ghost\"\n                    className=\"justify-start px-4 py-2 text-lg font-medium\"\n                    onClick={() => {\n                      setLocation(\"/provider/dashboard\");\n                      setIsOpen(false);\n                    }}\n                  >\n                    <LayoutDashboard className=\"mr-3 h-5 w-5\" />\n                    Provider Dashboard\n                  </Button>\n                )}\n                 {/* Mobile: Settings link */}\n                 {user && ( // Settings sirf logged-in user ke liye\n                    <Button\n                      variant=\"ghost\"\n                      className=\"justify-start px-4 py-2 text-lg font-medium\"\n                      onClick={() => {\n                        setLocation(\"/settings\");\n                        setIsOpen(false);\n                      }}\n                    >\n                      <Settings className=\"mr-3 h-5 w-5\" />\n                      Settings\n                    </Button>\n                 )}\n\n                {/* Mobile: Logout / Login Button */}\n                {user ? (\n                  <Button\n                    variant=\"ghost\"\n                    className=\"justify-start px-4 py-2 text-lg font-medium text-red-500 hover:text-red-600\"\n                    onClick={() => {\n                      handleLogout();\n                      setIsOpen(false);\n                    }}\n                  >\n                    <LogOut className=\"mr-3 h-5 w-5\" />\n                    Logout\n                  </Button>\n                ) : (\n                  !isLoading && (\n                    <Button\n                      variant=\"ghost\"\n                      className=\"justify-start px-4 py-2 text-lg font-medium\"\n                      onClick={() => {\n                        setLocation(\"/login\");\n                        setIsOpen(false);\n                      }}\n                    >\n                      <User className=\"mr-3 h-5 w-5\" />\n                      Login\n                    </Button>\n                  )\n                )}\n              </nav>\n            </SheetContent>\n          </Sheet>\n\n          {/* Logo / Home link */}\n          <Button variant=\"ghost\" className=\"text-xl font-bold\" onClick={() => setLocation(\"/\")}>\n            ServiceConnect\n          </Button>\n\n          {/* Desktop Navigation (optional, if needed) */}\n          <nav className=\"hidden md:flex items-center space-x-4\">\n            {navItems.map((item) => (\n              <Button\n                key={item.name}\n                variant=\"ghost\"\n                onClick={() => setLocation(item.href)}\n                className=\"text-sm font-medium\"\n              >\n                {item.name}\n              </Button>\n            ))}\n             {user?.role === 'provider' && (\n                <Button\n                    variant=\"ghost\"\n                    onClick={() => setLocation(\"/provider/dashboard\")}\n                    className=\"text-sm font-medium\"\n                >\n                    <LayoutDashboard className=\"mr-2 h-4 w-4\" /> {/* Icon ke saath */}\n                    Provider Dashboard\n                </Button>\n            )}\n             {user && (\n                <Button\n                    variant=\"ghost\"\n                    onClick={() => setLocation(\"/settings\")}\n                    className=\"text-sm font-medium\"\n                >\n                    <Settings className=\"mr-2 h-4 w-4\" /> {/* Icon ke saath */}\n                    Settings\n                </Button>\n            )}\n          </nav>\n        </div>\n\n        {/* User Dropdown / Login Button */}\n        <div className=\"flex items-center space-x-2\">\n          {isLoading ? (\n            <div className=\"w-8 h-8 rounded-full bg-muted animate-pulse\"></div> // Loading state for avatar\n          ) : user ? (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" className=\"relative h-9 w-9 rounded-full\">\n                  <Avatar className=\"h-9 w-9\">\n                    <AvatarImage src=\"/placeholder-user.jpg\" alt=\"User Avatar\" />\n                    <AvatarFallback>{user.username.charAt(0).toUpperCase()}</AvatarFallback>\n                  </Avatar>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent className=\"w-56\" align=\"end\" forceMount>\n                <DropdownMenuLabel className=\"font-normal\">\n                  <div className=\"flex flex-col space-y-1\">\n                    <p className=\"text-sm font-medium leading-none\">{user.username}</p>\n                    <p className=\"text-xs leading-none text-muted-foreground\">\n                      {user.email}\n                    </p>\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={() => setLocation(\"/my-bookings\")}>\n                  <Package className=\"mr-2 h-4 w-4\" />\n                  <span>My Bookings</span>\n                </DropdownMenuItem>\n                {/* Desktop Dropdown: Provider Dashboard link */}\n                {user.role === 'provider' && (\n                  <DropdownMenuItem onClick={() => setLocation(\"/provider/dashboard\")}>\n                    <LayoutDashboard className=\"mr-2 h-4 w-4\" />\n                    <span>Provider Dashboard</span>\n                  </DropdownMenuItem>\n                )}\n                <DropdownMenuItem onClick={() => setLocation(\"/settings\")}>\n                  <Settings className=\"mr-2 h-4 w-4\" />\n                  <span>Settings</span>\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={handleLogout} className=\"text-red-500 focus:text-red-600 focus:bg-red-50\">\n                  <LogOut className=\"mr-2 h-4 w-4\" />\n                  <span>Log out</span>\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          ) : (\n            <Button onClick={() => setLocation(\"/login\")}>\n              Login / Signup\n            </Button>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}","size_bytes":9147},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    // --- YEH RAHA FIX ---\n    // Humne alias syntax ko object se array mein change kar diya hai\n    // Yeh zyada reliable hai\n    alias: [\n      { \n        find: \"@\", \n        replacement: path.resolve(import.meta.dirname, \"client/src\") \n      },\n      { \n        find: \"@shared\", \n        replacement: path.resolve(import.meta.dirname, \"shared\") \n      },\n      { \n        find: \"@assets\", \n        replacement: path.resolve(import.meta.dirname, \"attached_assets\") \n      },\n    ],\n    // --- FIX KHATAM ---\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});","size_bytes":1374},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/pages/cake-shop.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { ArrowLeft, Star, MapPin, Clock, Award, Cake } from \"lucide-react\";\n\nconst cakeCategories = [\n  { name: \"All Cakes\", active: true },\n  { name: \"Birthday\" },\n  { name: \"Anniversary\" },\n  { name: \"Wedding\" },\n  { name: \"Custom\" }\n];\n\n// Mock cake shop data\nconst mockCakeShops = [\n  {\n    id: \"1\",\n    name: \"Sweet Delights Bakery\",\n    rating: 4.9,\n    reviews: 456,\n    address: \"Mall Road, City Center\",\n    distance: \"0.8 km\",\n    image: \"https://images.unsplash.com/photo-1578985545062-69928b1d9587?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=200\",\n    cakes: [\n      {\n        name: \"Chocolate Truffle\",\n        image: \"https://images.unsplash.com/photo-1558636508-e0db3814bd1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400\",\n        weightOptions: [\n          { weight: \"500g\", price: 499 },\n          { weight: \"1kg\", price: 899 },\n          { weight: \"2kg\", price: 1699 }\n        ]\n      },\n      {\n        name: \"Strawberry Delight\",\n        image: \"https://images.unsplash.com/photo-1565958011703-44f9829ba187?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400\",\n        weightOptions: [\n          { weight: \"500g\", price: 549 },\n          { weight: \"1kg\", price: 999 },\n          { weight: \"2kg\", price: 1899 }\n        ]\n      },\n      {\n        name: \"Red Velvet\",\n        image: \"https://images.unsplash.com/photo-1586985289688-ca3cf47d3e6e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400\",\n        weightOptions: [\n          { weight: \"500g\", price: 599 },\n          { weight: \"1kg\", price: 1099 },\n          { weight: \"2kg\", price: 1999 }\n        ]\n      },\n      {\n        name: \"Custom Design\",\n        image: \"https://images.unsplash.com/photo-1535254973040-607b474cb50d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=400\",\n        isCustom: true,\n        startingPrice: 2499\n      }\n    ]\n  }\n];\n\nexport default function CakeShop() {\n  const [, setLocation] = useLocation();\n  const [activeCategory, setActiveCategory] = useState(\"All Cakes\");\n\n  const { data: cakeShops, isLoading } = useQuery({\n    queryKey: [\"/api/service-providers\", { category: \"cake\" }],\n    // Mock data for now\n    queryFn: () => Promise.resolve(mockCakeShops)\n  });\n\n  const handleOrderCake = (shopId: string, cakeName: string) => {\n    // Handle cake ordering logic\n    console.log(`Ordering ${cakeName} from ${shopId}`);\n  };\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Services</span>\n        </Button>\n\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\">Cake Shops</h2>\n          <p className=\"text-muted-foreground\">\n            Order delicious custom cakes for every occasion\n          </p>\n        </div>\n\n        {/* Cake Categories */}\n        <div className=\"mb-6 flex flex-wrap gap-2\">\n          {cakeCategories.map((category) => (\n            <Button\n              key={category.name}\n              variant={activeCategory === category.name ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setActiveCategory(category.name)}\n              data-testid={`category-${category.name.toLowerCase().replace(/\\s+/g, '-')}`}\n            >\n              {category.name}\n            </Button>\n          ))}\n        </div>\n\n        {/* Cake Shop Cards */}\n        <div className=\"space-y-6\">\n          {isLoading ? (\n            <div className=\"space-y-6\">\n              {[1, 2, 3].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex space-x-4\">\n                      <div className=\"w-20 h-20 bg-muted rounded-lg\"></div>\n                      <div className=\"flex-1 space-y-2\">\n                        <div className=\"h-4 bg-muted rounded w-1/4\"></div>\n                        <div className=\"h-3 bg-muted rounded w-1/2\"></div>\n                        <div className=\"h-3 bg-muted rounded w-1/3\"></div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : cakeShops?.length === 0 ? (\n            <Card>\n              <CardContent className=\"p-8 text-center\">\n                <Cake className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No cake shops found</h3>\n                <p className=\"text-muted-foreground\">\n                  Try adjusting your location or check back later for available shops.\n                </p>\n              </CardContent>\n            </Card>\n          ) : (\n            cakeShops?.map((shop: any) => (\n              <Card key={shop.id} className=\"shadow-md hover:shadow-lg transition-shadow\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-start justify-between mb-4\">\n                    <div className=\"flex items-start space-x-4\">\n                      <div className=\"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0\">\n                        <img \n                          src={shop.image} \n                          alt={shop.name}\n                          className=\"w-full h-full object-cover\"\n                        />\n                      </div>\n                      <div>\n                        <h3 className=\"text-xl font-semibold\">{shop.name}</h3>\n                        <div className=\"flex items-center space-x-1 mt-1\">\n                          <div className=\"flex items-center\">\n                            {[...Array(5)].map((_, i) => (\n                              <Star \n                                key={i} \n                                className={`h-4 w-4 ${\n                                  i < Math.floor(shop.rating) \n                                    ? \"text-yellow-500 fill-current\" \n                                    : \"text-gray-300\"\n                                }`}\n                              />\n                            ))}\n                          </div>\n                          <span className=\"text-sm font-medium\">{shop.rating}</span>\n                          <span className=\"text-sm text-muted-foreground\">({shop.reviews})</span>\n                        </div>\n                        <div className=\"flex items-center space-x-2 mt-2 text-sm text-muted-foreground\">\n                          <MapPin className=\"h-4 w-4\" />\n                          <span>{shop.address}</span>\n                          <span>â€¢</span>\n                          <span>{shop.distance} away</span>\n                        </div>\n                      </div>\n                    </div>\n                    <Badge variant=\"secondary\" className=\"flex items-center\">\n                      <Award className=\"h-3 w-3 mr-1\" />\n                      Popular\n                    </Badge>\n                  </div>\n\n                  {/* Cake Gallery */}\n                  <div className=\"border-t border-border pt-4 mt-4\">\n                    <h4 className=\"font-semibold mb-3\">Featured Cakes</h4>\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                      {shop.cakes.map((cake: any, index: number) => (\n                        <div \n                          key={index}\n                          className=\"group cursor-pointer\"\n                          onClick={() => handleOrderCake(shop.id, cake.name)}\n                          data-testid={`cake-${cake.name.toLowerCase().replace(/\\s+/g, '-')}`}\n                        >\n                          <div className=\"aspect-square rounded-lg overflow-hidden mb-2 relative\">\n                            <img \n                              src={cake.image} \n                              alt={cake.name}\n                              className=\"w-full h-full object-cover group-hover:scale-110 transition duration-300\"\n                            />\n                            <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition\"></div>\n                          </div>\n                          <h5 className=\"font-medium text-sm mb-1\">{cake.name}</h5>\n                          <div className=\"flex items-center justify-between\">\n                            {cake.isCustom ? (\n                              <span className=\"text-xs text-muted-foreground\">\n                                Starting â‚¹{cake.startingPrice}\n                              </span>\n                            ) : (\n                              <Select>\n                                <SelectTrigger className=\"text-xs h-8\">\n                                  <SelectValue placeholder=\"Select weight\" />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  {cake.weightOptions.map((option: any, optionIndex: number) => (\n                                    <SelectItem key={optionIndex} value={option.weight}>\n                                      {option.weight} - â‚¹{option.price}\n                                    </SelectItem>\n                                  ))}\n                                </SelectContent>\n                              </Select>\n                            )}\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n\n                    <div className=\"mt-4 flex items-center justify-between\">\n                      <p className=\"text-sm text-muted-foreground flex items-center\">\n                        <Clock className=\"h-4 w-4 mr-1\" />\n                        Order 24 hours in advance for custom cakes\n                      </p>\n                      <Button \n                        className=\"bg-primary hover:bg-primary/90\"\n                        data-testid={`button-view-all-${shop.id}`}\n                      >\n                        View All Cakes\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10736},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"server/index.ts":{"content":"// server/index.ts (UPDATED)\n\nimport express, { type Request, Response, NextFunction } from \"express\";\nimport session from \"express-session\";\nimport connectPgSimple from \"connect-pg-simple\";\nimport { pool } from \"./db\";\nimport { registerRoutes } from \"./routes\"; // registerRoutes from server/routes.ts\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\nconst PgStore = connectPgSimple(session);\n\n// Extend Express Session to include userId and userRole\ndeclare module 'express-session' {\n  interface SessionData {\n    userId?: string;\n    userRole?: string;\n  }\n}\n\n// Extend Request type to include rawBody\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use(\n  session({\n    store: new PgStore({\n      pool,\n      createTableIfMissing: true,\n    }),\n    secret: process.env.SESSION_SECRET || \"dev-secret-key-change-in-production\",\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      maxAge: 30 * 24 * 60 * 60 * 1000, // 30 days\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\", // Set to true only in production with HTTPS\n      sameSite: \"lax\",\n    },\n  })\n);\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(this, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"â€¦\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    console.error(err);\n    // In development, you might want to throw err to see full stack trace\n    // throw err; // Only throw in dev if you want server to crash on error\n  });\n\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();","size_bytes":2861},"client/src/pages/plumber.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport ProviderCard from \"@/components/provider-card\";\nimport CallRequestModal from \"@/components/call-request-modal\";\nimport { ArrowLeft, Wrench, Droplets, Aperture, ShowerHead, ChevronRight } from \"lucide-react\";\n\nconst problemCategories = [\n  {\n    id: \"leakage\",\n    name: \"Water Leakage\",\n    icon: Droplets,\n    subcategories: [\n      \"Pipe Leakage\",\n      \"Tap Leaking\",\n      \"Toilet Leakage\",\n      \"Ceiling Leak\",\n      \"Underground Leak\"\n    ]\n  },\n  {\n    id: \"blockage\",\n    name: \"Drain Blockage\",\n    icon: Aperture,\n    subcategories: [\n      \"Kitchen Sink Block\",\n      \"Bathroom Drain Block\", \n      \"Toilet Blockage\",\n      \"Main Drain Block\",\n      \"Other Blockage\"\n    ]\n  },\n  {\n    id: \"installation\",\n    name: \"New Installation\",\n    icon: ShowerHead,\n    subcategories: [\n      \"Bathroom Fitting\",\n      \"Kitchen Setup\",\n      \"Water Heater\",\n      \"Water Pump\",\n      \"Other Installation\"\n    ]\n  },\n  {\n    id: \"repair\",\n    name: \"Repair & Maintenance\",\n    icon: Wrench,\n    subcategories: [\n      \"Tap Repair\",\n      \"Flush Repair\",\n      \"Pipe Repair\",\n      \"Water Motor\",\n      \"General Repair\"\n    ]\n  }\n];\n\nexport default function Plumber() {\n  const [, setLocation] = useLocation();\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"\");\n  const [selectedSubcategory, setSelectedSubcategory] = useState<string>(\"\");\n  const [sortBy, setSortBy] = useState(\"distance\");\n  const [callModalOpen, setCallModalOpen] = useState(false);\n  const [selectedProvider, setSelectedProvider] = useState<any>(null);\n\n  const { data: providers, isLoading } = useQuery({\n    queryKey: [\"/api/service-providers\", { category: \"plumber\" }],\n  });\n\n  const handleCategorySelect = (categoryId: string) => {\n    setSelectedCategory(categoryId);\n    setSelectedSubcategory(\"\");\n  };\n\n  const handleSubcategorySelect = (subcategory: string) => {\n    setSelectedSubcategory(subcategory);\n  };\n\n  const handleCallRequest = (provider: any) => {\n    setSelectedProvider(provider);\n    setCallModalOpen(true);\n  };\n\n  const selectedCategoryData = problemCategories.find(cat => cat.id === selectedCategory);\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Services</span>\n        </Button>\n\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\">Find Plumbers</h2>\n          <p className=\"text-muted-foreground\">\n            Select your problem and we'll show you the best plumbers near you\n          </p>\n        </div>\n\n        {/* Problem Selection */}\n        <Card className=\"mb-8\">\n          <CardHeader>\n            <CardTitle>What's your problem?</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {/* Main Categories */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n              {problemCategories.map((category) => (\n                <div\n                  key={category.id}\n                  className={`border rounded-lg p-4 cursor-pointer transition-all ${\n                    selectedCategory === category.id\n                      ? \"border-primary bg-primary/5\"\n                      : \"border-border hover:border-primary hover:bg-primary/5\"\n                  }`}\n                  onClick={() => handleCategorySelect(category.id)}\n                  data-testid={`category-${category.id}`}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-3\">\n                      <category.icon className=\"h-5 w-5 text-primary\" />\n                      <span className=\"font-medium\">{category.name}</span>\n                    </div>\n                    <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Subcategory Selection */}\n            {selectedCategoryData && (\n              <Card className=\"bg-muted/30\">\n                <CardContent className=\"p-4\">\n                  <h4 className=\"font-medium mb-3\">Select specific issue:</h4>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {selectedCategoryData.subcategories.map((subcategory) => (\n                      <Button\n                        key={subcategory}\n                        variant={selectedSubcategory === subcategory ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        onClick={() => handleSubcategorySelect(subcategory)}\n                        data-testid={`subcategory-${subcategory.toLowerCase().replace(/\\s+/g, '-')}`}\n                      >\n                        {subcategory}\n                      </Button>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Available Plumbers */}\n        <div>\n          <div className=\"flex items-center justify-between mb-6\">\n            <h3 className=\"text-xl font-semibold\">Available Plumbers Near You</h3>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-sm text-muted-foreground\">Sort by:</span>\n              <Select value={sortBy} onValueChange={setSortBy}>\n                <SelectTrigger className=\"w-32\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"distance\">Distance</SelectItem>\n                  <SelectItem value=\"rating\">Rating</SelectItem>\n                  <SelectItem value=\"experience\">Experience</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          {isLoading ? (\n            <div className=\"space-y-4\">\n              {[1, 2, 3].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex space-x-4\">\n                      <div className=\"w-16 h-16 bg-muted rounded-lg\"></div>\n                      <div className=\"flex-1 space-y-2\">\n                        <div className=\"h-4 bg-muted rounded w-1/4\"></div>\n                        <div className=\"h-3 bg-muted rounded w-1/2\"></div>\n                        <div className=\"h-3 bg-muted rounded w-1/3\"></div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {providers?.length === 0 ? (\n                <Card>\n                  <CardContent className=\"p-8 text-center\">\n                    <Wrench className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                    <h3 className=\"text-lg font-semibold mb-2\">No plumbers found</h3>\n                    <p className=\"text-muted-foreground\">\n                      Try adjusting your location or check back later for available providers.\n                    </p>\n                  </CardContent>\n                </Card>\n              ) : (\n                providers?.map((provider: any) => (\n                  <ProviderCard\n                    key={provider.id}\n                    provider={provider}\n                    onCallRequest={() => handleCallRequest(provider)}\n                    onSchedule={() => {}}\n                  />\n                ))\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Call Request Modal */}\n      <CallRequestModal\n        open={callModalOpen}\n        onClose={() => setCallModalOpen(false)}\n        provider={selectedProvider}\n      />\n    </div>\n  );\n}\n","size_bytes":8339},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/pages/rental.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { ArrowLeft, Home as HomeIcon, MapPin, DollarSign, Image } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst propertyTypes = [\n    { value: \"apartment\", label: \"Apartment\" },\n    { value: \"house\", label: \"Independent House\" },\n    { value: \"villa\", label: \"Villa\" },\n];\n\nconst furnishingOptions = [\n    { value: \"furnished\", label: \"Fully Furnished\" },\n    { value: \"semifurnished\", label: \"Semi Furnished\" },\n    { value: \"unfurnished\", label: \"Unfurnished\" },\n];\n\n// NOTE: This component assumes you have authentication and can get the current userId\nconst MOCK_OWNER_ID = \"owner-user-123\"; \n\nexport default function PostProperty() {\n    const { toast } = useToast();\n    const [, setLocation] = useLocation();\n\n    // Form State\n    const [formData, setFormData] = useState({\n        title: '', description: '', rent: '', propertyType: '', \n        bedrooms: '1', bathrooms: '1', area: '', furnishing: '', locality: '', \n        address: '', images: [] as string[]\n    });\n\n    // Simple change handler\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n        const { id, value } = e.target;\n        setFormData(prev => ({ ...prev, [id]: value }));\n    };\n\n    // Select change handler\n    const handleSelectChange = (id: string, value: string) => {\n        setFormData(prev => ({ ...prev, [id]: value }));\n    };\n\n    // Mutation hook to submit data\n    const postPropertyMutation = useMutation({\n        mutationFn: (propertyData: any) => {\n            // NOTE: In the backend (routes.ts), ensure you're getting ownerId from the session, not the body!\n            return apiRequest('POST', '/api/rental-properties', propertyData);\n        },\n        onSuccess: () => {\n            toast({ title: \"Success!\", description: \"Property listed successfully. Tenants will contact you soon.\" });\n            setLocation('/rental'); // Redirect to listing page\n        },\n        onError: (error: any) => {\n            console.error(\"Post Error:\", error);\n            toast({ title: \"Failed\", description: error.message || \"Failed to list property.\", variant: \"destructive\" });\n        },\n    });\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n\n        const dataToSend = {\n            ownerId: MOCK_OWNER_ID, // This should come from Auth context/session\n            ...formData,\n            rent: parseInt(formData.rent) || 0,\n            bedrooms: parseInt(formData.bedrooms) || 0,\n            bathrooms: parseInt(formData.bathrooms) || 0,\n            area: parseInt(formData.area) || 0,\n        };\n\n        if (!dataToSend.title || !dataToSend.rent || !dataToSend.locality || !dataToSend.propertyType) {\n             return toast({ title: \"Missing Info\", description: \"Please fill in all required fields (Title, Rent, Locality, Type).\", variant: \"destructive\" });\n        }\n\n        postPropertyMutation.mutate(dataToSend);\n    };\n\n    return (\n        <div className=\"min-h-screen bg-gray-50 py-12\">\n            <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n\n                <Button variant=\"ghost\" onClick={() => setLocation(\"/rental\")} className=\"mb-6 text-primary\">\n                    <ArrowLeft className=\"h-4 w-4 mr-2\" /> Back to Rentals\n                </Button>\n\n                <Card className=\"shadow-2xl\">\n                    <CardHeader>\n                        <div className=\"flex items-center gap-3\">\n                            <HomeIcon className=\"h-8 w-8 text-primary\" />\n                            <h2 className=\"text-3xl font-bold\">List Your Property</h2>\n                        </div>\n                        <p className=\"text-muted-foreground mt-1\">Fill the details accurately to attract verified tenants quickly.</p>\n                    </CardHeader>\n                    <CardContent>\n                        <form onSubmit={handleSubmit} className=\"space-y-6\">\n\n                            {/* BASIC DETAILS */}\n                            <h3 className=\"text-xl font-semibold border-b pb-2 mb-4\">1. Basic Property Information</h3>\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                <div>\n                                    <Label htmlFor=\"title\">Listing Title (e.g., Spacious 3 BHK)</Label>\n                                    <Input id=\"title\" placeholder=\"Catchy title for your property\" value={formData.title} onChange={handleChange} required />\n                                </div>\n                                <div>\n                                    <Label htmlFor=\"rent\">Monthly Rent (â‚¹)</Label>\n                                    <Input id=\"rent\" type=\"number\" placeholder=\"e.g., 25000\" value={formData.rent} onChange={handleChange} required />\n                                </div>\n                            </div>\n\n                            <div>\n                                <Label htmlFor=\"description\">Detailed Description</Label>\n                                <Textarea id=\"description\" placeholder=\"Describe amenities, surroundings, and USPs.\" value={formData.description} onChange={handleChange} rows={4} />\n                            </div>\n\n                            {/* TYPE & CONFIGURATION */}\n                            <h3 className=\"text-xl font-semibold border-b pb-2 pt-4 mb-4\">2. Configuration</h3>\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                                <div>\n                                    <Label>Property Type</Label>\n                                    <Select onValueChange={(v) => handleSelectChange('propertyType', v)} value={formData.propertyType} required>\n                                        <SelectTrigger><SelectValue placeholder=\"Select Type\" /></SelectTrigger>\n                                        <SelectContent>\n                                            {propertyTypes.map(type => <SelectItem key={type.value} value={type.value}>{type.label}</SelectItem>)}\n                                        </SelectContent>\n                                    </Select>\n                                </div>\n                                <div>\n                                    <Label htmlFor=\"bedrooms\">Bedrooms</Label>\n                                    <Input id=\"bedrooms\" type=\"number\" min=\"1\" value={formData.bedrooms} onChange={handleChange} />\n                                </div>\n                                <div>\n                                    <Label htmlFor=\"bathrooms\">Bathrooms</Label>\n                                    <Input id=\"bathrooms\" type=\"number\" min=\"1\" value={formData.bathrooms} onChange={handleChange} />\n                                </div>\n                                <div>\n                                    <Label htmlFor=\"area\">Area (sqft)</Label>\n                                    <Input id=\"area\" type=\"number\" placeholder=\"e.g., 1200\" value={formData.area} onChange={handleChange} />\n                                </div>\n                            </div>\n\n                            {/* LOCATION AND FURNISHING */}\n                            <h3 className=\"text-xl font-semibold border-b pb-2 pt-4 mb-4\">3. Location & Furnishing</h3>\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                <div>\n                                    <Label htmlFor=\"locality\">Locality (Required)</Label>\n                                    <Input id=\"locality\" placeholder=\"e.g., Koramangala, Whitefield\" value={formData.locality} onChange={handleChange} required />\n                                </div>\n                                <div>\n                                    <Label>Furnishing Status</Label>\n                                    <Select onValueChange={(v) => handleSelectChange('furnishing', v)} value={formData.furnishing} required>\n                                        <SelectTrigger><SelectValue placeholder=\"Select Furnishing\" /></SelectTrigger>\n                                        <SelectContent>\n                                            {furnishingOptions.map(option => <SelectItem key={option.value} value={option.value}>{option.label}</SelectItem>)}\n                                        </SelectContent>\n                                    </Select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <Label htmlFor=\"address\">Full Address (Internal Use)</Label>\n                                <Input id=\"address\" placeholder=\"Flat No., Building Name\" value={formData.address} onChange={handleChange} />\n                            </div>\n\n                            {/* IMAGE UPLOAD (Mock) */}\n                            <h3 className=\"text-xl font-semibold border-b pb-2 pt-4 mb-4\">4. Photos</h3>\n                            <div className=\"border border-dashed border-gray-300 p-6 rounded-lg text-center\">\n                                <Image className=\"h-8 w-8 text-muted-foreground mx-auto mb-2\" />\n                                <p className=\"text-sm text-muted-foreground\">Upload Property Photos (Max 5)</p>\n                                {/* In a real app, this would handle file uploads */}\n                                <Button type=\"button\" variant=\"outline\" className=\"mt-3\">Select Files</Button>\n                            </div>\n\n\n                            {/* SUBMIT */}\n                            <Button \n                                type=\"submit\" \n                                className=\"w-full mt-6\" \n                                size=\"lg\" \n                                disabled={postPropertyMutation.isPending}\n                            >\n                                {postPropertyMutation.isPending ? \"Listing Property...\" : \"Submit Property & Go Live\"}\n                            </Button>\n\n                        </form>\n                    </CardContent>\n                </Card>\n            </div>\n        </div>\n    );\n}\n","size_bytes":10599},"shared/schema.ts":{"content":"// server/src/shared/schema.ts (UPDATED)\n\nimport { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, decimal, boolean, timestamp, serial, jsonb } from \"drizzle-orm/pg-core\";\nimport { createId } from \"@paralleldrive/cuid2\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n\n// Users table\nexport const users = pgTable(\"users\", {\n  id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  username: text(\"username\").notNull().unique(),\n  email: text(\"email\").notNull().unique(),\n  phone: text(\"phone\"),\n  password: text(\"password\").notNull(),\n  role: text(\"role\").default(\"customer\"), // customer, provider, admin\n  stripeCustomerId: text(\"stripe_customer_id\"),\n  stripeSubscriptionId: text(\"stripe_subscription_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Service categories\nexport const serviceCategories = pgTable(\"service_categories\", {\n  id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  name: text(\"name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  icon: text(\"icon\"),\n  description: text(\"description\"),\n});\n\n// Service providers\nexport const serviceProviders = pgTable(\"service_providers\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  categoryId: varchar(\"category_id\").references(() => serviceCategories.id).notNull(),\n  businessName: text(\"business_name\").notNull(),\n  description: text(\"description\"),\n  profileImageUrl: text(\"profile_image_url\"), \n    galleryImages: jsonb(\"gallery_images\").$type<string[]>(),\n  experience: integer(\"experience_years\"),\n  rating: decimal(\"rating\", { precision: 3, scale: 2 }).default(\"0.00\"),\n  reviewCount: integer(\"review_count\").default(0),\n  address: text(\"address\").notNull(),\n  latitude: decimal(\"latitude\", { precision: 10, scale: 8 }),\n  longitude: decimal(\"longitude\", { precision: 11, scale: 8 }),\n  serviceArea: integer(\"service_area_km\").default(10),\n  isVerified: boolean(\"is_verified\").default(false),\n  isAvailable: boolean(\"is_available\").default(true),\n  specializations: jsonb(\"specializations\").$type<string[]>(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Service problems/categories (for electrician, plumber)\nexport const serviceProblems = pgTable(\"service_problems\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  categoryId: varchar(\"category_id\").references(() => serviceCategories.id).notNull(),\n  name: text(\"name\").notNull(),\n  parentId: varchar(\"parent_id\"),\n});\n\n// Beauty services (UPDATED)\nexport const beautyServices = pgTable(\"beauty_services\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  providerId: varchar(\"provider_id\") // providerId type matches serviceProviders.id\n    .notNull()\n    .references(() => serviceProviders.id, { onDelete: \"cascade\" }),\n  name: text(\"name\").notNull(), // Service ka naam (e.g., \"Haircut\", \"Facial\")\n  description: text(\"description\"), // Service ki description\n  imageUrl: text(\"image_url\"), // Service ki image\n  duration: integer(\"duration_minutes\"), // Service kitni der ki hai (in minutes)\n  price: decimal(\"price\", { precision: 10, scale: 2 }).notNull(), // Service ki price\n  category: text(\"category\"), // Category (e.g., \"Hair\", \"Skin\", \"Nails\")\n  subCategory: text(\"sub_category\"), // Naya field: subCategory\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(), // Naya field: updatedAt\n});\n\n// Cake products\nexport const cakeProducts = pgTable(\"cake_products\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id).notNull(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  category: text(\"category\"), // Birthday, Anniversary, Wedding, Custom\n  imageUrl: text(\"image_url\"),\n  basePrice: decimal(\"base_price\", { precision: 10, scale: 2 }).notNull(),\n  weightOptions: jsonb(\"weight_options\").$type<Array<{ weight: string; price: number }>>(),\n  isCustomizable: boolean(\"is_customizable\").default(false),\n});\n\n// Grocery products\nexport const groceryProducts = pgTable(\"grocery_products\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id).notNull(),\n  name: varchar(\"name\", { length: 256 }).notNull(),\n  description: text(\"description\"),\n  category: varchar(\"category\", { length: 256 }).notNull(), // Category slug (e.g., \"fruits\")\n  price: varchar(\"price\", { length: 50 }).notNull(), // Price as string to handle currency symbols easily\n  weight: varchar(\"weight\", { length: 100 }), // e.g., \"1 kg\", \"500g\"\n  unit: varchar(\"unit\", { length: 50 }), // e.g., \"kg\", \"dozen\", \"pack\"\n  inStock: boolean(\"in_stock\").default(true).notNull(),\n  stockQuantity: integer(\"stock_quantity\").default(0).notNull(),\n  imageUrl: varchar(\"image_url\", { length: 256 }),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Rental properties\nexport const rentalProperties = pgTable(\"rental_properties\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  ownerId: varchar(\"owner_id\").references(() => users.id).notNull(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  propertyType: text(\"property_type\").notNull(), // 1BHK, 2BHK, etc.\n  rent: decimal(\"rent\", { precision: 10, scale: 2 }).notNull(),\n  area: integer(\"area_sqft\"),\n  bedrooms: integer(\"bedrooms\"),\n  bathrooms: integer(\"bathrooms\"),\n  furnishing: text(\"furnishing\"), // Furnished, Semi-Furnished, Unfurnished\n  address: text(\"address\").notNull(),\n  locality: text(\"locality\"),\n  latitude: decimal(\"latitude\", { precision: 10, scale: 8 }),\n  longitude: decimal(\"longitude\", { precision: 11, scale: 8 }),\n  amenities: jsonb(\"amenities\").$type<string[]>(),\n  images: jsonb(\"images\").$type<string[]>(),\n  isAvailable: boolean(\"is_available\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Bookings/Service requests (ELECTRICIAN FLOW KE LIYE UPDATED)\nexport const bookings = pgTable(\"bookings\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id),\n  serviceType: text(\"service_type\").notNull(),\n  problemId: varchar(\"problem_id\").references(() => serviceProblems.id),\n\n  // STATUS FLOW: \n  // pending -> accepted -> in_progress -> awaiting_otp -> awaiting_billing -> pending_payment -> completed\n  // 'pending' se 'declined' ya 'cancelled' bhi ho sakta hai\n  status: text(\"status\").default(\"pending\"), \n\n  scheduledAt: timestamp(\"scheduled_at\"),\n  preferredTimeSlots: jsonb(\"preferred_time_slots\").$type<string[]>(),\n  userAddress: text(\"user_address\").notNull(),\n  userPhone: text(\"user_phone\").notNull(),\n  notes: text(\"notes\"),\n  estimatedCost: decimal(\"estimated_cost\", { precision: 10, scale: 2 }), // Yeh provider accept karte waqt de sakta hai\n  createdAt: timestamp(\"created_at\").defaultNow(),\n\n  // --- NAYE FIELDS AAPKE ELECTRICIAN FLOW KE LIYE ---\n  isUrgent: boolean(\"is_urgent\").default(false), // Customer yeh 'true' set karega agar urgent hai\n  serviceOtp: text(\"service_otp\"), // 6-digit OTP jo provider verify karega\n  serviceOtpExpiresAt: timestamp(\"service_otp_expires_at\"), // OTP expiry time\n  invoiceId: text(\"invoice_id\").references(() => invoices.id), // Final bill/invoice se link\n});\n\n// Grocery orders\nexport const groceryOrders = pgTable(\"grocery_orders\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  items: jsonb(\"items\").$type<Array<{ productId: string; quantity: number; price: number }>>(),\n  subtotal: decimal(\"subtotal\", { precision: 10, scale: 2 }).notNull(),\n  platformFee: decimal(\"platform_fee\", { precision: 10, scale: 2 }).notNull(),\n  deliveryFee: decimal(\"delivery_fee\", { precision: 10, scale: 2 }).notNull(),\n  total: decimal(\"total\", { precision: 10, scale: 2 }).notNull(),\n  deliveryAddress: text(\"delivery_address\").notNull(),\n  status: text(\"status\").default(\"pending\"), // pending, confirmed, delivered, cancelled\n  razorpayOrderId: text(\"razorpay_order_id\"),     \n  razorpayPaymentId: text(\"razorpay_payment_id\"), \n  razorpaySignature: text(\"razorpay_signature\"), \n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// --- YEH AAPKE FLOW KE LIYE NAYA TABLE HAI ---\n// Final Invoice/Bill\nexport const invoices = pgTable(\"invoices\", {\n  id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  bookingId: varchar(\"booking_id\").references(() => bookings.id).notNull().unique(), // Har booking ka ek hi invoice\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id).notNull(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n\n  sparePartsDetails: jsonb(\"spare_parts_details\").$type<Array<{ part: string; cost: number }>>(),\n  sparePartsTotal: decimal(\"spare_parts_total\", { precision: 10, scale: 2 }).default(\"0.00\"),\n  serviceCharge: decimal(\"service_charge\", { precision: 10, scale: 2 }).notNull(),\n  totalAmount: decimal(\"total_amount\", { precision: 10, scale: 2 }).notNull(),\n\n  paymentStatus: text(\"payment_status\").default(\"pending\"), // pending, completed\n  razorpayOrderId: text(\"razorpay_order_id\"),\n  razorpayPaymentId: text(\"razorpay_payment_id\"),\n\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n\n// Street food menu items\nexport const streetFoodItems = pgTable(\"street_food_items\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  providerId: text(\"provider_id\").notNull().references(() => serviceProviders.id),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  imageUrl: text(\"image_url\"),\n  category: text(\"category\"),\n  price: text(\"price\").notNull(),\n  isVeg: boolean(\"is_veg\").default(true),\n  isAvailable: boolean(\"is_available\").default(true),\n  spicyLevel: text(\"spicy_level\"), // Mild, Medium, Hot\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Restaurant menu items\nexport const restaurantMenuItems = pgTable(\"restaurant_menu_items\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id).notNull(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  category: text(\"category\"), // Starters, Main Course, Desserts, Beverages\n  imageUrl: text(\"image_url\"),\n  price: decimal(\"price\", { precision: 10, scale: 2 }).notNull(),\n  isVeg: boolean(\"is_veg\").default(true),\n  isAvailable: boolean(\"is_available\").default(true),\n  cuisine: text(\"cuisine\"), // Indian, Chinese, Italian, etc.\n});\n\n// Restaurant table bookings\nexport const tableBookings = pgTable(\"table_bookings\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id).notNull(),\n  date: timestamp(\"booking_date\").notNull(),\n  timeSlot: text(\"time_slot\").notNull(),\n  numberOfGuests: integer(\"number_of_guests\").notNull(),\n  specialRequests: text(\"special_requests\"),\n  status: text(\"status\").default(\"pending\"), // pending, confirmed, cancelled, completed\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Reviews\nexport const reviews = pgTable(\"reviews\", {\n   id: text(\"id\").$defaultFn(() => createId()).primaryKey(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  providerId: varchar(\"provider_id\").references(() => serviceProviders.id).notNull(),\n  bookingId: varchar(\"booking_id\").references(() => bookings.id),\n  rating: integer(\"rating\").notNull(),\n  comment: text(\"comment\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  serviceProviders: many(serviceProviders),\n  bookings: many(bookings),\n  reviews: many(reviews),\n  rentalProperties: many(rentalProperties),\n  groceryOrders: many(groceryOrders),\n  invoices: many(invoices), // NAYA\n}));\n\nexport const serviceProvidersRelations = relations(serviceProviders, ({ one, many }) => ({\n  user: one(users, {\n    fields: [serviceProviders.userId],\n    references: [users.id],\n  }),\n  category: one(serviceCategories, {\n    fields: [serviceProviders.categoryId],\n    references: [serviceCategories.id],\n  }),\n  bookings: many(bookings),\n  reviews: many(reviews),\n  beautyServices: many(beautyServices), \n  cakeProducts: many(cakeProducts),\n  streetFoodItems: many(streetFoodItems),\n  restaurantMenuItems: many(restaurantMenuItems),\n  tableBookings: many(tableBookings),\n  groceryProducts: many(groceryProducts),\n  invoices: many(invoices), // NAYA\n}));\n\nexport const bookingsRelations = relations(bookings, ({ one }) => ({\n  user: one(users, {\n    fields: [bookings.userId],\n    references: [users.id],\n  }),\n  provider: one(serviceProviders, {\n    fields: [bookings.providerId],\n    references: [serviceProviders.id],\n  }),\n  problem: one(serviceProblems, {\n    fields: [bookings.problemId],\n    references: [serviceProblems.id],\n  }),\n  invoice: one(invoices, { // NAYA\n    fields: [bookings.invoiceId],\n    references: [invoices.id],\n  }),\n}));\n\n// NAYA RELATION\nexport const invoicesRelations = relations(invoices, ({ one }) => ({\n  booking: one(bookings, {\n    fields: [invoices.bookingId],\n    references: [bookings.id],\n  }),\n  provider: one(serviceProviders, {\n    fields: [invoices.providerId],\n    references: [serviceProviders.id],\n  }),\n  user: one(users, {\n    fields: [invoices.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const groceryProductsRelations = relations(groceryProducts, ({ one }) => ({\n  provider: one(serviceProviders, {\n    fields: [groceryProducts.providerId],\n    references: [serviceProviders.id],\n  }),\n}));\n\n// Insert schemas\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  email: true,\n  phone: true,\n  password: true,\n  role: true,\n});\n\nexport const insertServiceProviderSchema = createInsertSchema(serviceProviders).pick({\n  businessName: true,\n  description: true,\n  experience: true,\n  address: true,\n  latitude: true,\n  longitude: true,\n  specializations: true,\n});\n\n// BOOKING SCHEMA UPDATE KARO\nexport const insertBookingSchema = createInsertSchema(bookings).pick({\n  serviceType: true,\n  problemId: true,\n  scheduledAt: true,\n  preferredTimeSlots: true,\n  userAddress: true,\n  userPhone: true,\n  notes: true,\n  isUrgent: true, // NAYA FIELD ADD KARO\n});\n\nexport const insertGroceryOrderSchema = createInsertSchema(groceryOrders).pick({\n  items: true,\n  subtotal: true,\n  platformFee: true,\n  deliveryFee: true,\n  total: true,\n  deliveryAddress: true,\n});\n\nexport const insertRentalPropertySchema = createInsertSchema(rentalProperties).pick({\n  title: true,\n  description: true,\n  propertyType: true,\n  rent: true,\n  area: true,\n  bedrooms: true,\n  bathrooms: true,\n  furnishing: true,\n  address: true,\n  locality: true,\n  latitude: true,\n  longitude: true,\n  amenities: true,\n  images: true,\n});\n\nexport const insertTableBookingSchema = createInsertSchema(tableBookings).pick({\n  date: true,\n  timeSlot: true,\n  numberOfGuests: true,\n  specialRequests: true,\n});\n\nexport const insertBeautyServiceSchema = createInsertSchema(beautyServices).pick({\n  name: true,\n  description: true,\n  imageUrl: true,\n  duration: true,\n  price: true,\n  category: true,\n  subCategory: true,\n});\n\n// NAYA INVOICE SCHEMA\nexport const insertInvoiceSchema = createInsertSchema(invoices).pick({\n  bookingId: true,\n  providerId: true,\n  userId: true,\n  sparePartsDetails: true,\n  sparePartsTotal: true,\n  serviceCharge: true,\n  totalAmount: true,\n});\n\n\n// Types\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type ServiceProvider = typeof serviceProviders.$inferSelect;\nexport type InsertServiceProvider = z.infer<typeof insertServiceProviderSchema>;\nexport type Booking = typeof bookings.$inferSelect;\nexport type InsertBooking = z.infer<typeof insertBookingSchema>;\nexport type GroceryOrder = typeof groceryOrders.$inferSelect;\nexport type InsertGroceryOrder = z.infer<typeof insertGroceryOrderSchema>;\nexport type RentalProperty = typeof rentalProperties.$inferSelect;\nexport type InsertRentalProperty = z.infer<typeof insertRentalPropertySchema>;\nexport type ServiceCategory = typeof serviceCategories.$inferSelect;\nexport type ServiceProblem = typeof serviceProblems.$inferSelect;\nexport type BeautyService = typeof beautyServices.$inferSelect;\nexport type InsertBeautyService = z.infer<typeof insertBeautyServiceSchema>; \nexport type CakeProduct = typeof cakeProducts.$inferSelect;\nexport type GroceryProduct = typeof groceryProducts.$inferSelect;\nexport type StreetFoodItem = typeof streetFoodItems.$inferSelect;\nexport type RestaurantMenuItem = typeof restaurantMenuItems.$inferSelect;\nexport type TableBooking = typeof tableBookings.$inferSelect;\nexport type InsertTableBooking = z.infer<typeof insertTableBookingSchema>;\nexport type Review = typeof reviews.$inferSelect;\nexport type Invoice = typeof invoices.$inferSelect; // NAYA TYPE\nexport type InsertInvoice = z.infer<typeof insertInvoiceSchema>; // NAYA TYPE","size_bytes":17363},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"design_guidelines.md":{"content":"# ServiceHub Design Guidelines\n\n## Design Approach: Reference-Based (Marketplace Hybrid)\nDrawing inspiration from **Airbnb's card aesthetics**, **Swiggy's service differentiation**, and **Uber's clear CTAs**, creating a vibrant multi-service marketplace that balances visual appeal with functional clarity.\n\n## Core Design Principles\n- **Service Identity**: Each service has distinct color personality while maintaining cohesive brand\n- **Visual Hierarchy**: Hero imagery â†’ Service cards â†’ Clear actions\n- **Breathing Room**: Generous spacing between service categories\n- **Progressive Discovery**: Guide users from browsing to booking\n\n## Color System\n\n**Brand Colors (Dark Mode Primary)**\n- Primary: 220 70% 50% (Trustworthy blue)\n- Background: 222 84% 5% (Deep slate)\n- Surface: 217 33% 12% (Elevated cards)\n- Text Primary: 210 40% 98%\n- Text Secondary: 215 20% 65%\n\n**Service Color Identifiers** (Use as accent borders/badges on cards):\n- Electrician: 45 93% 58% (Electric yellow)\n- Plumber: 200 85% 55% (Water blue)\n- Beauty Parlor: 330 75% 65% (Rose pink)\n- Cake Shops: 340 82% 60% (Sweet coral)\n- GMart: 142 71% 45% (Fresh green)\n- Rentals: 280 60% 55% (Property purple)\n- Street Food: 25 95% 53% (Spicy orange)\n- Restaurants: 15 85% 50% (Warm amber)\n\n## Typography\n**Fonts**: Inter (primary), Outfit (headings) via Google Fonts\n- Hero: text-5xl/text-6xl font-bold tracking-tight\n- Section Headers: text-3xl/text-4xl font-semibold\n- Service Titles: text-xl font-semibold\n- Body: text-base/text-lg\n- CTAs: text-base font-medium\n\n## Layout System\n**Spacing Units**: Consistent use of 4, 6, 8, 12, 16, 20, 24 (tailwind units)\n- Section padding: py-16/py-20 (mobile/desktop)\n- Card gaps: gap-6/gap-8\n- Container: max-w-7xl mx-auto px-4/px-6\n\n## Component Library\n\n### Homepage Hero\n- **Full-width image backdrop** (h-[600px]) with dark gradient overlay\n- Centered content: Large headline + search bar + service quick-links\n- Search bar: Elevated card with location + service selector + CTA\n- Variant=\"outline\" buttons with backdrop-blur-lg bg-white/10\n\n### Service Category Grid\n- 4-column grid (lg:grid-cols-4 md:grid-cols-2 grid-cols-1)\n- Cards: Rounded-2xl, hover:scale-105 transition, image top + content below\n- Each card: Service icon/image, title, brief description, color-coded left border (4px)\n- \"Explore\" button with service-specific accent color\n\n### Individual Service Pages\n**Hero Section**: Service-specific full-width image (h-96) with overlay, breadcrumb nav, service name\n**Listings Grid**: 3-column card layout (lg:grid-cols-3)\n- Provider cards: Image, name, rating (stars), price range, \"Book Now\" CTA\n- Badges: \"Top Rated\", \"Fast Response\" with subtle backgrounds\n\n### Navigation\n- Sticky header: Logo left, service dropdown center, location + profile right\n- Mobile: Hamburger menu revealing full-screen overlay with service categories\n\n### Forms & Inputs\n- Rounded-xl inputs with focus:ring-2 in service accent colors\n- Dark backgrounds (bg-surface) with light text\n- Labels: text-sm text-secondary mb-2\n\n### Cards (Universal Pattern)\n- Background: Surface color with border border-white/10\n- Padding: p-6\n- Shadow: shadow-lg shadow-black/20\n- Hover state: transform scale-105, transition-transform duration-200\n\n### CTAs\n- Primary: Service accent color bg, white text, px-6 py-3, rounded-lg\n- Secondary: Outlined variant with hover:bg-accent/10\n- Ghost: Text-only with hover:bg-white/5\n\n## Images Strategy\n\n**Homepage**:\n- **Large Hero Image**: Full-width lifestyle shot showing diverse services in action (collage style or split-screen) - 1920x600px\n- Service category cards: 8 representative images (400x300px each) - electrician with tools, plumber at work, beauty salon interior, decorated cakes, grocery aisles, modern apartment, street food stall, restaurant ambiance\n\n**Service Pages**:\n- Service-specific hero: Contextual imagery (electrician: modern electrical panel, plumber: clean bathroom fixtures, etc.)\n- Provider profile images: Square headshots or service photos (200x200px)\n- Gallery images: Work samples/menu items as needed (variable sizes in masonry/grid)\n\n**Quality**: High-resolution, professional photography with consistent color grading (slightly warm tones, good contrast)\n\n## Responsive Behavior\n- Desktop: Multi-column grids, side-by-side layouts\n- Tablet: 2-column grids, stacked hero content\n- Mobile: Single column, bottom sheet filters, sticky CTAs\n\n## Unique Features\n- **Service Switcher**: Floating bottom-right button (mobile) to quick-switch between services\n- **Location Banner**: Subtle top banner showing current service area with change option\n- **Unified Search**: Global search bar supporting \"Electrician near me\" or \"Cake shops in [area]\"\n- **Cross-Service Suggestions**: \"People also booked\" cards showing complementary services\n\n**Accessibility**: WCAG AA contrast ratios maintained, all interactive elements keyboard navigable, service colors tested for colorblind users","size_bytes":4949},"client/src/pages/electrician.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { \n  Select, \n  SelectContent, \n  SelectItem, \n  SelectTrigger, \n  SelectValue \n} from \"@/components/ui/select\";\nimport ProviderCard from \"@/components/provider-card\";\nimport { ArrowLeft, Search, Loader2 } from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\"; // Asli API request function import kiya\nimport type { ServiceProvider, ServiceProblem, User, ServiceCategory } from \"@shared/schema\";\n\n// Types define kiye\ntype ElectricianProvider = ServiceProvider & { user: User; category: ServiceCategory };\n\nexport default function Electrician() {\n  const [, setLocation] = useLocation();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedAppliance, setSelectedAppliance] = useState(\"\");\n  const [selectedProblem, setSelectedProblem] = useState(\"\");\n\n  // 1. Get all electricians (Profiles)\n  const { data: providers, isLoading: providersLoading } = useQuery<ElectricianProvider[]>({\n    queryKey: [\"service-providers\", \"electrician\"],\n    queryFn: () => \n      apiRequest(\"GET\", \"/api/service-providers?category=electrician\")\n        .then(res => res.json()),\n  });\n\n  // 2. Get appliance categories (Parent Problems)\n  const { data: appliances, isLoading: appliancesLoading } = useQuery<ServiceProblem[]>({\n    queryKey: [\"service-problems\", \"electrician\"],\n    queryFn: () => \n      apiRequest(\"GET\", \"/api/service-problems?category=electrician\")\n        .then(res => res.json()),\n    // Yeh hamesha enabled rahega\n  });\n\n  // 3. Get problems for selected appliance (Child Problems)\n  const { data: problems, isLoading: problemsLoading } = useQuery<ServiceProblem[]>({\n    queryKey: [\"service-problems\", \"electrician\", selectedAppliance],\n    queryFn: () => \n      apiRequest(\"GET\", `/api/service-problems?category=electrician&parentId=${selectedAppliance}`)\n        .then(res => res.json()),\n    enabled: !!selectedAppliance, // Jab selectedAppliance ho tabhi chalao\n  });\n\n  // Filter providers based on search and selected problem/appliance\n  const filteredProviders = useMemo(() => {\n    if (!providers) return [];\n\n    let filtered = providers;\n\n    // Search filter\n    if (searchQuery) {\n      filtered = filtered.filter((provider) =>\n        provider.businessName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        provider.address?.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n    }\n\n    // Specialization (Appliance) filter\n    if (selectedAppliance) {\n      const applianceName = appliances?.find(a => a.id === selectedAppliance)?.name;\n      if (applianceName) {\n        filtered = filtered.filter(provider => \n          provider.specializations?.includes(applianceName)\n        );\n      }\n    }\n\n    // TODO: Problem-specific filter (agar backend support karta hai)\n    // Abhi ke liye, hum sirf appliance (specialization) se filter kar rahe hain\n\n    return filtered;\n  }, [providers, searchQuery, selectedAppliance, appliances]);\n\n  const handleApplianceChange = (value: string) => {\n    setSelectedAppliance(value);\n    setSelectedProblem(\"\"); // Reset problem selection\n  };\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Services</span>\n        </Button>\n\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\">Find Technicians & Electricians</h2>\n          <p className=\"text-muted-foreground\">\n            Search by name or filter by appliance and problem\n          </p>\n        </div>\n\n        {/* Search and Filter Bar */}\n        <Card className=\"mb-8\">\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              {/* Search Bar */}\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search electricians by name or location...\"\n                  className=\"pl-10\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-electrician\"\n                />\n              </div>\n\n              {/* Appliance and Problem Filters */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                {/* Appliance Dropdown */}\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">\n                    Select Appliance\n                  </label>\n                  <Select\n                    value={selectedAppliance}\n                    onValueChange={handleApplianceChange}\n                    disabled={appliancesLoading}\n                  >\n                    <SelectTrigger data-testid=\"select-appliance\">\n                      <SelectValue placeholder={appliancesLoading ? \"Loading...\" : \"Choose an appliance\"} />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {appliances?.map((appliance: any) => (\n                        <SelectItem \n                          key={appliance.id} \n                          value={appliance.id}\n                          data-testid={`appliance-${appliance.id}`}\n                        >\n                          {appliance.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* Problem Dropdown */}\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">\n                    Select Problem\n                  </label>\n                  <Select\n                    value={selectedProblem}\n                    onValueChange={setSelectedProblem}\n                    disabled={!selectedAppliance || problemsLoading}\n                  >\n                    <SelectTrigger data-testid=\"select-problem\">\n                      <SelectValue placeholder={\n                        problemsLoading ? \"Loading...\" :\n                        selectedAppliance \n                        ? \"Choose a problem\" \n                        : \"Select appliance first\"\n                      } />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {problems?.map((problem: any) => (\n                        <SelectItem \n                          key={problem.id} \n                          value={problem.id}\n                          data-testid={`problem-${problem.id}`}\n                        >\n                          {problem.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* Active Filters Display */}\n              {(selectedAppliance || selectedProblem) && (\n                <div className=\"flex items-center gap-2 pt-2\">\n                  <span className=\"text-sm text-muted-foreground\">\n                    Active filters:\n                  </span>\n                  {selectedAppliance && (\n                    <span className=\"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm\">\n                      {appliances?.find((a: any) => a.id === selectedAppliance)?.name}\n                    </span>\n                  )}\n                  {selectedProblem && (\n                    <span className=\"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm\">\n                      {problems?.find((p: any) => p.id === selectedProblem)?.name}\n                    </span>\n                  )}\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => {\n                      setSelectedAppliance(\"\");\n                      setSelectedProblem(\"\");\n                    }}\n                    data-testid=\"button-clear-filters\"\n                  >\n                    Clear filters\n                  </Button>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Electricians List */}\n        <div>\n          <h3 className=\"text-xl font-semibold mb-4\">\n            Available Technicians ({filteredProviders?.length || 0})\n          </h3>\n\n          {providersLoading ? (\n            <div className=\"text-center py-12\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground mx-auto\" />\n              <p className=\"text-muted-foreground mt-2\">Loading technicians...</p>\n            </div>\n          ) : filteredProviders?.length === 0 ? (\n            <Card>\n              <CardContent className=\"py-12 text-center\">\n                <p className=\"text-muted-foreground\">\n                  No technicians found. Try adjusting your filters.\n                </p>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {filteredProviders?.map((provider: any) => (\n                <ProviderCard\n                  key={provider.id}\n                  provider={provider}\n                  categorySlug=\"electrician\"\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":9799},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\nimport \"dotenv/config\";\n\nexport default defineConfig({\n  schema: \"./shared/schema.ts\",\n  out: \"./drizzle\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL!,\n  },\n  tablesFilter: [\"!session\"],\n});\n","size_bytes":270},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2755},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"server/storage.ts":{"content":"// server/storage.ts (UPDATED FOR ELECTRICIAN FLOW)\n\nimport {\n  users, serviceProviders, serviceCategories, serviceProblems,\n  beautyServices, cakeProducts, groceryProducts, rentalProperties,\n  bookings, groceryOrders, reviews, streetFoodItems, restaurantMenuItems, tableBookings,\n  invoices, // NAYA IMPORT\n  type User, type InsertUser, type ServiceProvider, type InsertServiceProvider,\n  type Booking, type InsertBooking, type GroceryOrder, type InsertGroceryOrder,\n  type RentalProperty, type InsertRentalProperty, type ServiceCategory,\n  type ServiceProblem, type BeautyService, type CakeProduct, type GroceryProduct,\n  type Review, type StreetFoodItem, type RestaurantMenuItem, type TableBooking, type InsertTableBooking,\n  type Invoice, type InsertInvoice // NAYE TYPES\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, sql, desc, asc, gt } from \"drizzle-orm\";\n// NAYE IMPORTS\nimport { sendBookingNotification, sendOtpNotification } from './twilio-client';\nimport { razorpayInstance } from './razorpay-client';\n\nexport interface IStorage {\n  // User operations\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateStripeCustomerId(userId: string, customerId: string): Promise<User>;\n  updateUserStripeInfo(userId: string, info: { customerId: string; subscriptionId: string }): Promise<User>;\n  // Service provider operations\n  getServiceProviders(categorySlug?: string, latitude?: number, longitude?: number, radius?: number): Promise<(ServiceProvider & { user: User; category: ServiceCategory })[]>;\n  getServiceProvider(id: string): Promise<(ServiceProvider & { user: User; category: ServiceCategory; galleryImages?: string[] }) | undefined>;\n  getProviderByUserId(userId: string): Promise<ServiceProvider | undefined>;\n  createServiceProvider(provider: InsertServiceProvider & { userId: string; categoryId: string }): Promise<ServiceProvider>;\n  updateServiceProvider(providerId: string, updates: Partial<InsertServiceProvider & { profileImageUrl?: string; galleryImages?: string[] }>): Promise<ServiceProvider | undefined>;\n  updateProviderRating(providerId: string, newRating: number, reviewCount: number): Promise<ServiceProvider>;\n  // Service categories\n  getServiceCategories(): Promise<ServiceCategory[]>;\n  getServiceCategory(slug: string): Promise<ServiceCategory | undefined>;\n  // Service problems\n  getServiceProblems(categoryId: string, parentId?: string): Promise<ServiceProblem[]>;\n  // Other services...\n  getBeautyServices(providerId: string): Promise<BeautyService[]>;\n  getCakeProducts(providerId: string): Promise<CakeProduct[]>;\n  getGroceryProducts(providerId?: string, search?: string): Promise<GroceryProduct[]>;\n  getGroceryProduct(id: string): Promise<GroceryProduct | undefined>;\n  getRentalProperties(filters: any): Promise<(RentalProperty & { owner: User })[]>;\n  getRentalProperty(id: string): Promise<(RentalProperty & { owner: User }) | undefined>;\n  createRentalProperty(property: InsertRentalProperty & { ownerId: string }): Promise<RentalProperty>;\n\n  // Bookings (UPDATED INTERFACE)\n  createBooking(booking: InsertBooking & { userId: string; providerId?: string }): Promise<Booking>;\n  getBooking(id: string): Promise<(Booking & { user: User; provider?: ServiceProvider; invoice?: Invoice }) | undefined>; // Updated\n  updateBookingStatus(id: string, status: string, providerId?: string): Promise<Booking & { provider?: ServiceProvider; user: User }>; // Updated\n  getUserBookings(userId: string): Promise<(Booking & { provider?: ServiceProvider; invoice?: Invoice })[]>; // Updated\n  getProviderBookings(providerId: string): Promise<(Booking & { user: User; invoice?: Invoice })[]>; // Updated\n\n  // --- NAYE BOOKING FUNCTIONS ---\n  generateOtpForBooking(bookingId: string, providerId: string): Promise<{ otp: string; userPhone: string }>;\n  verifyBookingOtp(bookingId: string, providerId: string, otp: string): Promise<Booking>;\n  createInvoiceForBooking(data: InsertInvoice): Promise<Invoice>;\n\n  // --- NAYE INVOICE/PAYMENT FUNCTIONS ---\n  getInvoice(id: string): Promise<Invoice | undefined>;\n  createPaymentOrderForInvoice(invoiceId: string, userId: string): Promise<{ razorpayOrderId: string; amount: number; currency: string; invoice: Invoice }>;\n  verifyInvoicePayment(invoiceId: string, rzpPaymentId: string, rzpOrderId: string, rzpSignature: string): Promise<Invoice>;\n\n\n  // Orders\n  createGroceryOrder(order: InsertGroceryOrder & { userId: string }): Promise<GroceryOrder>;\n  getGroceryOrder(id: string): Promise<GroceryOrder | undefined>;\n  updateOrderPaymentId(orderId: string, paymentIntentId: string): Promise<GroceryOrder>; \n  updateOrderWithRazorpayOrderId(orderId: string, razorpayOrderId: string): Promise<GroceryOrder | undefined>;\n  verifyAndUpdateOrderPayment(orderId: string, rzpPaymentId: string, rzpSignature: string): Promise<GroceryOrder | undefined>;\n\n  // Reviews\n  createReview(review: { userId: string; providerId: string; bookingId?: string; rating: number; comment?: string }): Promise<Review>;\n  getProviderReviews(providerId: string): Promise<(Review & { user: User })[]>;\n  // Menu items\n  getStreetFoodItems(providerId?: string, search?: string): Promise<StreetFoodItem[]>;\n  getRestaurantMenuItems(providerId?: string): Promise<RestaurantMenuItem[]>;\n  // Table bookings\n  createTableBooking(booking: InsertTableBooking & { userId: string; providerId: string }): Promise<TableBooking>;\n  getTableBooking(id: string): Promise<TableBooking | undefined>;\n  updateTableBookingStatus(id: string, status: string): Promise<TableBooking>;\n  getUserTableBookings(userId: string): Promise<TableBooking[]>;\n  // Menu Management\n  createMenuItem(itemData: any, providerId: string, categorySlug: string): Promise<any>;\n  updateMenuItem(itemId: string, providerId: string, categorySlug: string, updates: any): Promise<any | null>;\n  deleteMenuItem(itemId: string, providerId: string, categorySlug: string): Promise<{ id: string } | null>;\n  getProviderMenuItems(providerId: string, categorySlug: string): Promise<any[]>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // --- User Operations (No Change) ---\n  async getUser(id: string): Promise<User | undefined> {\n    return db.query.users.findFirst({ where: eq(users.id, id) });\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return db.query.users.findFirst({ where: eq(users.username, username) });\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    return db.query.users.findFirst({ where: eq(users.email, email) });\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  async updateStripeCustomerId(userId: string, customerId: string): Promise<User> {\n    const [user] = await db.update(users).set({ stripeCustomerId: customerId }).where(eq(users.id, userId)).returning();\n    return user;\n  }\n\n  async updateUserStripeInfo(userId: string, info: { customerId: string; subscriptionId: string; }): Promise<User> {\n    const [user] = await db.update(users).set({ stripeCustomerId: info.customerId, stripeSubscriptionId: info.subscriptionId }).where(eq(users.id, userId)).returning();\n    return user;\n  }\n\n  // --- Service Provider Operations (No Change) ---\n  async getServiceProviders(categorySlug?: string, latitude?: number, longitude?: number, radius?: number) {\n    const conditions = [];\n    if (categorySlug) {\n      const category = await this.getServiceCategory(categorySlug);\n      if (category) {\n        conditions.push(eq(serviceProviders.categoryId, category.id));\n      } else {\n        return [];\n      }\n    }\n\n    const results = await db.query.serviceProviders.findMany({\n      where: and(...conditions),\n      with: { user: true, category: true },\n      orderBy: [desc(serviceProviders.rating)],\n    });\n\n    return results as any;\n  }\n\n  async getServiceProvider(id: string) {\n    const result = await db.query.serviceProviders.findFirst({\n      where: eq(serviceProviders.id, id),\n      with: {\n        user: true,\n        category: true,\n      },\n    });\n    return result as any;\n  }\n\n  async getProviderByUserId(userId: string): Promise<ServiceProvider | undefined> {\n    return db.query.serviceProviders.findFirst({ where: eq(serviceProviders.userId, userId) });\n  }\n\n  async createServiceProvider(provider: InsertServiceProvider & { userId: string; categoryId: string }): Promise<ServiceProvider> {\n    const providerToInsert = {\n      businessName: provider.businessName,\n      description: provider.description,\n      experience: provider.experience,\n      address: provider.address,\n      latitude: provider.latitude,\n      longitude: provider.longitude,\n      specializations: provider.specializations,\n      userId: provider.userId,\n      categoryId: provider.categoryId,\n    };\n    const [newProvider] = await db.insert(serviceProviders).values(providerToInsert).returning();\n    return newProvider;\n  }\n\n  async updateServiceProvider(providerId: string, updates: Partial<InsertServiceProvider & { profileImageUrl?: string; galleryImages?: string[] }>): Promise<ServiceProvider | undefined> {\n    const [updatedProvider] = await db.update(serviceProviders)\n      .set(updates)\n      .where(eq(serviceProviders.id, providerId))\n      .returning();\n    return updatedProvider;\n  }\n\n  async updateProviderRating(providerId: string, newRating: number, reviewCount: number): Promise<ServiceProvider> {\n    const [provider] = await db.update(serviceProviders)\n      .set({ rating: newRating.toFixed(2), reviewCount })\n      .where(eq(serviceProviders.id, providerId))\n      .returning();\n    return provider;\n  }\n\n  // --- Other Functions ---\n\n  async getServiceCategories(): Promise<ServiceCategory[]> {\n    return db.query.serviceCategories.findMany();\n  }\n\n  async getServiceCategory(slug: string): Promise<ServiceCategory | undefined> {\n    return db.query.serviceCategories.findFirst({ where: eq(serviceCategories.slug, slug) });\n  }\n\n  async getServiceProblems(categoryId: string, parentId?: string): Promise<ServiceProblem[]> {\n    const conditions = [eq(serviceProblems.categoryId, categoryId)];\n    parentId ? conditions.push(eq(serviceProblems.parentId, parentId)) : conditions.push(sql`${serviceProblems.parentId} IS NULL`);\n    return db.select().from(serviceProblems).where(and(...conditions));\n  }\n\n  // --- BOOKING FUNCTIONS (UPDATED) ---\n\n  async createBooking(booking: InsertBooking & { userId: string; providerId?: string; }): Promise<Booking> {\n    const bookingToInsert = {\n      serviceType: booking.serviceType,\n      problemId: booking.problemId,\n      scheduledAt: booking.scheduledAt,\n      preferredTimeSlots: booking.preferredTimeSlots,\n      userAddress: booking.userAddress,\n      userPhone: booking.userPhone,\n      notes: booking.notes,\n      userId: booking.userId,\n      providerId: booking.providerId,\n      isUrgent: booking.isUrgent, // NAYA FIELD\n    };\n    const [newBooking] = await db.insert(bookings).values(bookingToInsert).returning();\n\n    // Yahaan pe aap 20 minute waala auto-decline logic laga sakte ho\n    // Abhi ke liye, hum usko skip kar rahe hain aur manual flow pe focus kar rahe hain\n    if (booking.isUrgent) {\n      // TODO: 20 minute auto-decline timer set karo\n      console.log(`[Urgent Booking] ${newBooking.id} create hui. Timer start karna hai.`);\n    }\n\n    return newBooking;\n  }\n\n  async getBooking(id: string) {\n    return db.query.bookings.findFirst({\n      where: eq(bookings.id, id),\n      with: {\n        user: true,\n        provider: { with: { user: true, category: true } },\n        invoice: true, // NAYA: Invoice bhi fetch karo\n      },\n    }) as any;\n  }\n\n  async updateBookingStatus(id: string, status: string, providerId?: string): Promise<Booking & { provider?: ServiceProvider; user: User }> {\n      const updateData: any = { status };\n      if (providerId) { \n        updateData.providerId = providerId; \n      }\n\n      await db.update(bookings).set(updateData).where(eq(bookings.id, id));\n\n      const updatedBooking = await this.getBooking(id) as any;\n\n      if (!updatedBooking) {\n        console.warn(`[SMS Fail] Update ke baad booking ${id} nahi mili.`);\n        return updatedBooking;\n      }\n\n      // Sirf 'accepted' ya 'declined' par hi notification bhejo\n      if (status === 'accepted' || status === 'declined') {\n        try {\n          const userPhone = updatedBooking.user?.phone;\n          const providerName = updatedBooking.provider?.businessName;\n          const scheduledAt = updatedBooking.scheduledAt;\n\n          if (userPhone && providerName) {\n            console.log(`[SMS] Sending SMS to ${userPhone} for status: ${status}`);\n            await sendBookingNotification(\n              userPhone,\n              status as 'accepted' | 'declined',\n              providerName,\n              scheduledAt ? new Date(scheduledAt).toLocaleString('en-IN') : undefined\n            );\n          } else {\n            console.warn(`[SMS Fail] SMS nahi bhej paaye: User phone ya provider name missing.`);\n          }\n        } catch (smsError) {\n          console.error(\"[SMS Error] SMS notification bhejte waqt error aaya:\", smsError);\n        }\n      }\n      return updatedBooking;\n  }\n\n  async getUserBookings(userId: string) {\n      return db.query.bookings.findMany({ \n        where: eq(bookings.userId, userId), \n        with: { \n          provider: { with: { user: true, category: true } },\n          invoice: true, // NAYA\n        }, \n        orderBy: [desc(bookings.createdAt)] \n      }) as any;\n  }\n\n  async getProviderBookings(providerId: string) {\n      return db.query.bookings.findMany({ \n        where: eq(bookings.providerId, providerId),\n        with: { \n          user: true,\n          invoice: true, // NAYA\n        }, \n        orderBy: [desc(bookings.createdAt)] \n      }) as any;\n  }\n\n  // --- NAYE FUNCTIONS ELECTRICIAN FLOW KE LIYE ---\n\n  /**\n   * Job complete hone par OTP generate karta hai aur customer ko bhejta hai\n   */\n  async generateOtpForBooking(bookingId: string, providerId: string): Promise<{ otp: string; userPhone: string }> {\n    const booking = await this.getBooking(bookingId);\n    if (!booking || booking.providerId !== providerId) {\n      throw new Error(\"Booking not found or access denied\");\n    }\n    if (booking.status !== 'in_progress') {\n      throw new Error(`Cannot generate OTP for booking with status: ${booking.status}`);\n    }\n    if (!booking.user.phone) {\n      throw new Error(\"Customer phone number is not available to send OTP\");\n    }\n\n    const otp = Math.floor(100000 + Math.random() * 900000).toString(); // 6 digit OTP\n    const otpExpiresAt = new Date(Date.now() + 10 * 60 * 1000); // 10 minute expiry\n\n    await db.update(bookings)\n      .set({\n        serviceOtp: otp,\n        serviceOtpExpiresAt: otpExpiresAt,\n        status: 'awaiting_otp'\n      })\n      .where(eq(bookings.id, bookingId));\n\n    // Customer ko OTP Bhejo\n    await sendOtpNotification(booking.user.phone, otp);\n\n    return { otp, userPhone: booking.user.phone };\n  }\n\n  /**\n   * Provider dwara enter kiye gaye OTP ko verify karta hai\n   */\n  async verifyBookingOtp(bookingId: string, providerId: string, otp: string): Promise<Booking> {\n    const booking = await db.query.bookings.findFirst({\n      where: and(\n        eq(bookings.id, bookingId),\n        eq(bookings.providerId, providerId)\n      )\n    });\n\n    if (!booking) {\n      throw new Error(\"Booking not found or access denied\");\n    }\n    if (booking.status !== 'awaiting_otp') {\n      throw new Error(\"Booking is not awaiting OTP verification\");\n    }\n    if (booking.serviceOtp !== otp) {\n      throw new Error(\"Invalid OTP\");\n    }\n    if (!booking.serviceOtpExpiresAt || new Date() > new Date(booking.serviceOtpExpiresAt)) {\n      throw new Error(\"OTP has expired\");\n    }\n\n    // OTP Sahi hai! Ab billing ke liye status update karo\n    const [updatedBooking] = await db.update(bookings)\n      .set({\n        status: 'awaiting_billing',\n        serviceOtp: null, // OTP use ho gaya, clear kar do\n        serviceOtpExpiresAt: null\n      })\n      .where(eq(bookings.id, bookingId))\n      .returning();\n\n    return updatedBooking;\n  }\n\n  /**\n   * OTP verify hone ke baad final bill banata hai\n   */\n  async createInvoiceForBooking(data: InsertInvoice): Promise<Invoice> {\n    // 1. Invoice create karo\n    const [newInvoice] = await db.insert(invoices).values(data).returning();\n\n    // 2. Booking ko update karo\n    await db.update(bookings)\n      .set({\n        status: 'pending_payment',\n        invoiceId: newInvoice.id\n      })\n      .where(eq(bookings.id, data.bookingId));\n\n    return newInvoice;\n  }\n\n  async getInvoice(id: string): Promise<Invoice | undefined> {\n    return db.query.invoices.findFirst({ where: eq(invoices.id, id) });\n  }\n\n  /**\n   * Customer ke liye Bill/Invoice ka Razorpay payment order banata hai\n   */\n  async createPaymentOrderForInvoice(invoiceId: string, userId: string): Promise<{ razorpayOrderId: string; amount: number; currency: string; invoice: Invoice }> {\n    const invoice = await this.getInvoice(invoiceId);\n\n    if (!invoice || invoice.userId !== userId) {\n      throw new Error(\"Invoice not found or access denied\");\n    }\n    if (invoice.paymentStatus === 'completed') {\n      throw new Error(\"This invoice has already been paid\");\n    }\n\n    const amountInPaise = Math.round(parseFloat(invoice.totalAmount) * 100);\n\n    const options = {\n      amount: amountInPaise,\n      currency: \"INR\",\n      receipt: invoice.id,\n      notes: {\n        databaseInvoiceId: invoice.id,\n        bookingId: invoice.bookingId,\n        userId: userId,\n      }\n    };\n\n    const razorpayOrder = await razorpayInstance.orders.create(options);\n\n    // Razorpay Order ID ko invoice table me save karo\n    const [updatedInvoice] = await db.update(invoices)\n      .set({ razorpayOrderId: razorpayOrder.id })\n      .where(eq(invoices.id, invoiceId))\n      .returning();\n\n    return {\n      razorpayOrderId: razorpayOrder.id,\n      amount: razorpayOrder.amount,\n      currency: razorpayOrder.currency,\n      invoice: updatedInvoice\n    };\n  }\n\n  /**\n   * Invoice payment ko verify aur complete karta hai\n   */\n  async verifyInvoicePayment(invoiceId: string, rzpPaymentId: string, rzpOrderId: string, rzpSignature: string): Promise<Invoice> {\n    const invoice = await this.getInvoice(invoiceId);\n    if (!invoice) {\n      throw new Error(\"Invoice not found\");\n    }\n    // (Yahaan `verifyPaymentSignature` helper function use hona chahiye, jo routes.ts me hai)\n    // Hum maan rahe hain ki yeh route me verify ho chuka hai.\n\n    // 1. Invoice update karo\n    const [updatedInvoice] = await db.update(invoices)\n      .set({\n        paymentStatus: 'completed',\n        razorpayPaymentId: rzpPaymentId,\n      })\n      .where(and(\n        eq(invoices.id, invoiceId),\n        eq(invoices.razorpayOrderId, rzpOrderId)\n      ))\n      .returning();\n\n    if (!updatedInvoice) {\n      throw new Error(\"Invoice not found or Razorpay Order ID mismatch\");\n    }\n\n    // 2. Booking ko 'completed' mark karo\n    await db.update(bookings)\n      .set({ status: 'completed' })\n      .where(eq(bookings.id, updatedInvoice.bookingId));\n\n    return updatedInvoice;\n  }\n\n\n  // --- BAAKI FUNCTIONS (Grocery, Rental, etc. No Change) ---\n\n  async createGroceryOrder(order: InsertGroceryOrder & { userId: string; }): Promise<GroceryOrder> {\n    const orderToInsert = {\n      items: order.items,\n      subtotal: order.subtotal,\n      platformFee: order.platformFee,\n      deliveryFee: order.deliveryFee,\n      total: order.total,\n      deliveryAddress: order.deliveryAddress,\n      userId: order.userId,\n    };\n    const [newOrder] = await db.insert(groceryOrders).values(orderToInsert).returning();\n    return newOrder;\n  }\n\n  async updateOrderPaymentId(orderId: string, paymentIntentId: string): Promise<GroceryOrder> {\n    const [order] = await db.update(groceryOrders)\n      .set({ razorpayOrderId: paymentIntentId }) \n      .where(eq(groceryOrders.id, orderId))\n      .returning();\n    return order;\n  }\n\n  async updateOrderWithRazorpayOrderId(orderId: string, razorpayOrderId: string): Promise<GroceryOrder | undefined> {\n    const [order] = await db.update(groceryOrders)\n      .set({ razorpayOrderId: razorpayOrderId })\n      .where(eq(groceryOrders.id, orderId))\n      .returning();\n    return order;\n  }\n\n  async verifyAndUpdateOrderPayment(orderId: string, rzpPaymentId: string, rzpSignature: string): Promise<GroceryOrder | undefined> {\n    const [order] = await db.update(groceryOrders)\n      .set({\n        razorpayPaymentId: rzpPaymentId,\n        razorpaySignature: rzpSignature,\n        status: 'confirmed'\n      })\n      .where(eq(groceryOrders.id, orderId))\n      .returning();\n    return order;\n  }\n\n  async createRentalProperty(property: InsertRentalProperty & { ownerId: string; }): Promise<RentalProperty> {\n    const propertyToInsert = {\n        title: property.title,\n        description: property.description,\n        propertyType: property.propertyType,\n        rent: property.rent,\n        area: property.area,\n        bedrooms: property.bedrooms,\n        bathrooms: property.bathrooms,\n        furnishing: property.furnishing,\n        address: property.address,\n        locality: property.locality,\n        latitude: property.latitude,\n        longitude: property.longitude,\n        amenities: property.amenities,\n        images: property.images,\n        ownerId: property.ownerId,\n    };\n    const [newProperty] = await db.insert(rentalProperties).values(propertyToInsert).returning();\n    return newProperty;\n  }\n\n  async getBeautyServices(providerId: string): Promise<BeautyService[]> { return db.query.beautyServices.findMany({ where: eq(beautyServices.providerId, providerId) }); }\n  async getCakeProducts(providerId: string): Promise<CakeProduct[]> { return db.query.cakeProducts.findMany({ where: eq(cakeProducts.providerId, providerId) }); }\n\n  async getGroceryProducts(providerId?: string, search?: string): Promise<GroceryProduct[]> { \n    const conditions = [eq(groceryProducts.inStock, true)]; \n    if (providerId) {\n      conditions.push(eq(groceryProducts.providerId, providerId));\n    }\n    if (search) {\n      conditions.push(sql`${groceryProducts.name} ILIKE ${`%${search}%`}`);\n    }\n    if (!providerId) {\n        return []; \n    }\n    return db.select().from(groceryProducts).where(and(...conditions)).orderBy(asc(groceryProducts.name)); \n  }\n\n  async getGroceryProduct(id: string): Promise<GroceryProduct | undefined> { const [product] = await db.select().from(groceryProducts).where(sql`${groceryProducts.id} = ${parseInt(id)}`); return product; }\n  async getGroceryOrder(id: string): Promise<GroceryOrder | undefined> { return db.query.groceryOrders.findFirst({where: eq(groceryOrders.id, id)}); }\n  async getStreetFoodItems(providerId?: string, search?: string): Promise<StreetFoodItem[]> { const conditions = [eq(streetFoodItems.isAvailable, true)]; if(providerId){conditions.push(eq(streetFoodItems.providerId, providerId))}; if(search){conditions.push(sql`${streetFoodItems.name} ILIKE ${`%${search}%`}`)}; return db.select().from(streetFoodItems).where(and(...conditions)); }\n  async getRestaurantMenuItems(providerId?: string): Promise<RestaurantMenuItem[]> { if(providerId){return db.query.restaurantMenuItems.findMany({where: eq(restaurantMenuItems.providerId, providerId)})}; return db.query.restaurantMenuItems.findMany({where: eq(restaurantMenuItems.isAvailable, true)}); }\n  async createTableBooking(booking: InsertTableBooking & { userId: string; providerId: string; }): Promise<TableBooking> { const [newBooking] = await db.insert(tableBookings).values(booking).returning(); return newBooking; }\n  async getTableBooking(id: string): Promise<TableBooking | undefined> { return db.query.tableBookings.findFirst({where: eq(tableBookings.id, id)}); }\n  async updateTableBookingStatus(id: string, status: string): Promise<TableBooking> { const [booking] = await db.update(tableBookings).set({ status }).where(eq(tableBookings.id, id)).returning(); return booking; }\n  async getUserTableBookings(userId: string): Promise<TableBooking[]> { return db.query.tableBookings.findMany({ where: eq(tableBookings.userId, userId), orderBy: [desc(tableBookings.createdAt)]}); }\n\n  async getRentalProperties(filters: { propertyType?: string; minRent?: number; maxRent?: number; furnishing?: string; locality?: string; }) {\n      return db.query.rentalProperties.findMany({ with: { owner: true, }, orderBy: [desc(rentalProperties.createdAt)], }) as any;\n  }\n  async getRentalProperty(id: string) {\n      return db.query.rentalProperties.findFirst({ where: eq(rentalProperties.id, id), with: { owner: true } }) as any;\n  }\n\n  async createReview(review: { userId: string; providerId: string; bookingId?: string; rating: number; comment?: string; }): Promise<Review> {\n    const [newReview] = await db.insert(reviews).values(review).returning();\n    const providerReviews = await db.select().from(reviews).where(eq(reviews.providerId, review.providerId));\n    const avgRating = providerReviews.reduce((sum, r) => sum + r.rating, 0) / providerReviews.length;\n    await this.updateProviderRating(review.providerId, avgRating, providerReviews.length);\n    return newReview;\n  }\n  async getProviderReviews(providerId: string) {\n      return db.query.reviews.findMany({ where: eq(reviews.providerId, providerId), with: { user: true }, orderBy: [desc(reviews.createdAt)] }) as any;\n  }\n\n  private getMenuTableInfo(categorySlug: string) { \n    switch (categorySlug) { \n      case 'beauty': \n        return { table: beautyServices, idField: beautyServices.id, providerIdField: beautyServices.providerId }; \n      case 'cake-shop': \n        return { table: cakeProducts, idField: cakeProducts.id, providerIdField: cakeProducts.providerId }; \n      case 'street-food': \n        return { table: streetFoodItems, idField: streetFoodItems.id, providerIdField: streetFoodItems.providerId }; \n      case 'restaurants': \n        return { table: restaurantMenuItems, idField: restaurantMenuItems.id, providerIdField: restaurantMenuItems.providerId };\n      case 'grocery':\n        return { table: groceryProducts, idField: groceryProducts.id, providerIdField: groceryProducts.providerId };\n      default: \n        throw new Error(`Unknown menu category: ${categorySlug}`); \n    } \n  }\n  async createMenuItem(itemData: any, providerId: string, categorySlug: string): Promise<any> { const { table } = this.getMenuTableInfo(categorySlug); const [newItem] = await db.insert(table).values({ ...itemData, providerId }).returning(); return newItem; }\n  async updateMenuItem(itemId: string, providerId: string, categorySlug: string, updates: any): Promise<any | null> { const { table, idField, providerIdField } = this.getMenuTableInfo(categorySlug); const [itemToUpdate] = await db.select().from(table).where(and(eq(idField, itemId), eq(providerIdField, providerId))); if (!itemToUpdate) return null; const [updatedItem] = await db.update(table).set(updates).where(eq(idField, itemId)).returning(); return updatedItem; }\n  async deleteMenuItem(itemId: string, providerId: string, categorySlug: string): Promise<{ id: string; } | null> { const { table, idField, providerIdField } = this.getMenuTableInfo(categorySlug); const [itemToUpdate] = await db.select().from(table).where(and(eq(idField, itemId), eq(providerIdField, providerId))); if (!itemToUpdate) return null; const [deletedItem] = await db.delete(table).where(eq(idField, itemId)).returning({ id: idField }); return deletedItem; }\n  async getProviderMenuItems(providerId: string, categorySlug: string): Promise<any[]> { const { table, providerIdField } = this.getMenuTableInfo(categorySlug); return db.select().from(table).where(eq(providerIdField, providerId)); }\n}\n\nexport const storage = new DatabaseStorage();","size_bytes":27998},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"server/routes.ts":{"content":"// server/routes.ts (UPDATED FOR ELECTRICIAN FLOW)\n\nimport type { Express, Request, Response, NextFunction } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport bcrypt from \"bcrypt\";\nimport { uploadToCloudinary } from './cloudinary';\nimport multer from 'multer';\n\nconst upload = multer({ storage: multer.memoryStorage() });\n\nimport { storage } from \"./storage\";\nimport {\n  insertBookingSchema,\n  insertGroceryOrderSchema,\n  insertRentalPropertySchema,\n  insertTableBookingSchema,\n  insertServiceProviderSchema,\n  insertInvoiceSchema, // NAYA IMPORT\n} from \"@shared/schema\";\n\nimport { razorpayInstance, verifyPaymentSignature } from \"./razorpay-client\";\n\n// NAYA IMPORT: z for validation\nimport { z } from \"zod\";\n\nlet twilioClient: any = null;\nif (process.env.TWILIO_ACCOUNT_SID && process.env.TWILIO_AUTH_TOKEN) {\n  const twilio = require('twilio');\n  twilioClient = twilio(process.env.TWILIO_ACCOUNT_SID, process.env.TWILIO_AUTH_TOKEN);\n}\n\n// Custom request types\ninterface CustomRequest extends Request {\n  provider?: {\n    id: string;\n    userId: string;\n    categoryId: string;\n  };\n}\ninterface AuthRequest extends Request {\n  userId?: string;\n}\n\n// Middleware: Check if user is logged in\nconst isLoggedIn = (req: AuthRequest, res: Response, next: NextFunction) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Aap logged in nahi hain.\" });\n  }\n  req.userId = req.session.userId;\n  next();\n};\n\n// Middleware: Check if user is a provider\nconst isProvider = async (req: CustomRequest, res: Response, next: NextFunction) => {\n  if (!req.session.userId) {\n    return res.status(401).json({ message: \"Aap logged in nahi hain.\" });\n  }\n  const provider = await storage.getProviderByUserId(req.session.userId);\n  if (!provider) {\n    return res.status(403).json({ message: \"Aap ek service provider nahi hain.\" });\n  }\n  req.provider = provider;\n  req.userId = req.session.userId;\n  next();\n};\n\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n\n  // --- AUTHENTICATION ROUTES (No Change) ---\n  app.post(\"/api/auth/signup\", async (req: Request, res: Response) => {\n    try {\n      const { username, email, password, role, phone } = req.body;\n      if (!username || !email || !password || !role) {\n        return res.status(400).json({ message: \"Username, email, password, and role are required.\" });\n      }\n      const existingUser = await storage.getUserByUsername(username.toLowerCase());\n      if (existingUser) {\n        return res.status(400).json({ message: \"Username already exists\" });\n      }\n      const existingEmail = await storage.getUserByEmail(email);\n      if (existingEmail) {\n        return res.status(400).json({ message: \"Email already exists\" });\n      }\n      const hashedPassword = await bcrypt.hash(password, 10);\n      const user = await storage.createUser({\n        username: username.toLowerCase(),\n        email,\n        password: hashedPassword,\n        role: role || \"customer\",\n        phone,\n      });\n      req.session.userId = user.id;\n      req.session.userRole = user.role || 'customer';\n      req.session.save((err) => {\n        if (err) {\n          console.error(\"Session save error after signup:\", err);\n          return res.status(500).json({ message: \"Signup successful, but session could not be established.\" });\n        }\n        const { password: _, ...userWithoutPassword } = user;\n        res.status(201).json({ user: userWithoutPassword, message: \"Signed up and logged in successfully!\" });\n      });\n    } catch (error: any) {\n      console.error(\"Signup error:\", error);\n      res.status(500).json({ message: error.message || \"Error during signup\" });\n    }\n  });\n\n  app.post(\"/api/auth/login\", async (req: Request, res: Response) => {\n    try {\n      const { username, password } = req.body;\n      if (!username || !password) {\n        return res.status(400).json({ message: \"Username and password are required.\" });\n      }\n      const user = await storage.getUserByUsername(username.toLowerCase());\n      if (!user) {\n        await bcrypt.compare(\"dummyPassword\", \"$2b$10$abcdefghijklmnopqrstuv\");\n        return res.status(401).json({ message: \"Invalid username or password\" });\n      }\n      const validPassword = await bcrypt.compare(password, user.password);\n      if (!validPassword) {\n        return res.status(401).json({ message: \"Invalid username or password\" });\n      }\n      req.session.userId = user.id;\n      req.session.userRole = user.role || 'customer';\n      req.session.save((err) => {\n        if (err) {\n          console.error(\"Session save error after login:\", err);\n          return res.status(500).json({ message: \"Login successful, but session could not be established.\" });\n        }\n        const { password: _, ...userWithoutPassword } = user;\n        res.json({ user: userWithoutPassword, message: \"Logged in successfully!\" });\n      });\n    } catch (error: any) {\n      console.error(\"Login error:\", error);\n      res.status(500).json({ message: error.message || \"Error during login\" });\n    }\n  });\n\n  app.post(\"/api/auth/logout\", (req: Request, res: Response) => {\n    req.session.destroy((err) => {\n      if (err) {\n        console.error(\"Session destroy error:\", err);\n        return res.status(500).json({ message: \"Logout failed\" });\n      }\n      res.clearCookie(\"connect.sid\");\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  app.get(\"/api/auth/me\", async (req: Request, res: Response) => {\n    try {\n      const userId = req.session.userId;\n      if (!userId) {\n        return res.status(401).json({ user: null, message: \"Not authenticated\" });\n      }\n      const user = await storage.getUser(userId);\n      if (!user) {\n        req.session.destroy(() => {\n          res.clearCookie(\"connect.sid\");\n          return res.status(404).json({ user: null, message: \"Authenticated user not found, session cleared.\" });\n        });\n        return;\n      }\n      const { password: _, ...userWithoutPassword } = user;\n      res.json({ user: userWithoutPassword });\n    } catch (error: any) {\n      console.error(\"GET /api/auth/me error:\", error);\n      res.status(500).json({ user: null, message: error.message || \"Error fetching user data\" });\n    }\n  });\n\n  // --- PROVIDER PROFILE ROUTES (No Change) ---\n  app.post(\"/api/provider/profile\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const providerData = insertServiceProviderSchema.parse(req.body);\n      const { categoryId } = req.body;\n      const provider = await storage.createServiceProvider({ ...providerData, userId, categoryId });\n      res.status(201).json(provider);\n    } catch (error: any) {\n      console.error(\"Create provider profile error:\", error);\n      res.status(400).json({ message: error.message || \"Error creating provider profile\" });\n    }\n  });\n\n  app.get(\"/api/provider/profile\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const provider = await storage.getProviderByUserId(userId);\n      if (!provider) {\n        return res.status(404).json({ message: \"Provider profile not found\" });\n      }\n      const fullProfile = await storage.getServiceProvider(provider.id);\n      if (!fullProfile) {\n        return res.status(404).json({ message: \"Could not retrieve full provider profile.\" });\n      }\n      res.json(fullProfile);\n    } catch (error: any) {\n      console.error(\"Get provider profile error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching provider profile\" });\n    }\n  });\n\n  app.patch(\"/api/provider/profile\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const { profileImageUrl, galleryImages, ...updates } = req.body;\n\n      const updatedProfile = await storage.updateServiceProvider(providerId, updates);\n      if (!updatedProfile) {\n        return res.status(404).json({ message: \"Profile not found.\" });\n      }\n      res.json(updatedProfile);\n    } catch (error: any) {\n      console.error(\"Update provider profile error:\", error);\n      res.status(500).json({ message: error.message || \"Error updating provider profile\" });\n    }\n  });\n\n  app.patch(\n    \"/api/provider/profile/image\",\n    isProvider,\n    upload.single(\"image\"),\n    async (req: CustomRequest, res: Response) => {\n      try {\n        const providerId = req.provider!.id;\n        const file = req.file;\n\n        if (!file) {\n          return res.status(400).json({ message: \"Koi image file nahi mili.\" });\n        }\n        const imageUrl = await uploadToCloudinary(file.buffer);\n        const updatedProfile = await storage.updateServiceProvider(providerId, {\n          profileImageUrl: imageUrl,\n        });\n\n        res.json({ message: \"Profile image updated!\", profile: updatedProfile });\n      } catch (error: any) {\n        console.error(\"Profile image upload error:\", error);\n        res.status(500).json({ message: error.message || \"Error uploading image\" });\n      }\n    }\n  );\n\n  app.post(\n    \"/api/provider/profile/gallery\",\n    isProvider,\n    upload.array(\"images\", 5),\n    async (req: CustomRequest, res: Response) => {\n      try {\n        const providerId = req.provider!.id;\n        const files = req.files as Express.Multer.File[];\n\n        if (!files || files.length === 0) {\n          return res.status(400).json({ message: \"Koi image files nahi mili.\" });\n        }\n\n        const uploadPromises = files.map(file => uploadToCloudinary(file.buffer));\n        const imageUrls = await Promise.all(uploadPromises);\n\n        const currentProfile = await storage.getServiceProvider(providerId);\n        const existingGallery = currentProfile?.galleryImages || [];\n        const updatedGallery = [...existingGallery, ...imageUrls];\n\n        const updatedProfile = await storage.updateServiceProvider(providerId, {\n          galleryImages: updatedGallery,\n        });\n\n        res.json({ message: \"Gallery images updated!\", profile: updatedProfile });\n      } catch (error: any) {\n        console.error(\"Gallery image upload error:\", error);\n        res.status(500).json({ message: error.message || \"Error uploading gallery images\" });\n      }\n    }\n  );\n  \n  app.get(\"/api/provider/my-bookings\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const bookings = await storage.getProviderBookings(providerId);\n      res.json(bookings);\n    } catch (error: any) {\n      console.error(\"Get provider bookings error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching provider bookings\" });\n    }\n  });\n\n  // --- GENERAL SERVICE ROUTES (No Change) ---\n  app.get(\"/api/service-categories\", async (_req: Request, res: Response) => {\n    try {\n      const categories = await storage.getServiceCategories();\n      res.json(categories);\n    } catch (error: any) {\n      console.error(\"Get service categories error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching service categories\" });\n    }\n  });\n\n  app.get(\"/api/service-problems\", async (req: Request, res: Response) => {\n    try {\n      const { category: categorySlug, parentId } = req.query; \n\n      if (!categorySlug) {\n        return res.status(400).json({ message: \"Category slug is required\" });\n      }\n\n      const category = await storage.getServiceCategory(categorySlug as string);\n      if (!category) {\n        return res.status(404).json({ message: \"Category not found\" });\n      }\n\n      const problems = await storage.getServiceProblems(category.id, parentId as string | undefined); \n      res.json(problems);\n    } catch (error: any) {\n      console.error(\"Get service problems error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching service problems\" });\n    }\n  });\n\n  app.get(\"/api/service-providers\", async (req: Request, res: Response) => {\n    try {\n      const { category, lat, lng, radius } = req.query;\n      const latitude = lat ? parseFloat(lat as string) : undefined;\n      const longitude = lng ? parseFloat(lng as string) : undefined;\n      const searchRadius = radius ? parseInt(radius as string) : 10;\n      const providers = await storage.getServiceProviders(category as string, latitude, longitude, searchRadius);\n      res.json(providers);\n    } catch (error: any) {\n      console.error(\"Get service providers error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching service providers\" });\n    }\n  });\n\n  app.get(\"/api/service-providers/:id\", async (req: Request, res: Response) => {\n    try {\n      const provider = await storage.getServiceProvider(req.params.id);\n      if (!provider) {\n        return res.status(404).json({ message: \"Provider not found\" });\n      }\n      res.json(provider);\n    } catch (error: any) {\n      console.error(\"Get service provider by ID error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching service provider\" });\n    }\n  });\n\n\n  // --- BOOKING & ORDER ROUTES (UPDATED) ---\n\n  // (Customer) Booking create karna\n  app.post(\"/api/bookings\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const bookingData = insertBookingSchema.parse(req.body);\n      const booking = await storage.createBooking({ ...bookingData, userId });\n      res.status(201).json(booking);\n    } catch (error: any) {\n      console.error(\"Create booking error:\", error);\n      res.status(400).json({ message: error.message || \"Error creating booking\" });\n    }\n  });\n\n  // (Customer) Apni booking cancel karna\n  app.patch(\"/api/bookings/:id/cancel\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const { id: bookingId } = req.params;\n\n      const booking = await storage.getBooking(bookingId);\n\n      if (!booking) {\n        return res.status(404).json({ message: \"Booking nahi mili.\" });\n      }\n      if (booking.userId !== userId) {\n        return res.status(403).json({ message: \"Aap yeh booking cancel nahi kar sakte.\" });\n      }\n      if (booking.status !== 'pending') {\n        return res.status(400).json({ message: `Aap '${booking.status}' booking ko cancel nahi kar sakte.` });\n      }\n\n      const cancelledBooking = await storage.updateBookingStatus(bookingId, \"cancelled\");\n      res.json(cancelledBooking);\n\n    } catch (error: any) {\n      console.error(\"Cancel booking error:\", error);\n      res.status(500).json({ message: error.message || \"Error cancelling booking\" });\n    }\n  });\n\n  // (Provider) Booking accept karna\n  app.patch(\"/api/bookings/:id/accept\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const { id: bookingId } = req.params;\n\n      const booking = await storage.getBooking(bookingId);\n      if (!booking || booking.providerId !== providerId) {\n         return res.status(404).json({ message: \"Booking nahi mili ya aapke liye nahi hai.\" });\n      }\n       if (booking.status !== 'pending') {\n        return res.status(400).json({ message: `Yeh booking already '${booking.status}' hai.` });\n      }\n\n      const acceptedBooking = await storage.updateBookingStatus(bookingId, \"accepted\", providerId);\n      res.json(acceptedBooking);\n    } catch (error: any) {\n      console.error(\"Accept booking error:\", error);\n      res.status(500).json({ message: error.message || \"Error accepting booking\" });\n    }\n  });\n\n  // (Provider) Booking decline karna\n  app.patch(\"/api/bookings/:id/decline\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const { id: bookingId } = req.params;\n\n      const booking = await storage.getBooking(bookingId);\n      if (!booking || booking.providerId !== providerId) {\n         return res.status(404).json({ message: \"Booking nahi mili ya aapke liye nahi hai.\" });\n      }\n      if (booking.status !== 'pending') {\n        return res.status(400).json({ message: `Yeh booking already '${booking.status}' hai.` });\n      }\n\n      const declinedBooking = await storage.updateBookingStatus(bookingId, \"declined\");\n      res.json(declinedBooking);\n    } catch (error: any) {\n      console.error(\"Decline booking error:\", error);\n      res.status(500).json({ message: error.message || \"Error declining booking\" });\n    }\n  });\n\n\n  // --- NAYE ELECTRICIAN FLOW KE API ENDPOINTS ---\n\n  // (Provider) Job start karna (status = 'in_progress')\n  app.patch(\"/api/bookings/:id/start-job\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const { id: bookingId } = req.params;\n      const booking = await storage.getBooking(bookingId);\n\n      if (!booking || booking.providerId !== providerId) {\n        return res.status(404).json({ message: \"Booking not found or access denied\" });\n      }\n      if (booking.status !== 'accepted') {\n        return res.status(400).json({ message: \"Job accept karne ke baad hi start kar sakte hain.\" });\n      }\n\n      const updatedBooking = await storage.updateBookingStatus(bookingId, 'in_progress');\n      res.json(updatedBooking);\n    } catch (error: any) {\n      console.error(\"Start job error:\", error);\n      res.status(500).json({ message: error.message || \"Error starting job\" });\n    }\n  });\n\n  // (Provider) Job done, OTP generate karna (status = 'awaiting_otp')\n  app.post(\"/api/bookings/:id/generate-otp\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const { id: bookingId } = req.params;\n\n      const { otp, userPhone } = await storage.generateOtpForBooking(bookingId, providerId);\n\n      res.json({ message: `OTP ${otp} customer ke phone ${userPhone} par bhej diya gaya hai.` });\n    } catch (error: any)\n    {\n      console.error(\"Generate OTP error:\", error);\n      res.status(500).json({ message: error.message || \"Error generating OTP\" });\n    }\n  });\n\n  // (Provider) OTP Verify karna (status = 'awaiting_billing')\n  app.post(\"/api/bookings/:id/verify-otp\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const { id: bookingId } = req.params;\n      const { otp } = z.object({ otp: z.string().length(6) }).parse(req.body);\n\n      const updatedBooking = await storage.verifyBookingOtp(bookingId, providerId, otp);\n\n      res.json({ message: \"OTP verified successfully! Ab aap bill bana sakte hain.\", booking: updatedBooking });\n    } catch (error: any) {\n      console.error(\"Verify OTP error:\", error);\n      res.status(400).json({ message: error.message || \"Error verifying OTP\" });\n    }\n  });\n\n  // (Provider) Final bill/invoice create karna (status = 'pending_payment')\n  app.post(\"/api/bookings/:id/create-invoice\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const userId = req.provider!.userId; // Provider ka user ID nahi, customer ka ID chahiye\n      const { id: bookingId } = req.params;\n\n      const booking = await storage.getBooking(bookingId);\n      if (!booking || booking.providerId !== providerId) {\n        return res.status(404).json({ message: \"Booking not found or access denied\" });\n      }\n      if (booking.status !== 'awaiting_billing') {\n        return res.status(400).json({ message: `Cannot create bill for booking with status: ${booking.status}` });\n      }\n\n      // Zod se validation\n      const billSchema = z.object({\n        serviceCharge: z.number().min(0),\n        spareParts: z.array(z.object({\n          part: z.string().min(1),\n          cost: z.number().min(0),\n        })).optional(),\n      });\n\n      const { serviceCharge, spareParts } = billSchema.parse(req.body);\n\n      const sparePartsTotal = spareParts?.reduce((sum, part) => sum + part.cost, 0) || 0;\n      const totalAmount = sparePartsTotal + serviceCharge;\n\n      const invoiceData: InsertInvoice = {\n        bookingId: bookingId,\n        providerId: providerId,\n        userId: booking.userId, // Customer ka user ID\n        sparePartsDetails: spareParts || [],\n        sparePartsTotal: sparePartsTotal.toString(),\n        serviceCharge: serviceCharge.toString(),\n        totalAmount: totalAmount.toString(),\n      };\n\n      const newInvoice = await storage.createInvoiceForBooking(invoiceData);\n\n      res.status(201).json({ message: \"Bill create ho gaya. Customer ab pay kar sakta hai.\", invoice: newInvoice });\n    } catch (error: any) {\n      console.error(\"Create invoice error:\", error);\n      res.status(400).json({ message: error.message || \"Error creating invoice\" });\n    }\n  });\n\n  // (Customer) Invoice ke liye payment order create karna\n  app.post(\"/api/invoices/:id/create-payment-order\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const { id: invoiceId } = req.params;\n\n      const { razorpayOrderId, amount, currency, invoice } = await storage.createPaymentOrderForInvoice(invoiceId, userId);\n\n      res.json({\n        razorpayKeyId: process.env.RAZORPAY_KEY_ID,\n        razorpayOrderId,\n        amount,\n        currency,\n        invoice,\n      });\n    } catch (error: any) {\n      console.error(\"Create invoice payment error:\", error);\n      res.status(500).json({ message: error.message || \"Error creating payment order\" });\n    }\n  });\n\n  // (Customer) Invoice payment verify karna (status = 'completed')\n  app.post(\"/api/invoices/verify-payment\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const { razorpay_order_id, razorpay_payment_id, razorpay_signature, invoice_id } = req.body;\n\n      if (!razorpay_order_id || !razorpay_payment_id || !razorpay_signature || !invoice_id) {\n        return res.status(400).json({ message: \"Missing payment details for verification\" });\n      }\n\n      const isValid = verifyPaymentSignature(razorpay_order_id, razorpay_payment_id, razorpay_signature);\n\n      if (isValid) {\n        const updatedInvoice = await storage.verifyInvoicePayment(\n          invoice_id,\n          razorpay_payment_id,\n          razorpay_order_id,\n          razorpay_signature\n        );\n        res.json({ status: \"success\", message: \"Payment verified successfully!\", invoice: updatedInvoice });\n      } else {\n        res.status(400).json({ status: \"failure\", message: \"Invalid payment signature\" });\n      }\n    } catch (error: any) {\n      console.error(\"Verify invoice payment error:\", error);\n      res.status(500).json({ message: error.message || \"Error verifying payment\" });\n    }\n  });\n\n\n  // --- BAAKI ROUTES (Grocery, Restaurant, etc.) ---\n\n  app.post(\"/api/grocery-orders\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const orderData = insertGroceryOrderSchema.parse(req.body);\n      const order = await storage.createGroceryOrder({ ...orderData, userId });\n      res.status(201).json(order);\n    } catch (error: any) {\n      console.error(\"Create grocery order error:\", error);\n      res.status(400).json({ message: error.message || \"Error creating grocery order\" });\n    }\n  });\n\n  // (Grocery Payment)\n  app.post(\"/api/payment/create-order\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const { orderId } = req.body; \n      if (!orderId) {\n        return res.status(400).json({ message: \"Order ID is required\" });\n      }\n      const order = await storage.getGroceryOrder(orderId);\n      if (!order || order.userId !== userId) {\n        return res.status(404).json({ message: \"Order not found or does not belong to user\" });\n      }\n      if (order.status !== 'pending') {\n        return res.status(400).json({ message: \"This order has already been processed.\" });\n      }\n      const amountInPaise = Math.round(parseFloat(order.total) * 100);\n      const options = {\n        amount: amountInPaise,\n        currency: \"INR\",\n        receipt: order.id,\n        notes: {\n          databaseOrderId: order.id,\n          userId: userId,\n        }\n      };\n      const razorpayOrder = await razorpayInstance.orders.create(options);\n      await storage.updateOrderWithRazorpayOrderId(order.id, razorpayOrder.id);\n      res.json({\n        razorpayKeyId: process.env.RAZORPAY_KEY_ID,\n        razorpayOrderId: razorpayOrder.id,\n        amount: razorpayOrder.amount,\n        currency: razorpayOrder.currency,\n      });\n    } catch (error: any) {\n      console.error(\"Create Razorpay order error:\", error);\n      res.status(500).json({ message: error.message || \"Error creating Razorpay order\" });\n    }\n  });\n\n  // (Grocery Payment Verify)\n  app.post(\"/api/payment/verify-signature\", async (req: Request, res: Response) => {\n    try {\n      const { razorpay_order_id, razorpay_payment_id, razorpay_signature, database_order_id } = req.body;\n      if (!razorpay_order_id || !razorpay_payment_id || !razorpay_signature || !database_order_id) {\n        return res.status(400).json({ message: \"Missing payment details for verification\" });\n      }\n      const isValid = verifyPaymentSignature(razorpay_order_id, razorpay_payment_id, razorpay_signature);\n      if (isValid) {\n        await storage.verifyAndUpdateOrderPayment(\n          database_order_id,\n          razorpay_payment_id,\n          razorpay_signature\n        );\n        res.json({ status: \"success\", message: \"Payment verified successfully\", orderId: database_order_id });\n      } else {\n        res.status(400).json({ status: \"failure\", message: \"Invalid payment signature\" });\n      }\n    } catch (error: any) {\n      console.error(\"Verify payment error:\", error);\n      res.status(500).json({ message: error.message || \"Error verifying payment\" });\n    }\n  });\n\n  app.post(\"/api/table-bookings\", isLoggedIn, async (req: AuthRequest, res: Response) => {\n    try {\n      const userId = req.userId!;\n      const validatedData = insertTableBookingSchema.parse(req.body);\n      const booking = await storage.createTableBooking({\n        ...validatedData,\n        userId,\n        providerId: req.body.providerId,\n      });\n      res.status(201).json(booking);\n    } catch (error: any) {\n      console.error(\"Create table booking error:\", error);\n      res.status(400).json({ message: error.message || \"Error creating table booking\" });\n    }\n  });\n\n  app.get(\"/api/street-food-items\", async (req: Request, res: Response) => {\n    try {\n      const { search, providerId } = req.query;\n      const items = await storage.getStreetFoodItems(providerId as string, search as string);\n      res.json(items);\n    } catch (error: any) {\n      console.error(\"Get street food items error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching street food items\" });\n    }\n  });\n\n  app.get(\"/api/restaurant-menu-items\", async (req: Request, res: Response) => {\n    try {\n      const items = await storage.getRestaurantMenuItems(); \n      res.json(items);\n    } catch (error: any) {\n      console.error(\"Get restaurant menu items error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching restaurant menu items\" });\n    }\n  });\n\n  app.get(\"/api/grocery-products\", async (req: Request, res: Response) => {\n    try {\n      const { providerId, search } = req.query;\n      if (!providerId) {\n        return res.status(400).json({ message: \"Provider ID is required\" });\n      }\n      const products = await storage.getGroceryProducts(providerId as string, search as string);\n      res.json(products);\n    } catch (error: any) {\n      console.error(\"Get grocery products error:\", error);\n      res.status(500).json({ message: error.message || \"Error fetching grocery products\" });\n    }\n  });\n\n  // --- MENU MANAGEMENT ROUTES (No Change) ---\n  app.post(\"/api/provider/menu-items/:categorySlug\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id; \n      const categorySlug = req.params.categorySlug;\n      const itemData = req.body;\n      const newItem = await storage.createMenuItem(itemData, providerId, categorySlug);\n      res.status(201).json(newItem);\n    } catch (error: any) {\n      console.error(`Error creating menu item in ${req.params.categorySlug}:`, error);\n      res.status(400).json({ message: error.message || \"Error creating menu item\" });\n    }\n  });\n\n  app.get(\"/api/provider/menu-items/:categorySlug\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const providerId = req.provider!.id;\n      const categorySlug = req.params.categorySlug;\n      const items = await storage.getProviderMenuItems(providerId, categorySlug);\n      res.json(items);\n    } catch (error: any) {\n      console.error(`Error fetching menu items from ${req.params.categorySlug}:`, error);\n      res.status(500).json({ message: error.message || \"Error fetching menu items\" });\n    }\n  });\n\n  app.patch(\"/api/provider/menu-items/:categorySlug/:itemId\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const { categorySlug, itemId } = req.params;\n      const providerId = req.provider!.id; \n      const updates = req.body;\n      const updatedItem = await storage.updateMenuItem(itemId, providerId, categorySlug, updates);\n      if (!updatedItem) {\n        return res.status(404).json({ message: \"Item not found or you don't have permission.\" });\n      }\n      res.json(updatedItem);\n    } catch (error: any) {\n      console.error(`Error updating menu item in ${req.params.categorySlug}:`, error);\n      res.status(400).json({ message: error.message || \"Error updating menu item\" });\n    }\n  });\n\n  app.delete(\"/api/provider/menu-items/:categorySlug/:itemId\", isProvider, async (req: CustomRequest, res: Response) => {\n    try {\n      const { categorySlug, itemId } = req.params;\n      const providerId = req.provider!.id; \n      const deletedItem = await storage.deleteMenuItem(itemId, providerId, categorySlug);\n      if (!deletedItem) {\n        return res.status(404).json({ message: \"Item not found or you don't have permission.\" });\n      }\n      res.json({ message: \"Item deleted successfully\", id: deletedItem.id });\n    } catch (error: any) {\n      console.error(`Error deleting menu item in ${req.params.categorySlug}:`, error);\n      res.status(500).json({ message: error.message || \"Error deleting menu item\" });\n    }\n  });\n\n  // --- Fallback Routes & Server Creation ---\n  const httpServer = createServer(app);\n  return httpServer;\n}","size_bytes":30546},"client/src/components/call-request-modal.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Phone, Star, User, Info } from \"lucide-react\";\n\ninterface CallRequestModalProps {\n  open: boolean;\n  onClose: () => void;\n  provider: {\n    id: string;\n    businessName: string;\n    rating: string;\n    user: {\n      username: string;\n    };\n  } | null;\n}\n\nconst timeSlots = [\n  \"9:00 AM\", \"11:00 AM\", \"2:00 PM\", \n  \"4:00 PM\", \"6:00 PM\", \"8:00 PM\"\n];\n\nexport default function CallRequestModal({ \n  open, \n  onClose, \n  provider \n}: CallRequestModalProps) {\n  const [callTime, setCallTime] = useState(\"now\");\n  const [selectedTimeSlot, setSelectedTimeSlot] = useState(\"\");\n  const { toast } = useToast();\n\n  const callRequestMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const response = await apiRequest(\"POST\", \"/api/call-request\", data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Call Request Sent\",\n        description: \"The provider will be notified and will contact you shortly.\",\n      });\n      onClose();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Request Failed\", \n        description: error.message || \"Failed to send call request. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const handleConfirmCall = () => {\n    if (!provider) return;\n\n    if (callTime === \"schedule\" && !selectedTimeSlot) {\n      toast({\n        title: \"Time Slot Required\",\n        description: \"Please select a preferred time slot.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const requestData = {\n      providerId: provider.id,\n      callType: callTime,\n      preferredTimeSlot: callTime === \"schedule\" ? selectedTimeSlot : null,\n      customerPhone: \"+91 9876543210\", // In real app, this would come from user profile\n    };\n\n    callRequestMutation.mutate(requestData);\n  };\n\n  if (!provider) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-md slide-up\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center justify-between\">\n            Request Call\n            <Button variant=\"ghost\" size=\"icon\" onClick={onClose}>\n              Ã—\n            </Button>\n          </DialogTitle>\n          <DialogDescription>\n            Connect with your selected service provider\n          </DialogDescription>\n        </DialogHeader>\n\n        {/* Provider Info */}\n        <div className=\"flex items-center space-x-4 p-4 bg-muted/30 rounded-lg\">\n          <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\n            <User className=\"h-6 w-6 text-primary\" />\n          </div>\n          <div>\n            <p className=\"font-semibold\">{provider.businessName}</p>\n            <div className=\"flex items-center space-x-1\">\n              <p className=\"text-sm text-muted-foreground\">\n                {provider.user.username}\n              </p>\n              <span>â€¢</span>\n              <div className=\"flex items-center\">\n                <Star className=\"h-3 w-3 text-yellow-500 fill-current\" />\n                <span className=\"text-sm ml-1\">{provider.rating}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Call Options */}\n        <div className=\"space-y-4\">\n          <div>\n            <p className=\"text-sm font-medium mb-3\">When would you like to connect?</p>\n            <RadioGroup value={callTime} onValueChange={setCallTime}>\n              <div className=\"flex items-center space-x-2 p-3 border rounded-lg\">\n                <RadioGroupItem value=\"now\" id=\"now\" />\n                <Label htmlFor=\"now\" className=\"cursor-pointer flex-1\">\n                  Call Now\n                </Label>\n              </div>\n              <div className=\"flex items-center space-x-2 p-3 border rounded-lg\">\n                <RadioGroupItem value=\"schedule\" id=\"schedule\" />\n                <Label htmlFor=\"schedule\" className=\"cursor-pointer flex-1\">\n                  Schedule for Later\n                </Label>\n              </div>\n            </RadioGroup>\n          </div>\n\n          {/* Time Slots */}\n          {callTime === \"schedule\" && (\n            <div>\n              <p className=\"text-sm font-medium mb-3\">Select Preferred Time Slot</p>\n              <div className=\"grid grid-cols-3 gap-2\">\n                {timeSlots.map((slot) => (\n                  <Button\n                    key={slot}\n                    variant={selectedTimeSlot === slot ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    onClick={() => setSelectedTimeSlot(slot)}\n                    data-testid={`timeslot-${slot.replace(/\\s+/g, '-').toLowerCase()}`}\n                  >\n                    {slot}\n                  </Button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex gap-3\">\n          <Button \n            variant=\"outline\" \n            className=\"flex-1\" \n            onClick={onClose}\n            disabled={callRequestMutation.isPending}\n          >\n            Cancel\n          </Button>\n          <Button \n            className=\"flex-1 flex items-center space-x-2\" \n            onClick={handleConfirmCall}\n            disabled={callRequestMutation.isPending}\n            data-testid=\"button-confirm-call\"\n          >\n            <Phone className=\"h-4 w-4\" />\n            <span>\n              {callRequestMutation.isPending ? \"Requesting...\" : \"Request Call\"}\n            </span>\n          </Button>\n        </div>\n\n        {/* Info Note */}\n        <div className=\"p-3 bg-muted/30 rounded-lg\">\n          <p className=\"text-xs text-muted-foreground flex items-start\">\n            <Info className=\"h-4 w-4 mr-2 mt-0.5 flex-shrink-0\" />\n            Your phone number will be shared securely. The provider's number will remain confidential.\n          </p>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":6441},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/App.tsx":{"content":"import { Switch, Route, Router as LocationProvider } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { AuthProvider } from \"@/hooks/use-auth\"; // Correct import for AuthProvider\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/home\";\nimport Electrician from \"@/pages/electrician\";\nimport ElectricianDetail from \"@/pages/electrician-detail\";\nimport Plumber from \"@/pages/plumber\";\nimport Beauty from \"@/pages/beauty\";\nimport BeautyDetail from \"@/pages/BeautyDetail\";\nimport CakeShop from \"@/pages/cake-shop\";\nimport Grocery from \"@/pages/grocery\";\nimport Rental from \"@/pages/rental\";\nimport StreetFood from \"@/pages/street-food\";\nimport StreetFoodDetail from \"@/pages/StreetFoodDetail\";\nimport Restaurants from \"@/pages/restaurants\";\nimport Checkout from \"@/pages/checkout\";\nimport ProviderDashboard from \"@/pages/provider-dashboard\";\nimport MyBookings from \"@/pages/my-bookings\";\nimport Login from \"@/pages/login\";\nimport Signup from \"@/pages/signup\";\nimport ProviderOnboarding from \"@/pages/provider-onboarding\";\nimport OrderSuccess from \"@/pages/OrderSuccess\";\nimport Header from \"@/components/layout/header\";\nimport Footer from \"@/components/layout/footer\";\n\nfunction RouterComponent() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/electrician/:id\" component={ElectricianDetail} />\n      <Route path=\"/electrician\" component={Electrician} />\n      <Route path=\"/plumber\" component={Plumber} />\n\n      {/* Beauty Services Routes */}\n      <Route path=\"/beauty\" component={Beauty} />\n      <Route path=\"/beauty/:parlorId\" component={BeautyDetail} />\n\n      <Route path=\"/cake-shop\" component={CakeShop} />\n      <Route path=\"/grocery\" component={Grocery} />\n      <Route path=\"/rental\" component={Rental} />\n      <Route path=\"/street-food\" component={StreetFood} />\n      <Route path=\"/street-food/:vendorId\" component={StreetFoodDetail} />\n      <Route path=\"/restaurants\" component={Restaurants} />\n      <Route path=\"/checkout\" component={Checkout} />\n      <Route path=\"/order-success\" component={OrderSuccess} />\n\n      <Route path=\"/provider/dashboard\" component={ProviderDashboard} />\n\n      <Route path=\"/my-bookings\" component={MyBookings} />\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/signup\" component={Signup} />\n      <Route path=\"/provider-onboarding\" component={ProviderOnboarding} />\n\n      {/* Fallback for 404 */}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider> {/* Correctly using AuthProvider */}\n        <LocationProvider>\n          <TooltipProvider>\n            <div className=\"min-h-screen bg-background text-foreground flex flex-col\">\n              <Header />\n              <main className=\"flex-1\">\n                <RouterComponent />\n              </main>\n              <Footer />\n            </div>\n            <Toaster />\n          </TooltipProvider>\n        </LocationProvider>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;","size_bytes":3273},"client/src/hooks/use-cart.tsx":{"content":"import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nexport interface CartItem {\n  id: string;\n  name: string;\n  price: number;\n  quantity: number;\n  weight?: string;\n  imageUrl?: string;\n}\n\ninterface CartStore {\n  items: CartItem[];\n  addItem: (item: Omit<CartItem, 'quantity'>) => void;\n  removeItem: (id: string) => void;\n  updateQuantity: (id: string, quantity: number) => void;\n  clearCart: () => void;\n  getTotal: () => number;\n  getItemCount: () => number;\n}\n\nexport const useCart = create<CartStore>()(\n  persist(\n    (set, get) => ({\n      items: [],\n      \n      addItem: (newItem) =>\n        set((state) => {\n          const existingItem = state.items.find((item) => item.id === newItem.id);\n          \n          if (existingItem) {\n            return {\n              items: state.items.map((item) =>\n                item.id === newItem.id\n                  ? { ...item, quantity: item.quantity + 1 }\n                  : item\n              ),\n            };\n          }\n          \n          return {\n            items: [...state.items, { ...newItem, quantity: 1 }],\n          };\n        }),\n      \n      removeItem: (id) =>\n        set((state) => ({\n          items: state.items.filter((item) => item.id !== id),\n        })),\n      \n      updateQuantity: (id, quantity) =>\n        set((state) => {\n          if (quantity <= 0) {\n            return {\n              items: state.items.filter((item) => item.id !== id),\n            };\n          }\n          \n          return {\n            items: state.items.map((item) =>\n              item.id === id ? { ...item, quantity } : item\n            ),\n          };\n        }),\n      \n      clearCart: () => set({ items: [] }),\n      \n      getTotal: () => {\n        const { items } = get();\n        return items.reduce((total, item) => total + item.price * item.quantity, 0);\n      },\n      \n      getItemCount: () => {\n        const { items } = get();\n        return items.reduce((count, item) => count + item.quantity, 0);\n      },\n    }),\n    {\n      name: 'servicehub-cart',\n    }\n  )\n);\n","size_bytes":2073},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/pages/checkout.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle, CardFooter } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useCartStore } from \"@/hooks/use-cart-store\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ArrowLeft, ShoppingCart, Truck, Minus, Plus, Trash2, Loader2 } from \"lucide-react\";\n\n// --- NAYE IMPORTS ---\nimport { z } from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport api from \"@/lib/api\"; // API client\nimport { useAuth } from \"@/hooks/use-auth\"; // User details ke liye\n// --- IMPORTS KHATAM ---\n\n// Delivery Address ke liye Schema\nconst checkoutSchema = z.object({\n  deliveryAddress: z.string().min(10, {\n    message: \"Please enter a valid delivery address (min. 10 characters).\",\n  }),\n});\n\ntype CheckoutFormValues = z.infer<typeof checkoutSchema>;\n\n// Yeh function Razorpay script load hone ka wait karega\nconst loadRazorpayScript = () => {\n  return new Promise((resolve) => {\n    if (document.getElementById('razorpay-checkout-js')) {\n      resolve(true);\n      return;\n    }\n    const script = document.createElement(\"script\");\n    script.id = \"razorpay-checkout-js\";\n    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\n    script.onload = () => {\n      resolve(true);\n    };\n    script.onerror = () => {\n      resolve(false);\n    };\n    document.body.appendChild(script);\n  });\n};\n\n\nexport default function Checkout() {\n  const [, setLocation] = useLocation();\n  const { user } = useAuth(); // Logged in user ko get karo\n  const { items, removeItem, increaseQuantity, decreaseQuantity, getTotalPrice, clearCart } = useCartStore();\n  const { toast } = useToast();\n  const [isPlacingOrder, setIsPlacingOrder] = useState(false);\n\n  // Fees calculation\n  const subtotal = getTotalPrice();\n  const platformFee = subtotal * 0.01; // 1%\n  const deliveryFee = 24.50; // Mock delivery fee\n  const total = subtotal + platformFee + deliveryFee;\n\n  // Form setup\n  const form = useForm<CheckoutFormValues>({\n    resolver: zodResolver(checkoutSchema),\n    defaultValues: {\n      deliveryAddress: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (items.length === 0 && !isPlacingOrder) {\n      setLocation('/street-food'); // Ya grocery, jahan se user aaya\n    }\n  }, [items.length, setLocation, isPlacingOrder]);\n\n\n  // --- YEH FUNCTION POORA NAYA HAI ---\n  const onSubmit = async (values: CheckoutFormValues) => {\n    setIsPlacingOrder(true);\n\n    // 1. Razorpay script load karo\n    const scriptLoaded = await loadRazorpayScript();\n    if (!scriptLoaded) {\n      toast({ title: \"Error\", description: \"Payment gateway failed to load. Please try again.\", variant: \"destructive\" });\n      setIsPlacingOrder(false);\n      return;\n    }\n\n    if (!user) {\n      toast({ title: \"Error\", description: \"You must be logged in to place an order.\", variant: \"destructive\" });\n      setIsPlacingOrder(false);\n      return;\n    }\n\n    try {\n      // 2. Pehle apne database mein order create karo (status: 'pending')\n      const orderPayload = {\n        items: items.map(item => ({ productId: item.id, quantity: item.quantity, price: item.price })),\n        subtotal,\n        platformFee,\n        deliveryFee,\n        total,\n        deliveryAddress: values.deliveryAddress,\n      };\n\n      const dbOrderResponse = await api.post(\"/api/grocery-orders\", orderPayload);\n      const dbOrder = await dbOrderResponse.data;\n      const databaseOrderId = dbOrder.id;\n\n      // 3. Ab Razorpay ka order create karo\n      const rzpOrderResponse = await api.post(\"/api/payment/create-order\", {\n        orderId: databaseOrderId,\n      });\n      const rzpOrder = await rzpOrderResponse.data;\n\n      // 4. Razorpay Popup Options\n      const options = {\n        key: rzpOrder.razorpayKeyId,\n        amount: rzpOrder.amount,\n        currency: rzpOrder.currency,\n        name: \"Shirur Express\",\n        description: `Order ID: ${databaseOrderId}`,\n        order_id: rzpOrder.razorpayOrderId,\n\n        // Yeh function tab call hoga jab payment complete hogi\n        handler: async (response: any) => {\n          try {\n            // 5. Payment ko server par verify karo\n            const verificationResponse = await api.post(\"/api/payment/verify-signature\", {\n              razorpay_order_id: response.razorpay_order_id,\n              razorpay_payment_id: response.razorpay_payment_id,\n              razorpay_signature: response.razorpay_signature,\n              database_order_id: databaseOrderId, \n            });\n\n            if (verificationResponse.data.status === 'success') {\n              // 6. Success!\n              toast({\n                title: \"âœ… Order Placed!\",\n                description: \"Your payment was successful.\",\n              });\n              clearCart();\n              setLocation(\"/order-success\"); // Success page par bhejo\n            } else {\n              throw new Error(\"Payment verification failed\");\n            }\n\n          } catch (verifyError) {\n            toast({ title: \"Payment Failed\", description: \"Signature verification failed. Please contact support.\", variant: \"destructive\" });\n            setIsPlacingOrder(false);\n          }\n        },\n        prefill: {\n          name: user.username,\n          email: user.email,\n          contact: user.phone,\n        },\n        notes: {\n          address: values.deliveryAddress,\n          databaseOrderId: databaseOrderId,\n        },\n        theme: {\n          color: \"#3399cc\",\n        },\n        modal: {\n          ondismiss: () => {\n            toast({ title: \"Payment Cancelled\", description: \"Your order was not placed.\", variant: \"destructive\" });\n            setIsPlacingOrder(false);\n          },\n        },\n      };\n\n      // 7. Razorpay Popup Kholo\n      const paymentObject = new (window as any).Razorpay(options);\n      paymentObject.open();\n\n    } catch (error: any) {\n      toast({\n        title: \"Order Failed\",\n        description: error.response?.data?.message || \"Could not create order. Please try again.\",\n        variant: \"destructive\",\n      });\n      setIsPlacingOrder(false);\n    }\n  };\n\n\n  return (\n    <div className=\"min-h-screen bg-background py-16\">\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/street-food\")} // TODO: Isko dynamic bana sakte ho\n          data-testid=\"button-back\"\n          disabled={isPlacingOrder}\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Shopping</span>\n        </Button>\n\n        <h1 className=\"text-3xl font-bold mb-8\">Checkout</h1>\n\n        {/* --- YEH POORA FORM ME WRAP KIYA HAI --- */}\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)}>\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n\n              {/* Left Column: Address + Cart */}\n              <div>\n                <Card className=\"mb-8\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <Truck className=\"h-5 w-5\" />\n                      <span>Delivery Details</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    {/* --- YEH NAYA ADDRESS FORM FIELD HAI --- */}\n                    <FormField\n                      control={form.control}\n                      name=\"deliveryAddress\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Delivery Address</FormLabel>\n                          <FormControl>\n                            <Textarea\n                              placeholder=\"Enter your full address, including house number, street, and landmark...\"\n                              className=\"resize-none\"\n                              rows={4}\n                              {...field}\n                              data-testid=\"input-address\"\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <ShoppingCart className=\"h-5 w-5\" />\n                      <span>Your Cart Items</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    {/* Items List */}\n                    <div className=\"space-y-3 max-h-60 overflow-y-auto pr-2\">\n                      {items.map((item) => (\n                        <div key={item.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                          <div className=\"flex items-center space-x-3\">\n                            {item.imageUrl && (\n                              <img\n                                src={item.imageUrl}\n                                alt={item.name}\n                                className=\"w-10 h-10 rounded object-cover\"\n                              />\n                            )}\n                            <div>\n                              <p className=\"font-medium\">{item.name}</p>\n                              <p className=\"text-sm text-muted-foreground\">â‚¹{item.price.toFixed(2)} / item</p>\n                            </div>\n                          </div>\n                          <div className=\"text-right flex items-center space-x-2\">\n                            <Button\n                              variant=\"outline\" size=\"icon\" className=\"h-7 w-7\"\n                              onClick={() => decreaseQuantity(item.id)}\n                              disabled={item.quantity <= 1 || isPlacingOrder}\n                              aria-label=\"Decrease quantity\" type=\"button\"\n                            > <Minus className=\"h-4 w-4\" /> </Button>\n\n                            <Badge variant=\"secondary\" className=\"h-7 w-7 flex items-center justify-center\">\n                                {item.quantity}\n                            </Badge>\n\n                            <Button\n                              variant=\"outline\" size=\"icon\" className=\"h-7 w-7\"\n                              onClick={() => increaseQuantity(item.id)}\n                              aria-label=\"Increase quantity\" type=\"button\"\n                              disabled={isPlacingOrder}\n                            > <Plus className=\"h-4 w-4\" /> </Button>\n\n                            <Button\n                              variant=\"ghost\" size=\"icon\"\n                              onClick={() => removeItem(item.id)}\n                              aria-label=\"Remove item\" type=\"button\"\n                              className=\"ml-2 text-destructive\"\n                              disabled={isPlacingOrder}\n                            > <Trash2 className=\"h-5 w-5\" /> </Button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Right Column: Price Summary & Pay Button */}\n              <div>\n                <Card className=\"sticky top-24\">\n                  <CardHeader>\n                    <CardTitle>Price Summary</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span>Subtotal</span>\n                      <span>â‚¹{subtotal.toFixed(2)}</span>\n                    </div>\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-muted-foreground\">Platform Fee (1%)</span>\n                      <span>â‚¹{platformFee.toFixed(2)}</span>\n                    </div>\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-muted-foreground\">\n                        Delivery Fee\n                      </span>\n                      <span>â‚¹{deliveryFee.toFixed(2)}</span>\n                    </div>\n                    <Separator />\n                    <div className=\"flex justify-between font-semibold text-lg\">\n                      <span>Total</span>\n                      <span>â‚¹{total.toFixed(2)}</span>\n                    </div>\n                  </CardContent>\n                  <CardFooter>\n                    <Button\n                      type=\"submit\" // <-- YEH CHANGE HUA\n                      className=\"w-full\"\n                      disabled={items.length === 0 || isPlacingOrder}\n                      data-testid=\"button-place-order\"\n                    >\n                      {isPlacingOrder ? (\n                        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      ) : (\n                        `Pay Securely (â‚¹${total.toFixed(2)})`\n                      )}\n                    </Button>\n                  </CardFooter>\n                </Card>\n              </div>\n\n            </div>\n          </form>\n        </Form>\n      </div>\n    </div>\n  );\n}","size_bytes":13670},"server/seed-electrician-problems.ts":{"content":"import { db } from \"./db\";\nimport { serviceCategories, serviceProblems } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nconst electricianProblems = [\n  {\n    device: \"Air Conditioner (AC)\",\n    issues: [\n      \"Not cooling properly\",\n      \"Water leakage\",\n      \"Unusual noises\",\n      \"Bad odor from vents\",\n      \"Remote not working\",\n      \"Power turning on/off frequently\",\n      \"Frozen coils\",\n      \"High electricity consumption\",\n    ],\n  },\n  {\n    device: \"Refrigerator\",\n    issues: [\n      \"Not cooling or overcooling\",\n      \"Water leakage\",\n      \"Fridge making loud or unusual noise\",\n      \"Ice maker not working\",\n      \"Frost build-up in freezer\",\n      \"Fridge light not working\",\n      \"Compressor issues\",\n      \"Door not closing properly\",\n    ],\n  },\n  {\n    device: \"Television (TV)\",\n    issues: [\n      \"No display / black screen\",\n      \"No sound\",\n      \"HDMI/AV ports not functioning\",\n      \"TV turning on and off by itself\",\n      \"Distorted image or colors\",\n      \"Lines on the screen\",\n      \"Wall mount installation needed\",\n    ],\n  },\n  {\n    device: \"Water Heater (Geyser)\",\n    issues: [\n      \"Not heating water\",\n      \"Water leakage\",\n      \"Unusual noises\",\n      \"Electrical tripping when turned on\",\n      \"Low hot water pressure\",\n      \"Foul smell from hot water\",\n      \"Thermostat not working\",\n    ],\n  },\n  {\n    device: \"Washing Machine\",\n    issues: [\n      \"Not spinning\",\n      \"Water not draining\",\n      \"Door not opening\",\n      \"Vibrating excessively\",\n      \"Leaking water\",\n    ],\n  },\n  {\n    device: \"Microwave Oven\",\n    issues: [\n      \"Not heating food\",\n      \"Sparking inside\",\n      \"Buttons not responding\",\n      \"Turntable not rotating\",\n    ],\n  },\n];\n\nasync function seedElectricianProblems() {\n  console.log(\"ðŸ”Œ Seeding electrician problems...\");\n\n  try {\n    // Get electrician category\n    const electricianCategory = await db\n      .select()\n      .from(serviceCategories)\n      .where(eq(serviceCategories.slug, \"electrician\"))\n      .limit(1);\n\n    if (electricianCategory.length === 0) {\n      console.error(\n        \"âŒ Electrician category not found. Please run the main seed script first.\",\n      );\n      process.exit(1);\n    }\n\n    const categoryId = electricianCategory[0].id;\n\n    // Delete existing electrician problems\n    await db\n      .delete(serviceProblems)\n      .where(eq(serviceProblems.categoryId, categoryId));\n    console.log(\"âœ… Cleared existing electrician problems\");\n\n    // Insert device categories (parent problems)\n    for (const problem of electricianProblems) {\n      const [parentProblem] = await db\n        .insert(serviceProblems)\n        .values({\n          categoryId,\n          name: problem.device,\n          parentId: null,\n        })\n        .returning();\n\n      console.log(`âœ… Created device category: ${problem.device}`);\n\n      // Insert issues for each device (child problems)\n      for (const issue of problem.issues) {\n        await db.insert(serviceProblems).values({\n          categoryId,\n          name: issue,\n          parentId: parentProblem.id,\n        });\n      }\n\n      console.log(\n        `   âœ… Added ${problem.issues.length} issues for ${problem.device}`,\n      );\n    }\n\n    console.log(\"âœ¨ Electrician problems seeding completed successfully!\");\n  } catch (error) {\n    console.error(\"âŒ Error seeding electrician problems:\", error);\n    throw error;\n  }\n}\n\nseedElectricianProblems()\n  .then(() => {\n    console.log(\"âœ… Seed script completed\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"âŒ Seed script failed:\", error);\n    process.exit(1);\n  });\n","size_bytes":3635},"client/src/pages/electrician-detail.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation, useRoute } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport BookingSlotForm from \"@/components/booking-slot-form\";\nimport { \n  ArrowLeft, \n  MapPin, \n  Star, \n  Briefcase, \n  CheckCircle2,\n  Clock,\n  Phone,\n  Loader2\n} from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { ServiceProvider, ServiceProblem, User, ServiceCategory } from \"@shared/schema\";\n\ntype ElectricianProviderDetail = ServiceProvider & { \n  user: User; \n  category: ServiceCategory; \n};\n\nexport default function ElectricianDetail() {\n  const [, setLocation] = useLocation();\n  const [, params] = useRoute(\"/electrician/:id\");\n  const [selectedProblem, setSelectedProblem] = useState<{id: string; name: string} | null>(null);\n  const [showBooking, setShowBooking] = useState(false);\n\n  const providerId = params?.id;\n\n  // Get electrician details (FIXED)\n  const { data: provider, isLoading } = useQuery<ElectricianProviderDetail>({\n    queryKey: [\"service-provider-detail\", providerId],\n    queryFn: () => \n      apiRequest(\"GET\", `/api/service-providers/${providerId}`)\n        .then(res => res.json()),\n    enabled: !!providerId,\n  });\n\n  // Get all appliances (parent problems) (FIXED)\n  const { data: appliances, isLoading: appliancesLoading } = useQuery<ServiceProblem[]>({\n    queryKey: [\"service-problems\", \"electrician\"],\n    queryFn: () => \n      apiRequest(\"GET\", \"/api/service-problems?category=electrician\")\n        .then(res => res.json()),\n    enabled: !!provider, // Jab provider load ho jaye tab\n  });\n\n  const handleProblemSelect = (problemId: string, problemName: string) => {\n    setSelectedProblem({ id: problemId, name: problemName });\n    setShowBooking(true);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"py-16 bg-background\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground mx-auto\" />\n          <p className=\"text-muted-foreground mt-2\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!provider) {\n    return (\n      <div className=\"py-16 bg-background\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <p className=\"text-center text-muted-foreground\">\n            Technician not found\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button */}\n        <Button\n          variant=\"ghost\"\n          className=\"mb-6 flex items-center space-x-2\"\n          onClick={() => setLocation(\"/electrician\")}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Back to Technicians</span>\n        </Button>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Electrician Profile */}\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <CardTitle className=\"text-2xl mb-1\">\n                      {provider.businessName}\n                    </CardTitle>\n                    <p className=\"text-sm text-muted-foreground\">\n                      @{provider.user?.username}\n                    </p>\n                  </div>\n                  {provider.isVerified && (\n                    <Badge variant=\"secondary\" className=\"flex items-center gap-1\">\n                      <CheckCircle2 className=\"h-3 w-3\" />\n                      Verified\n                    </Badge>\n                  )}\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {/* Rating */}\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex items-center\">\n                    <Star className=\"h-5 w-5 fill-yellow-400 text-yellow-400\" />\n                    <span className=\"ml-1 font-semibold\">\n                      {provider.rating}\n                    </span>\n                  </div>\n                  <span className=\"text-sm text-muted-foreground\">\n                    ({provider.reviewCount} reviews)\n                  </span>\n                </div>\n\n                <Separator />\n\n                {/* Experience */}\n                <div className=\"flex items-center space-x-2 text-muted-foreground\">\n                  <Briefcase className=\"h-4 w-4\" />\n                  <span>{provider.experience} years experience</span>\n                </div>\n\n                {/* Location */}\n                <div className=\"flex items-start space-x-2 text-muted-foreground\">\n                  <MapPin className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\n                  <span className=\"text-sm\">{provider.address}</span>\n                </div>\n\n                {/* Availability */}\n                <div className=\"flex items-center space-x-2\">\n                  <Clock className=\"h-4 w-4\" />\n                  <span className={provider.isAvailable ? \"text-green-600\" : \"text-red-600\"}>\n                    {provider.isAvailable ? \"Available Now\" : \"Not Available\"}\n                  </span>\n                </div>\n\n                <Separator />\n\n                {/* Specializations */}\n                {provider.specializations && provider.specializations.length > 0 && (\n                  <div>\n                    <h4 className=\"font-semibold mb-2\">Specializations</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {provider.specializations.map((spec: string, index: number) => (\n                        <Badge key={index} variant=\"outline\">\n                          {spec}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Problems This Electrician Can Handle */}\n          <div className=\"lg:col-span-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Electrical Problems I Can Fix</CardTitle>\n                <p className=\"text-sm text-muted-foreground\">\n                  Select a problem to book a service slot\n                </p>\n              </CardHeader>\n              <CardContent>\n                {appliancesLoading ? (\n                   <p className=\"text-center text-muted-foreground py-8\">Loading problems...</p>\n                ) : appliances && appliances.length > 0 ? (\n                  <div className=\"space-y-6\">\n                    {/* Sirf wohi appliances dikhao jo provider specialize karta hai */}\n                    {appliances\n                      .filter(appliance => provider.specializations?.includes(appliance.name))\n                      .map((appliance: any) => (\n                      <ApplianceProblems\n                        key={appliance.id}\n                        appliance={appliance}\n                        selectedProblemId={selectedProblem?.id || \"\"}\n                        onProblemSelect={handleProblemSelect}\n                      />\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-center text-muted-foreground py-8\">\n                    No problems listed\n                  </p>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Booking Section - Shown when problem is selected */}\n            {showBooking && selectedProblem && (\n              <Card className=\"mt-6\">\n                <CardHeader>\n                  <CardTitle>Book a Service Slot</CardTitle>\n                  <p className=\"text-sm text-muted-foreground\">\n                    You selected: <span className=\"text-primary font-medium\">{selectedProblem.name}</span>\n                  </p>\n                </CardHeader>\n                <CardContent>\n                  <BookingSlotForm\n                    providerId={providerId!}\n                    problemId={selectedProblem.id}\n                    problemName={selectedProblem.name}\n                    onSuccess={() => {\n                      setShowBooking(false);\n                      setSelectedProblem(null);\n                    }}\n                  />\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Component to display problems for each appliance (FIXED)\nfunction ApplianceProblems({\n  appliance,\n  selectedProblemId,\n  onProblemSelect,\n}: {\n  appliance: ServiceProblem;\n  selectedProblemId: string;\n  onProblemSelect: (problemId: string, problemName: string) => void;\n}) {\n  // Child problems fetch karo (FIXED)\n  const { data: problems, isLoading } = useQuery<ServiceProblem[]>({\n    queryKey: [\n      \"service-problems\",\n      \"electrician\",\n      appliance.id, // Parent ID\n    ],\n    queryFn: () => \n      apiRequest(\"GET\", `/api/service-problems?category=electrician&parentId=${appliance.id}`)\n        .then(res => res.json()),\n    enabled: !!appliance.id,\n  });\n\n  return (\n    <div>\n      <h4 className=\"font-semibold mb-3 flex items-center\">\n        {appliance.name}\n      </h4>\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n        {isLoading ? (\n          <p className=\"text-sm text-muted-foreground\">Loading issues...</p>\n        ) : (\n          problems?.map((problem: any) => (\n            <Button\n              key={problem.id}\n              variant={selectedProblemId === problem.id ? \"default\" : \"outline\"}\n              className=\"justify-start\"\n              onClick={() => onProblemSelect(problem.id, problem.name)}\n              data-testid={`button-problem-${problem.id}`}\n            >\n              {problem.name}\n            </Button>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":10129},"client/src/pages/provider-dashboard.tsx":{"content":"// client/src/pages/provider-dashboard.tsx\n// (POORA REBUILT CODE - BLUEPRINT KE HISAB SE)\n\nimport React, { useState } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport api from \"@/lib/api\";\nimport {\n  ServiceProvider,\n  ServiceCategory,\n  ServiceProblem,\n  Booking,\n  Invoice,\n  User,\n} from \"@shared/schema\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  PlusCircle,\n  Loader2,\n  Save,\n  Upload,\n  Image as ImageIcon,\n  Check,\n  X,\n  Play,\n  ClipboardCheck,\n  FileText,\n  DollarSign,\n  AlertTriangle,\n  Home,\n  Trash2,\n} from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport MenuItemForm from \"@/components/forms/MenuItemForm\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n  DialogTrigger,\n  DialogFooter,\n  DialogClose,\n} from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link, Redirect } from \"wouter\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  InputOTP,\n  InputOTPGroup,\n  InputOTPSlot,\n} from \"@/components/ui/input-otp\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useForm, useFieldArray } from \"react-hook-form\";\nimport { z } from \"zod\";\n\n// --- TYPES ---\n\n// Provider profile API se jaisa aayega\ntype ProviderProfileWithCategory = ServiceProvider & {\n  category: ServiceCategory;\n  profileImageUrl?: string | null;\n  galleryImages?: string[] | null;\n};\n\n// Booking API se jaisi aayegi (user aur invoice ke saath)\ntype FullBooking = Booking & {\n  user: Pick<User, \"id\" | \"username\" | \"phone\">;\n  invoice: Invoice | null;\n};\n\n// Bill/Invoice create karne ka Zod schema\nconst billFormSchema = z.object({\n  serviceCharge: z.preprocess(\n    (val) => (val === \"\" ? 0 : parseFloat(z.string().parse(val))),\n    z.number().min(0, \"Service charge is required\")\n  ),\n  spareParts: z.array(\n    z.object({\n      part: z.string().min(1, \"Part name is required\"),\n      cost: z.preprocess(\n        (val) => (val === \"\" ? 0 : parseFloat(z.string().parse(val))),\n        z.number().min(0, \"Price must be positive\")\n      ),\n    })\n  ).optional(),\n  // notes: z.string().optional(), // Notes abhi form mein nahi hain, baad mein add kar sakte hain\n});\n\ntype BillFormData = z.infer<typeof billFormSchema>;\n\n// --- COMPONENT 1: MENU MANAGER (Yeh waise ka waisa hai) ---\nconst MenuItemsManager: React.FC<{\n  providerProfile: ProviderProfileWithCategory;\n}> = ({ providerProfile }) => {\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n  const providerCategorySlug = providerProfile.category.slug;\n\n  const {\n    data: menuItems,\n    isLoading: isLoadingMenuItems,\n    refetch: refetchMenuItems,\n  } = useQuery<any[]>({\n    queryKey: [\"providerMenuItems\", providerCategorySlug],\n    queryFn: async () => {\n      if (!providerCategorySlug) return [];\n      const res = await api.get(\n        `/provider/menu-items/${providerCategorySlug}`\n      );\n      return res.data;\n    },\n    enabled: !!providerCategorySlug,\n  });\n\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [editingItem, setEditingItem] = useState<any | null>(null);\n\n  const deleteMenuItemMutation = useMutation({\n    mutationFn: (itemId: string) =>\n      api.delete(`/provider/menu-items/${providerCategorySlug}/${itemId}`),\n    onSuccess: () => {\n      toast({ title: \"Success\", description: \"Menu item deleted.\" });\n      queryClient.invalidateQueries({\n        queryKey: [\"providerMenuItems\", providerCategorySlug],\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.response?.data?.message || \"Failed to delete.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleEdit = (item: any) => {\n    setEditingItem(item);\n    setIsFormOpen(true);\n  };\n\n  const handleDelete = (itemId: string) => {\n    if (confirm(\"Are you sure you want to delete this item?\")) {\n      deleteMenuItemMutation.mutate(itemId);\n    }\n  };\n\n  const handleFormSuccess = () => {\n    setIsFormOpen(false);\n    setEditingItem(null);\n    refetchMenuItems();\n  };\n\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between\">\n        <div>\n          <CardTitle>My Menu Items</CardTitle>\n          <CardDescription>\n            Manage the items for your '\n            {providerProfile.category ? providerProfile.category.name : \"service\"}\n            ' service.\n          </CardDescription>\n        </div>\n        <Dialog\n          open={isFormOpen}\n          onOpenChange={(isOpen) => {\n            setIsFormOpen(isOpen);\n            if (!isOpen) setEditingItem(null);\n          }}\n        >\n          <DialogTrigger asChild>\n            <Button onClick={() => setEditingItem(null)}>\n              <PlusCircle className=\"mr-2 h-4 w-4\" /> Add New Item\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-[480px]\">\n            <DialogHeader>\n              <DialogTitle>\n                {editingItem ? \"Edit Item\" : \"Add New Item\"}\n              </DialogTitle>\n              <DialogDescription>\n                Fill in the details for your service or product.\n              </DialogDescription>\n            </DialogHeader>\n            <MenuItemForm\n              providerId={providerProfile.id}\n              categorySlug={providerCategorySlug}\n              initialData={editingItem}\n              onSuccess={handleFormSuccess}\n            />\n          </DialogContent>\n        </Dialog>\n      </CardHeader>\n      <CardContent>\n        {isLoadingMenuItems ? (\n          <div className=\"flex justify-center py-10\">\n            <Loader2 className=\"mr-2 h-6 w-6 animate-spin\" /> Loading menu...\n          </div>\n        ) : !Array.isArray(menuItems) || menuItems.length === 0 ? (\n          <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n            <h3 className=\"text-xl font-semibold\">Your Menu is Empty</h3>\n            <p className=\"text-muted-foreground mt-2\">\n              Click \"Add New Item\" to start building your menu.\n            </p>\n          </div>\n        ) : (\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead className=\"w-[80px]\">Image</TableHead>\n                <TableHead>Name</TableHead>\n                <TableHead>Category</TableHead>\n                <TableHead>Price (â‚¹)</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {menuItems.map((item) => (\n                <TableRow key={item.id}>\n                  <TableCell>\n                    {item.imageUrl ? (\n                      <img\n                        src={item.imageUrl}\n                        alt={item.name}\n                        className=\"w-16 h-16 object-cover rounded-md\"\n                      />\n                    ) : (\n                      <div className=\"w-16 h-16 bg-muted rounded-md\" />\n                    )}\n                  </TableCell>\n                  <TableCell className=\"font-medium\">{item.name}</TableCell>\n                  <TableCell>\n                    {item.category ? (\n                      <Badge variant=\"outline\">{item.category}</Badge>\n                    ) : (\n                      \"N/A\"\n                    )}\n                  </TableCell>\n                  <TableCell>{item.price}</TableCell>\n                  <TableCell className=\"text-right\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => handleEdit(item)}\n                      className=\"mr-2\"\n                    >\n                      Edit\n                    </Button>\n                    <Button\n                      variant=\"destructive\"\n                      size=\"sm\"\n                      onClick={() => handleDelete(item.id)}\n                      disabled={\n                        deleteMenuItemMutation.isPending &&\n                        deleteMenuItemMutation.variables === item.id\n                      }\n                    >\n                      {deleteMenuItemMutation.isPending &&\n                      deleteMenuItemMutation.variables === item.id ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\n                      ) : (\n                        \"Delete\"\n                      )}\n                    </Button>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\n// --- COMPONENT 2: BOOKING MANAGER (POORA NAYA BANA HAI) ---\nconst BookingsManager: React.FC<{\n  providerProfile: ProviderProfileWithCategory;\n}> = ({ providerProfile }) => {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Bookings Fetch karne ka logic\n  const { data: bookings, isLoading: isLoadingBookings } = useQuery<\n    FullBooking[]\n  >({\n    queryKey: [\"providerBookings\"],\n    queryFn: async () => {\n      const res = await api.get(\"/provider/my-bookings\");\n      return res.data;\n    },\n    // Har 30 second mein refresh karo (urgent bookings ke liye)\n    refetchInterval: 30000,\n  });\n\n  // Action mutations (Accept / Decline)\n  const updateBookingStatusMutation = useMutation({\n    mutationFn: ({\n      bookingId,\n      action,\n    }: {\n      bookingId: string;\n      action: \"accept\" | \"decline\" | \"start-job\";\n    }) => api.patch(`/bookings/${bookingId}/${action}`),\n    onSuccess: (data) => {\n      toast({\n        title: `Booking ${data.data.status}`,\n        description: `Booking ID ${data.data.id} has been updated.`,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"providerBookings\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description:\n          error.response?.data?.message || \"Failed to update booking.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getBadgeColor = (status: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n    switch (status) {\n      case \"pending\": return \"default\"; // Blue\n      case \"accepted\": return \"secondary\"; // Gray\n      case \"in_progress\": return \"secondary\"; // Gray\n      case \"awaiting_otp\": return \"secondary\"; // Gray\n      case \"awaiting_billing\": return \"secondary\"; // Gray\n      case \"pending_payment\": return \"secondary\"; // Gray\n      case \"completed\": return \"default\"; // Green (custom style se)\n      case \"declined\":\n      case \"cancelled\": return \"destructive\"; // Red\n      default: return \"outline\";\n    }\n  };\n\n  const filterBookings = (statusList: string[]) => {\n    if (!Array.isArray(bookings)) return [];\n    return bookings.filter(b => statusList.includes(b.status || 'pending'));\n  }\n\n  const newBookings = filterBookings(['pending']);\n  const activeBookings = filterBookings(['accepted', 'in_progress', 'awaiting_otp', 'awaiting_billing', 'pending_payment']);\n  const completedBookings = filterBookings(['completed', 'declined', 'cancelled']);\n\n  if (isLoadingBookings) {\n    return (\n        <Card>\n            <CardHeader>\n                <CardTitle>My Bookings</CardTitle>\n                <CardDescription>\n                View and manage your upcoming bookings for '\n                {providerProfile.category ? providerProfile.category.name : 'your service'}\n                '.\n                </CardDescription>\n            </CardHeader>\n            <CardContent>\n                <div className=\"flex justify-center py-10\">\n                    <Loader2 className=\"mr-2 h-6 w-6 animate-spin\" /> Loading\n                    bookings...\n                </div>\n            </CardContent>\n        </Card>\n    );\n  }\n\n  // BUG FIX: Ab !Array.isArray check kar rahe hain\n  if (!Array.isArray(bookings)) {\n     return (\n        <Card>\n            <CardHeader>\n                <CardTitle>My Bookings</CardTitle>\n            </CardHeader>\n            <CardContent>\n                 <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n                    <h3 className=\"text-xl font-semibold text-destructive\">Error Loading Bookings</h3>\n                    <p className=\"text-muted-foreground mt-2\">\n                    Could not fetch bookings. Please try refreshing.\n                    </p>\n                </div>\n            </CardContent>\n        </Card>\n     )\n  }\n\n  return (\n    <Tabs defaultValue=\"new\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"new\">\n                New ({newBookings.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"active\">\n                Active ({activeBookings.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"completed\">\n                Completed ({completedBookings.length})\n            </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"new\" className=\"mt-6\">\n            <BookingList \n                bookings={newBookings} \n                emptyMessage=\"You have no new booking requests.\"\n                mutations={{ updateBookingStatusMutation }}\n            />\n        </TabsContent>\n\n        <TabsContent value=\"active\" className=\"mt-6\">\n             <BookingList \n                bookings={activeBookings} \n                emptyMessage=\"You have no active jobs.\"\n                mutations={{ updateBookingStatusMutation }}\n            />\n        </TabsContent>\n\n        <TabsContent value=\"completed\" className=\"mt-6\">\n             <BookingList \n                bookings={completedBookings} \n                emptyMessage=\"You have no completed or declined jobs.\"\n                mutations={{ updateBookingStatusMutation }}\n            />\n        </TabsContent>\n    </Tabs>\n  );\n};\n\n// Helper function for badge colors\nconst getBadgeColor = (status: string) => {\n  switch (status) {\n    case \"pending\":\n      return \"secondary\";\n    case \"accepted\":\n    case \"in_progress\":\n      return \"default\";\n    case \"awaiting_otp\":\n    case \"awaiting_billing\":\n      return \"outline\";\n    case \"pending_payment\":\n      return \"outline\";\n    case \"declined\":\n    case \"cancelled\":\n      return \"destructive\";\n    default:\n      return \"secondary\";\n  }\n};\n\n// --- NAYA HELPER COMPONENT: BOOKING LIST ---\nconst BookingList: React.FC<{\n    bookings: FullBooking[];\n    emptyMessage: string;\n    mutations: {\n        updateBookingStatusMutation: any;\n    }\n}> = ({ bookings, emptyMessage, mutations }) => {\n\n    if (bookings.length === 0) {\n        return (\n             <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n                <h3 className=\"text-xl font-semibold\">{emptyMessage}</h3>\n                <p className=\"text-muted-foreground mt-2\">\n                This tab will update automatically.\n                </p>\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            {bookings.map((booking) => (\n              <Card key={booking.id} className=\"shadow-md\">\n                <CardHeader>\n                  <CardTitle className=\"flex justify-between items-center\">\n                    <span>Booking ID: ...{booking.id.slice(-6)}</span>\n                     <Badge \n                        variant={booking.status === 'completed' ? 'default' : getBadgeColor(booking.status || 'pending')}\n                        className={booking.status === 'completed' ? 'bg-green-600' : ''}\n                    >\n                      {booking.status?.replace(\"_\", \" \").toUpperCase()}\n                    </Badge>\n                  </CardTitle>\n                  <CardDescription>\n                    Customer: {booking.user.username} | Phone:{\" \"}\n                    {booking.user.phone}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-1\">\n                  <p>\n                    <strong>Address:</strong> {booking.userAddress}\n                  </p>\n                  <p>\n                    <strong>Scheduled:</strong>{\" \"}\n                    {booking.scheduledAt\n                      ? new Date(booking.scheduledAt).toLocaleString(\"en-IN\")\n                      : \"ASAP\"}\n                  </p>\n                  {booking.isUrgent && <Badge variant=\"destructive\">URGENT</Badge>}\n                  {booking.notes && (\n                    <p className=\"pt-2\">\n                      <strong>Notes:</strong> {booking.notes}\n                    </p>\n                  )}\n                </CardContent>\n                <CardFooter className=\"flex justify-end gap-2\">\n                  <ProviderBookingActions\n                    booking={booking}\n                    mutations={mutations}\n                  />\n                </CardFooter>\n              </Card>\n            ))}\n        </div>\n    )\n}\n\n// --- NAYA HELPER COMPONENT: BOOKING ACTIONS (SAARA LOGIC YAHAN HAI) ---\nconst ProviderBookingActions: React.FC<{\n  booking: FullBooking;\n  mutations: { updateBookingStatusMutation: any; };\n}> = ({ booking, mutations }) => {\n  const { updateBookingStatusMutation } = mutations;\n  const [otp, setOtp] = useState(\"\");\n  const [isBillOpen, setIsBillOpen] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // --- Saare mutations (API calls) ---\n  const generateOtpMutation = useMutation({\n    mutationFn: (bookingId: string) =>\n      api.post(`/bookings/${bookingId}/generate-otp`),\n    onSuccess: () => {\n      toast({\n        title: \"OTP Sent\",\n        description: \"OTP has been sent to the customer's phone.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"providerBookings\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"OTP Error\",\n        description: error.response?.data?.message || \"Failed to send OTP.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const verifyOtpMutation = useMutation({\n    mutationFn: (data: { bookingId: string, otp: string }) =>\n      api.post(`/bookings/${data.bookingId}/verify-otp`, { otp: data.otp }),\n    onSuccess: () => {\n      toast({\n        title: \"OTP Verified!\",\n        description: \"Please create the final bill for the customer.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"providerBookings\"] });\n      setIsBillOpen(true); // OTP Sahi hone par bill modal kholo\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Invalid OTP\",\n        description: error.response?.data?.message || \"That OTP is incorrect.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const createInvoiceMutation = useMutation({\n    mutationFn: (data: BillFormData) =>\n      api.post(`/bookings/${booking.id}/create-invoice`, data),\n    onSuccess: () => {\n      toast({\n        title: \"Bill Created!\",\n        description: \"Waiting for customer to complete payment.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"providerBookings\"] });\n      setIsBillOpen(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Billing Error\",\n        description:\n          error.response?.data?.message || \"Failed to create bill.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  // --- Mutations khatam ---\n\n  // --- Action Handlers ---\n  const handleAccept = () => {\n    updateBookingStatusMutation.mutate({ bookingId: booking.id, action: \"accept\" });\n  };\n  const handleDecline = () => {\n    updateBookingStatusMutation.mutate({ bookingId: booking.id, action: \"decline\" });\n  };\n  const handleStartJob = () => {\n    updateBookingStatusMutation.mutate({ bookingId: booking.id, action: \"start-job\" });\n  };\n  const handleJobDone = () => {\n    generateOtpMutation.mutate(booking.id);\n  };\n  const handleVerifyOtp = () => {\n    if (otp.length === 6) {\n      verifyOtpMutation.mutate({ bookingId: booking.id, otp });\n    }\n  };\n  const handleBillSubmit = (data: BillFormData) => {\n    createInvoiceMutation.mutate(data);\n  };\n  // --- Handlers khatam ---\n\n\n  // --- Logic ke hisaab se button dikhao ---\n  if (booking.status === \"pending\") {\n    return (\n      <>\n        <Button \n            variant=\"destructive\" \n            onClick={handleDecline}\n            disabled={updateBookingStatusMutation.isPending}\n        >\n          <X className=\"mr-2 h-4 w-4\" /> Decline\n        </Button>\n        <Button \n            onClick={handleAccept} \n            className=\"bg-green-600 hover:bg-green-700\"\n            disabled={updateBookingStatusMutation.isPending}\n        >\n          <Check className=\"mr-2 h-4 w-4\" /> Accept\n        </Button>\n      </>\n    );\n  }\n\n  if (booking.status === \"accepted\") {\n    return (\n      <Button \n        onClick={handleStartJob} \n        className=\"bg-blue-600 hover:bg-blue-700\"\n        disabled={updateBookingStatusMutation.isPending}\n    >\n        <Play className=\"mr-2 h-4 w-4\" /> Start Job\n      </Button>\n    );\n  }\n\n  if (booking.status === \"in_progress\") {\n    return (\n      <Button \n        onClick={handleJobDone} \n        className=\"bg-green-600 hover:bg-green-700\"\n        disabled={generateOtpMutation.isPending}\n    >\n        {generateOtpMutation.isPending ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\"/> : <ClipboardCheck className=\"mr-2 h-4 w-4\" />}\n        Job Done (Get OTP)\n      </Button>\n    );\n  }\n\n  if (booking.status === \"awaiting_otp\") {\n    return (\n      <Dialog>\n        <DialogTrigger asChild>\n          <Button className=\"bg-green-600 hover:bg-green-700\">\n            <ClipboardCheck className=\"mr-2 h-4 w-4\" /> Verify OTP\n          </Button>\n        </DialogTrigger>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Verify Service OTP</DialogTitle>\n            <DialogDescription>\n              Please ask the customer ({booking.user.username}) for the 6-digit\n              OTP sent to their phone.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-center py-4\">\n            <InputOTP maxLength={6} value={otp} onChange={setOtp}>\n              <InputOTPGroup>\n                <InputOTPSlot index={0} />\n                <InputOTPSlot index={1} />\n                <InputOTPSlot index={2} />\n                <InputOTPSlot index={3} />\n                <InputOTPSlot index={4} />\n                <InputOTPSlot index={5} />\n              </InputOTPGroup>\n            </InputOTP>\n          </div>\n          <DialogFooter>\n            <Button\n              onClick={handleVerifyOtp}\n              disabled={otp.length !== 6 || verifyOtpMutation.isPending}\n            >\n              {verifyOtpMutation.isPending && (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              )}\n              Verify\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n\n  if (booking.status === \"awaiting_billing\") {\n    return (\n      <>\n        <Button\n          onClick={() => setIsBillOpen(true)}\n          className=\"bg-green-600 hover:bg-green-700\"\n        >\n          <FileText className=\"mr-2 h-4 w-4\" /> Create Final Bill\n        </Button>\n        <CreateBillDialog\n          isOpen={isBillOpen}\n          onOpenChange={setIsBillOpen}\n          onSubmit={handleBillSubmit}\n          isLoading={createInvoiceMutation.isPending}\n        />\n      </>\n    );\n  }\n\n  if (booking.status === \"pending_payment\") {\n    return (\n       <Badge variant=\"secondary\" className=\"p-2 text-base\">\n         <DollarSign className=\"mr-2 h-4 w-4\" />\n         Waiting for Customer Payment\n       </Badge>\n    )\n  }\n\n  if (booking.status === \"completed\") {\n    // TODO: \"View Invoice\" ka button bana sakte hain\n    return null;\n  }\n\n  if (booking.status === \"declined\" || booking.status === \"cancelled\") {\n    return null; // Koi action nahi\n  }\n\n  return null; // Fallback\n};\n\n// --- NAYA HELPER COMPONENT: CREATE BILL DIALOG (with form) ---\nconst CreateBillDialog: React.FC<{\n  isOpen: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSubmit: (data: BillFormData) => void;\n  isLoading: boolean;\n}> = ({ isOpen, onOpenChange, onSubmit, isLoading }) => {\n  const form = useForm<BillFormData>({\n    resolver: zodResolver(billFormSchema),\n    defaultValues: {\n      spareParts: [],\n      serviceCharge: undefined, // 0 ki jagah undefined\n    },\n  });\n\n  const { fields, append, remove } = useFieldArray({\n      control: form.control,\n      name: \"spareParts\"\n  });\n\n  const watchSpareParts = form.watch(\"spareParts\");\n  const watchServiceCharge = form.watch(\"serviceCharge\");\n\n  const total =\n    (watchSpareParts?.reduce((acc, part) => acc + (Number(part.cost) || 0), 0) || 0) +\n    (Number(watchServiceCharge) || 0);\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[600px]\">\n        <DialogHeader>\n          <DialogTitle>Create Final Bill</DialogTitle>\n          <DialogDescription>\n            Enter service charges and any spare parts used for this job.\n          </DialogDescription>\n        </DialogHeader>\n        <Form {...form}>\n          <form\n            onSubmit={form.handleSubmit(onSubmit)}\n            className=\"space-y-4 max-h-[60vh] overflow-y-auto p-1\"\n          >\n            <FormField\n              control={form.control}\n              name=\"serviceCharge\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Service Charge (â‚¹)</FormLabel>\n                  <FormControl>\n                    <Input type=\"number\" placeholder=\"e.g., 350\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div>\n              <Label>Spare Parts Used (Optional)</Label>\n              <div className=\"space-y-2 mt-2\">\n                {fields.map((field, index) => (\n                  <div key={field.id} className=\"flex gap-2 items-start\">\n                    <FormField\n                      control={form.control}\n                      name={`spareParts.${index}.part`}\n                      render={({ field }) => (\n                        <FormItem className=\"flex-1\">\n                          <FormControl>\n                            <Input placeholder=\"Part Name\" {...field} />\n                          </FormControl>\n                           <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name={`spareParts.${index}.cost`}\n                      render={({ field }) => (\n                        <FormItem className=\"w-[120px]\">\n                          <FormControl>\n                            <Input\n                              type=\"number\"\n                              placeholder=\"Price (â‚¹)\"\n                              {...field}\n                            />\n                          </FormControl>\n                           <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <Button\n                      type=\"button\"\n                      variant=\"destructive\"\n                      size=\"icon\"\n                      onClick={() => remove(index)}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                ))}\n              </div>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"mt-2\"\n                onClick={() => append({ part: \"\", cost: 0 })}\n              >\n                <PlusCircle className=\"mr-2 h-4 w-4\" /> Add Part\n              </Button>\n            </div>\n\n            <div className=\"text-xl font-bold text-right pt-4\">\n              Total Bill: â‚¹{total.toFixed(2)}\n            </div>\n\n            <DialogFooter>\n              <DialogClose asChild>\n                 <Button type=\"button\" variant=\"outline\" disabled={isLoading}>Cancel</Button>\n              </DialogClose>\n              <Button type=\"submit\" disabled={isLoading}>\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                Generate Bill & Request Payment\n              </Button>\n            </DialogFooter>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\n// --- COMPONENT 3: SPECIALIZATIONS MANAGER (Waise ka waisa) ---\nconst SpecializationsManager: React.FC<{\n  providerProfile: ProviderProfileWithCategory;\n}> = ({ providerProfile }) => {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedSpecs, setSelectedSpecs] = useState<string[]>(\n    () => providerProfile.specializations || []\n  );\n\n  const { data: allProblems, isLoading: isLoadingProblems } = useQuery<\n    ServiceProblem[]\n  >({\n    queryKey: [\"serviceProblems\", providerProfile.category.slug],\n    queryFn: async () => {\n      const res = await api.get(\n        `/service-problems?category=${providerProfile.category.slug}`\n      );\n      return res.data;\n    },\n    enabled: !!providerProfile.category.slug,\n  });\n\n  const updateProfileMutation = useMutation({\n    mutationFn: (specializations: string[]) =>\n      api.patch(\"/provider/profile\", { specializations }),\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Your specializations have been updated.\",\n      });\n      queryClient.invalidateQueries({\n        queryKey: [\"providerProfile\", providerProfile.userId],\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.response?.data?.message || \"Failed to update.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCheckedChange = (\n    checked: boolean | \"indeterminate\",\n    specName: string\n  ) => {\n    setSelectedSpecs((prev) =>\n      checked ? [...prev, specName] : prev.filter((s) => s !== specName)\n    );\n  };\n\n  const handleSave = () => {\n    updateProfileMutation.mutate(selectedSpecs);\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>My Specializations</CardTitle>\n        <CardDescription>\n          Select the devices and services you are an expert in. This will be\n          shown to customers.\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        {isLoadingProblems ? (\n          <div className=\"flex justify-center py-10\">\n            <Loader2 className=\"mr-2 h-6 w-6 animate-spin\" /> Loading options...\n          </div>\n        ) : !allProblems || allProblems.length === 0 ? (\n          <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n            <h3 className=\"text-xl font-semibold\">No Service Problems Found</h3>\n            <p className=\"text-muted-foreground mt-2\">\n              (Admin needs to add problems for '{providerProfile.category.name}'\n              category)\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n              {allProblems.map((problem) => (\n                <div\n                  key={problem.id}\n                  className=\"flex items-center space-x-2 p-3 border rounded-md\"\n                >\n                  <Checkbox\n                    id={problem.id}\n                    checked={selectedSpecs.includes(problem.name)}\n                    onCheckedChange={(checked) =>\n                      handleCheckedChange(checked, problem.name)\n                    }\n                  />\n                  <Label\n                    htmlFor={problem.id}\n                    className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                  >\n                    {problem.name}\n                  </Label>\n                </div>\n              ))}\n            </div>\n            <Button\n              onClick={handleSave}\n              disabled={updateProfileMutation.isPending}\n            >\n              {updateProfileMutation.isPending ? (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              ) : (\n                <Save className=\"mr-2 h-4 w-4\" />\n              )}\n              Save Specializations\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\n// --- COMPONENT 4: PROFILE SETTINGS (Waise ka waisa) ---\nconst ProfileSettingsManager: React.FC<{\n  providerProfile: ProviderProfileWithCategory;\n  userId: string;\n}> = ({ providerProfile, userId }) => {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [profileFile, setProfileFile] = useState<File | null>(null);\n  const [galleryFiles, setGalleryFiles] = useState<FileList | null>(null);\n\n  // Profile Pic Upload Mutation\n  const profilePicMutation = useMutation({\n    mutationFn: (file: File) => {\n      const formData = new FormData();\n      formData.append(\"image\", file);\n      return api.patch(\"/provider/profile/image\", formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"Success\", description: \"Profile picture updated.\" });\n      queryClient.invalidateQueries({ queryKey: [\"providerProfile\", userId] });\n      setProfileFile(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Upload Failed\",\n        description: error.response?.data?.message || \"Failed to upload.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Gallery Images Upload Mutation\n  const galleryUploadMutation = useMutation({\n    mutationFn: (files: FileList) => {\n      const formData = new FormData();\n      for (let i = 0; i < files.length; i++) {\n        formData.append(\"images\", files[i]);\n      }\n      return api.post(\"/provider/profile/gallery\", formData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"Success\", description: \"Gallery images uploaded.\" });\n      queryClient.invalidateQueries({ queryKey: [\"providerProfile\", userId] });\n      setGalleryFiles(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Upload Failed\",\n        description: error.response?.data?.message || \"Failed to upload.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleProfileFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setProfileFile(e.target.files[0]);\n    }\n  };\n\n  const handleGalleryFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setGalleryFiles(e.target.files);\n    }\n  };\n\n  const handleProfileUpload = () => {\n    if (profileFile) {\n      profilePicMutation.mutate(profileFile);\n    }\n  };\n\n  const handleGalleryUpload = () => {\n    if (galleryFiles) {\n      galleryUploadMutation.mutate(galleryFiles);\n    }\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n      <Card>\n        <CardHeader>\n          <CardTitle>Profile Picture</CardTitle>\n          <CardDescription>\n            Upload a clear photo of yourself or your logo.\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"w-40 h-40 rounded-full overflow-hidden bg-muted mx-auto flex items-center justify-center\">\n            {providerProfile.profileImageUrl ? (\n              <img\n                src={providerProfile.profileImageUrl}\n                alt=\"Profile\"\n                className=\"w-full h-full object-cover\"\n              />\n            ) : (\n              <ImageIcon className=\"w-16 h-16 text-muted-foreground\" />\n            )}\n          </div>\n          <Input\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={handleProfileFileChange}\n            disabled={profilePicMutation.isPending}\n          />\n        </CardContent>\n        <CardFooter>\n          <Button\n            onClick={handleProfileUpload}\n            disabled={!profileFile || profilePicMutation.isPending}\n          >\n            {profilePicMutation.isPending ? (\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n            ) : (\n              <Upload className=\"mr-2 h-4 w-4\" />\n            )}\n            Upload Picture\n          </Button>\n        </CardFooter>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Gallery Images</CardTitle>\n          <CardDescription>\n            Showcase your work (e.g., past projects, food items).\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-3 gap-2 min-h-[80px]\">\n            {providerProfile.galleryImages?.map((url, index) => (\n              <div\n                key={index}\n                className=\"relative aspect-square bg-muted rounded-md overflow-hidden\"\n              >\n                <img\n                  src={url}\n                  alt={`Gallery item ${index + 1}`}\n                  className=\"w-full h-full object-cover\"\n                />\n              </div>\n            ))}\n          </div>\n          <Input\n            type=\"file\"\n            accept=\"image/*\"\n            multiple\n            onChange={handleGalleryFileChange}\n            disabled={galleryUploadMutation.isPending}\n          />\n        </CardContent>\n        <CardFooter>\n          <Button\n            onClick={handleGalleryUpload}\n            disabled={!galleryFiles || galleryUploadMutation.isPending}\n          >\n            {galleryUploadMutation.isPending ? (\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n            ) : (\n              <Upload className=\"mr-2 h-4 w-4\" />\n            )}\n            Upload Gallery\n          </Button>\n        </CardFooter>\n      </Card>\n    </div>\n  );\n};\n\n// --- Category Lists ---\nconst menuBasedCategories = [\n  \"beauty\",\n  \"cake-shop\",\n  \"street-food\",\n  \"restaurants\",\n  \"grocery\",\n];\nconst bookingBasedCategories = [\"electrician\", \"plumber\"];\n\n// --- MAIN DASHBOARD COMPONENT (Ab yeh smart hai) ---\nconst ProviderDashboard: React.FC = () => {\n  const { user, isLoading: isAuthLoading } = useAuth();\n\n  const {\n    data: providerProfile,\n    isLoading: isLoadingProfile,\n    isError: isErrorProfile,\n  } = useQuery<ProviderProfileWithCategory>({\n    queryKey: [\"providerProfile\", user?.id],\n    queryFn: async () => {\n      const res = await api.get(\"/provider/profile\");\n      return res.data;\n    },\n    enabled: !!user?.id,\n    retry: false,\n  });\n\n  // --- LOADING/ERROR STATES ---\n  if (isAuthLoading || (!!user && isLoadingProfile)) {\n    return (\n      <div className=\"flex justify-center items-center h-screen\">\n        <Loader2 className=\"mr-2 h-8 w-8 animate-spin\" /> Loading your\n        profile...\n      </div>\n    );\n  }\n\n  if (!user) {\n    return <Redirect to=\"/login\" />;\n  }\n\n  if (user.role !== \"provider\") {\n     return (\n      <div className=\"container mx-auto py-10 text-center text-muted-foreground\">\n         <AlertTriangle className=\"mx-auto h-12 w-12 text-destructive\" />\n        <h2 className=\"text-2xl font-semibold text-foreground mt-4\">Access Denied</h2>\n        <p className=\"mt-2\">You must be a provider to view this page.</p>\n        <Button asChild className=\"mt-4\">\n          <Link to=\"/\">Go Home</Link>\n        </Button>\n      </div>\n    );\n  }\n\n  if (isErrorProfile || !providerProfile) {\n    return (\n      <div className=\"container mx-auto py-10 text-center text-muted-foreground\">\n        <AlertTriangle className=\"mx-auto h-12 w-12 text-destructive\" />\n        <h2 className=\"text-2xl font-semibold text-foreground mt-4\">\n          Provider Profile Not Found\n        </h2>\n        <p className=\"mt-2\">\n          It seems you haven't completed your provider onboarding yet.\n        </p>\n        <Button asChild className=\"mt-4\">\n          <Link to=\"/provider-onboarding\">Complete Your Profile</Link>\n        </Button>\n      </div>\n    );\n  }\n  // --- LOADING/ERROR STATES KHATAM ---\n\n  const providerType = () => {\n    if (!providerProfile || !providerProfile.category) {\n        return 'unknown';\n    }\n    const slug = providerProfile.category.slug;\n    if (menuBasedCategories.includes(slug)) return \"menu\";\n    if (bookingBasedCategories.includes(slug)) return \"booking\";\n    return \"unknown\";\n  };\n\n  const type = providerType();\n\n  const getTabs = () => {\n    // Basic tabs\n    const tabs = [\n      { value: \"profile\", label: \"Profile Settings\" },\n    ];\n\n    // Kaam ke hisaab se tabs add karo\n    if (type === \"menu\") {\n      tabs.unshift({ value: \"menu\", label: \"Menu / Services\" });\n      tabs.unshift({ value: \"bookings\", label: \"Bookings\" }); // Menu waalon ko bhi booking aa sakti hai\n    }\n    if (type === \"booking\") {\n      tabs.push({ value: \"specializations\", label: \"My Specializations\" });\n      tabs.unshift({ value: \"bookings\", label: \"Bookings\" });\n    }\n    return tabs;\n  };\n\n  const tabs = getTabs();\n  const defaultTab = \"bookings\"; // Sabse important tab\n\n  return (\n    <div className=\"container mx-auto py-8\">\n      <h1 className=\"text-3xl font-bold mb-6\">\n        Welcome, {providerProfile.businessName}!\n      </h1>\n\n      <Tabs defaultValue={defaultTab} className=\"w-full\">\n        <TabsList className={`grid w-full grid-cols-${tabs.length}`}>\n          {tabs.map((tab) => (\n            <TabsTrigger key={tab.value} value={tab.value}>\n              {tab.label}\n            </TabsTrigger>\n          ))}\n        </TabsList>\n\n        <TabsContent value=\"bookings\" className=\"mt-6\">\n          <BookingsManager providerProfile={providerProfile} />\n        </TabsContent>\n\n        <TabsContent value=\"menu\" className=\"mt-6\">\n          {type === \"menu\" ? (\n            <MenuItemsManager providerProfile={providerProfile} />\n          ) : null}\n        </TabsContent>\n\n        <TabsContent value=\"specializations\" className=\"mt-6\">\n          {type === \"booking\" ? (\n            <SpecializationsManager providerProfile={providerProfile} />\n          ) : null}\n        </TabsContent>\n\n        <TabsContent value=\"profile\" className=\"mt-6\">\n          <ProfileSettingsManager\n            providerProfile={providerProfile}\n            userId={user!.id}\n          />\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n};\n\nexport default ProviderDashboard;","size_bytes":42841},"client/src/pages/my-bookings.tsx":{"content":"// client/src/pages/my-bookings.tsx (UPDATED & COMPLETE)\n\nimport { useQuery, useMutation, useQueryClient } // <-- ADD KIYA GAYA\nfrom \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { format } from \"date-fns\";\nimport { \n  CheckCircle, \n  XCircle, \n  Clock, \n  Phone,\n  MapPin,\n  AlertCircle,\n  Loader2 // <-- ADD KIYA GAYA\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\"; // <-- ADD KIYA GAYA\nimport api from \"@/lib/api\"; // <-- ADD KIYA GAYA (Assuming tumhara api client yahaan hai)\n\nexport default function MyBookings() {\n  const { user } = useAuth();\n  const userId = user?.id;\n\n  // --- YEH SAB ADD KIYA GAYA ---\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n\n  // API se data fetch karne ka logic (assuming queryKey hi endpoint hai tumhare setup mein)\n  const { data: bookings, isLoading } = useQuery({\n    queryKey: [\"/api/bookings/user\", userId],\n    queryFn: async () => { // Maine queryFn add kar diya hai best practice ke liye\n      if (!userId) return [];\n      const res = await api.get(\"/api/bookings/user\"); // Assume karo yeh user-specific route hai\n      return res.data;\n    },\n    enabled: !!userId,\n  });\n\n  // Booking cancel karne ke liye mutation\n  const cancelBookingMutation = useMutation({\n    mutationFn: (bookingId: string) => {\n      return api.patch(`/api/bookings/${bookingId}/cancel`);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Booking Cancelled\",\n        description: \"Your service request has been successfully cancelled.\",\n      });\n      // Bookings ki list ko refresh karo\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings/user\", userId] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Cancellation Failed\",\n        description: error.response?.data?.message || \"Could not cancel booking.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  // --- ADD KARNA KHATAM ---\n\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: any; icon: any; description: string }> = {\n      pending: { \n        label: \"Pending\", \n        variant: \"secondary\", \n        icon: Clock,\n        description: \"Waiting for provider to accept\" \n      },\n      accepted: { \n        label: \"Accepted\", \n        variant: \"default\", \n        icon: CheckCircle,\n        description: \"Provider accepted your request\" \n      },\n      declined: { \n        label: \"Declined\", \n        variant: \"destructive\", \n        icon: XCircle,\n        description: \"Provider declined this request\" \n      },\n      completed: { \n        label: \"Completed\", \n        variant: \"outline\", \n        icon: CheckCircle,\n        description: \"Service completed\" \n      },\n      // --- YEH NAYA STATUS ADD KIYA GAYA ---\n      cancelled: { \n        label: \"Cancelled\", \n        variant: \"destructive\", \n        icon: XCircle,\n        description: \"You cancelled this request\" \n      },\n    };\n\n    const config = statusConfig[status] || statusConfig.pending;\n    const Icon = config.icon;\n\n    return (\n      <div>\n        <Badge variant={config.variant} className=\"flex items-center gap-1 w-fit\">\n          <Icon className=\"h-3 w-3\" />\n          {config.label}\n        </Badge>\n        <p className=\"text-xs text-muted-foreground mt-1\">{config.description}</p>\n      </div>\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"py-16 bg-background\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <p className=\"text-center text-muted-foreground\">Loading your bookings...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-16 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold mb-2\">My Bookings</h2>\n          <p className=\"text-muted-foreground\">\n            Track the status of your service requests\n          </p>\n        </div>\n\n        {!Array.isArray(bookings) || bookings.length === 0 ? (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n              <p className=\"text-muted-foreground\">You haven't made any bookings yet</p>\n              <Button className=\"mt-4\" onClick={() => window.location.href = '/electrician'}>\n                Book a Service\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 gap-4\">\n            {bookings.map((booking: any) => (\n              <Card \n                key={booking.id}\n                className={\n                  booking.status === \"accepted\" ? \"border-l-4 border-l-green-500\" :\n                  booking.status === \"declined\" ? \"border-l-4 border-l-red-500\" :\n                  booking.status === \"cancelled\" ? \"border-l-4 border-l-red-500\" : // <-- ADD KIYA GAYA\n                  booking.status === \"pending\" ? \"border-l-4 border-l-yellow-500\" : \"\"\n                }\n              >\n                <CardHeader>\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg mb-2\">\n                        {booking.problem?.name || \"Service Request\"}\n                      </CardTitle>\n                      <p className=\"text-sm text-muted-foreground mb-3\">\n                        {booking.provider?.businessName || \"Provider\"}\n                      </p>\n                      <div className=\"space-y-2 text-sm text-muted-foreground\">\n                        <div className=\"flex items-center gap-2\">\n                          <Clock className=\"h-4 w-4\" />\n                          <span>\n                            {booking.scheduledAt \n                              ? format(new Date(booking.scheduledAt), \"EEEE, MMMM d, yyyy\")\n                              : \"Not scheduled\"}\n                          </span>\n                        </div>\n                        {booking.preferredTimeSlots && booking.preferredTimeSlots.length > 0 && (\n                          <div className=\"flex items-center gap-2\">\n                            <Clock className=\"h-4 w-4\" />\n                            <span>Preferred time: {booking.preferredTimeSlots[0]}</span>\n                          </div>\n                        )}\n                        <div className=\"flex items-start gap-2\">\n                          <MapPin className=\"h-4 w-4 mt-0.5\" />\n                          <span>{booking.userAddress}</span>\n                        </div>\n                      </div>\n\n                      {booking.notes && (\n                        <div className=\"mt-3 p-3 bg-muted rounded-md\">\n                          <p className=\"text-sm font-medium mb-1\">Your notes:</p>\n                          <p className=\"text-sm\">{booking.notes}</p>\n                        </div>\n                      )}\n\n                      {booking.status === \"accepted\" && (\n                        <div className=\"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\">\n                          <p className=\"text-sm font-medium text-green-900 dark:text-green-100 mb-2\">\n                            âœ“ Booking Confirmed\n                          </p>\n                          <p className=\"text-sm text-green-700 dark:text-green-300\">\n                            The provider will contact you soon on {booking.userPhone}\n                          </p>\n                        </div>\n                      )}\n\n                      {booking.status === \"declined\" && (\n                        <div className=\"mt-4 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg\">\n                          <p className=\"text-sm font-medium text-red-900 dark:text-red-100 mb-2\">\n                            âœ— Booking Declined\n                          </p>\n                          <p className=\"text-sm text-red-700 dark:text-red-300\">\n                            Unfortunately, the provider couldn't accept this request. \n                            Please try booking with another provider.\n                          </p>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\" \n                            className=\"mt-3\"\n                            onClick={() => window.location.href = '/electrician'}\n                          >\n                            Find Another Provider\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"text-right w-[150px] flex-shrink-0\">\n                      {getStatusBadge(booking.status)}\n\n                      {/* --- YEH POORA BUTTON BLOCK ADD KIYA GAYA --- */}\n                      {booking.status === 'pending' && (\n                        <Button\n                          variant=\"destructive\"\n                          size=\"sm\"\n                          className=\"mt-3 w-full\"\n                          onClick={() => cancelBookingMutation.mutate(booking.id)}\n                          disabled={cancelBookingMutation.isPending && cancelBookingMutation.variables === booking.id}\n                        >\n                          {cancelBookingMutation.isPending && cancelBookingMutation.variables === booking.id ? (\n                            <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                          ) : (\n                            \"Cancel Booking\"\n                          )}\n                        </Button>\n                      )}\n                      {/* --- ADD KARNA KHATAM --- */}\n\n                    </div>\n                  </div>\n                </CardHeader>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":10039},"client/src/components/booking-slot-form.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { CalendarIcon, Clock, Loader2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst timeSlots = [\n  \"09:00 AM\", \"10:00 AM\", \"11:00 AM\", \"12:00 PM\",\n  \"01:00 PM\", \"02:00 PM\", \"03:00 PM\", \"04:00 PM\",\n  \"05:00 PM\", \"06:00 PM\", \"07:00 PM\", \"08:00 PM\"\n];\n\nconst bookingSchema = z.object({\n  userPhone: z.string()\n    .min(10, \"Phone number must be at least 10 digits\")\n    .regex(/^[+]?[\\d\\s()-]+$/, \"Please enter a valid phone number with country code (e.g., +1234567890)\"),\n  userAddress: z.string().min(5, \"Address is required\"),\n  scheduledDate: z.date({\n    required_error: \"Please select a date\",\n  }),\n  preferredTimeSlot: z.string().min(1, \"Please select a time slot\"),\n  notes: z.string().optional(),\n});\n\ntype BookingFormValues = z.infer<typeof bookingSchema>;\n\ninterface BookingSlotFormProps {\n  providerId: string;\n  problemId: string;\n  problemName: string;\n  onSuccess?: () => void;\n}\n\nexport default function BookingSlotForm({\n  providerId,\n  problemId,\n  problemName,\n  onSuccess,\n}: BookingSlotFormProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { user, isAuthenticated } = useAuth();\n  const [, setLocation] = useLocation();\n\n  const form = useForm<BookingFormValues>({\n    resolver: zodResolver(bookingSchema),\n    defaultValues: {\n      userPhone: user?.phone || \"\",\n      userAddress: \"\",\n      notes: \"\",\n    },\n  });\n\n  const createBookingMutation = useMutation({\n    mutationFn: async (data: BookingFormValues) => {\n      const bookingData = {\n        userId: user?.id || \"\",\n        providerId,\n        serviceType: \"electrician\",\n        problemId,\n        scheduledAt: data.scheduledDate.toISOString(),\n        preferredTimeSlots: [data.preferredTimeSlot],\n        userPhone: data.userPhone,\n        userAddress: data.userAddress,\n        notes: data.notes,\n        status: \"pending\",\n      };\n\n      const response = await apiRequest(\"POST\", \"/api/bookings\", bookingData);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Booking Successful!\",\n        description: \"Your service request has been sent. The technician will contact you soon.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/customer/my-bookings\"] });\n      form.reset();\n      onSuccess?.();\n      // Redirect to My Bookings page\n      setLocation(\"/my-bookings\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Booking Failed\",\n        description: error.message || \"Something went wrong. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: BookingFormValues) => {\n    if (!isAuthenticated) {\n      toast({\n        title: \"Login Required\",\n        description: \"Please log in to book a service.\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/login\");\n      return;\n    }\n    createBookingMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-primary/10 p-4 rounded-lg\">\n        <p className=\"text-sm font-medium\">Selected Problem:</p>\n        <p className=\"text-lg font-semibold\">{problemName}</p>\n      </div>\n\n      <Form {...form}>\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n          {/* Date Selection */}\n          <FormField\n            control={form.control}\n            name=\"scheduledDate\"\n            render={({ field }) => (\n              <FormItem className=\"flex flex-col\">\n                <FormLabel>Select Date</FormLabel>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <FormControl>\n                      <Button\n                        variant=\"outline\"\n                        className={cn(\n                          \"w-full pl-3 text-left font-normal\",\n                          !field.value && \"text-muted-foreground\"\n                        )}\n                        data-testid=\"button-select-date\"\n                      >\n                        {field.value ? (\n                          format(field.value, \"PPP\")\n                        ) : (\n                          <span>Pick a date</span>\n                        )}\n                        <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\n                      </Button>\n                    </FormControl>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={field.value}\n                      onSelect={field.onChange}\n                      disabled={(date) =>\n                        date < new Date() || date > new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)\n                      }\n                      initialFocus\n                    />\n                  </PopoverContent>\n                </Popover>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          {/* Time Slot Selection */}\n          <FormField\n            control={form.control}\n            name=\"preferredTimeSlot\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"flex items-center gap-2\">\n                  <Clock className=\"h-4 w-4\" />\n                  Preferred Time Slot\n                </FormLabel>\n                <div className=\"grid grid-cols-3 sm:grid-cols-4 gap-2\">\n                  {timeSlots.map((slot) => (\n                    <Button\n                      key={slot}\n                      type=\"button\"\n                      variant={field.value === slot ? \"default\" : \"outline\"}\n                      size=\"sm\"\n                      onClick={() => field.onChange(slot)}\n                      data-testid={`button-timeslot-${slot.replace(/\\s/g, '-')}`}\n                    >\n                      {slot}\n                    </Button>\n                  ))}\n                </div>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          {/* Phone Number */}\n          <FormField\n            control={form.control}\n            name=\"userPhone\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Your Phone Number (with Country Code)</FormLabel>\n                <FormControl>\n                  <Input\n                    placeholder=\"+91 98765 43210\"\n                    {...field}\n                    data-testid=\"input-phone\"\n                  />\n                </FormControl>\n                <p className=\"text-sm text-muted-foreground\">\n                  Include country code (e.g., +91, +1)\n                </p>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          {/* Address */}\n          <FormField\n            control={form.control}\n            name=\"userAddress\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Your Complete Address</FormLabel>\n                <FormControl>\n                  <Textarea\n                    placeholder=\"Enter your full address...\"\n                    {...field}\n                    data-testid=\"input-address\"\n                  />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          {/* Additional Notes */}\n          <FormField\n            control={form.control}\n            name=\"notes\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>Additional Notes (Optional)</FormLabel>\n                <FormControl>\n                  <Textarea\n                    placeholder=\"Any additional details about the problem...\"\n                    {...field}\n                    data-testid=\"input-notes\"\n                  />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          <Button\n            type=\"submit\"\n            className=\"w-full\"\n            disabled={createBookingMutation.isPending}\n            data-testid=\"button-submit-booking\"\n          >\n            {createBookingMutation.isPending && (\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n            )}\n            {createBookingMutation.isPending ? \"Submitting...\" : \"Book Service Slot\"}\n          </Button>\n        </form>\n      </Form>\n    </div>\n  );\n}\n","size_bytes":9238},"server/twilio-client.ts":{"content":"import twilio from 'twilio';\n\nlet connectionSettings: any;\n\nasync function getCredentials() {\n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=twilio',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  if (!connectionSettings || (!connectionSettings.settings.account_sid || !connectionSettings.settings.api_key || !connectionSettings.settings.api_key_secret)) {\n    throw new Error('Twilio not connected');\n  }\n  return {\n    accountSid: connectionSettings.settings.account_sid,\n    apiKey: connectionSettings.settings.api_key,\n    apiKeySecret: connectionSettings.settings.api_key_secret,\n    phoneNumber: connectionSettings.settings.phone_number\n  };\n}\n\nexport async function getTwilioClient() {\n  const { accountSid, apiKey, apiKeySecret } = await getCredentials();\n  return twilio(apiKey, apiKeySecret, {\n  accountSid: accountSid\n  });\n}\n\nexport async function getTwilioFromPhoneNumber() {\n  const { phoneNumber } = await getCredentials();\n  return phoneNumber;\n}\n\nexport async function sendBookingNotification(\n  to: string,\n  status: 'accepted' | 'declined',\n  providerName: string,\n  scheduledDate?: string\n) {\n  try {\n    const client = await getTwilioClient();\n    const fromNumber = await getTwilioFromPhoneNumber();\n\n    const message = status === 'accepted'\n      ? `Good news! ${providerName} has accepted your booking${scheduledDate ? ` for ${scheduledDate}` : ''}. They will contact you soon.`\n      : `${providerName} has declined your booking request. Please try booking with another provider.`;\n\n    const result = await client.messages.create({\n      body: message,\n      from: fromNumber,\n      to: to\n    });\n\n    return result;\n  } catch (error) {\n    console.error('Error sending SMS:', error);\n    throw error;\n  }\n}\n\n// --- YEH NAYA FUNCTION ADD KIYA HAI ---\n/**\n * Customer ko Service OTP SMS se bhejta hai\n */\nexport async function sendOtpNotification(\n  to: string,\n  otp: string\n) {\n  try {\n    const client = await getTwilioClient();\n    const fromNumber = await getTwilioFromPhoneNumber();\n\n    const message = `Your service OTP for Shirur Express is ${otp}. Please share this with your technician to complete the service.`;\n\n    const result = await client.messages.create({\n      body: message,\n      from: fromNumber,\n      to: to\n    });\n\n    return result;\n  } catch (error) {\n    console.error('Error sending OTP SMS:', error);\n    throw error;\n  }\n}","size_bytes":2922},"client/src/pages/StreetFoodDetail.tsx":{"content":"import React from 'react';\nimport { useParams, Link } from 'wouter';\nimport { useQuery } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { ArrowLeft } from 'lucide-react';\n\n// Yeh function vendor ke details aur menu fetch karega\nconst fetchVendorDetails = async (vendorId: string) => {\n  // Provider ki details fetch karo\n  const providerRes = await fetch(`/api/service-providers/${vendorId}`);\n  if (!providerRes.ok) throw new Error('Vendor not found');\n  const provider = await providerRes.json();\n\n  // Us provider ke menu items fetch karo\n  const menuRes = await fetch(`/api/street-food-items?providerId=${vendorId}`);\n  if (!menuRes.ok) throw new Error('Menu not found');\n  const menuItems = await menuRes.json();\n\n  return { provider, menuItems };\n};\n\nexport default function StreetFoodDetail() {\n  const params = useParams();\n  const vendorId = params.vendorId;\n\n  const { data, isLoading, error } = useQuery({\n    queryKey: ['vendorDetails', vendorId],\n    queryFn: () => fetchVendorDetails(vendorId!),\n    enabled: !!vendorId, // Yeh tabhi run hoga jab vendorId ho\n  });\n\n  if (isLoading) {\n    return <div>Loading delicious food details...</div>;\n  }\n\n  if (error) {\n    return <div>Oops! Something went wrong: {error.message}</div>;\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-4 md:p-8\">\n      <Link href=\"/street-food\">\n        <Button variant=\"outline\" className=\"mb-6\">\n          <ArrowLeft className=\"h-4 w-4 mr-2\" />\n          Back to all vendors\n        </Button>\n      </Link>\n\n      {data?.provider && (\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-bold\">{data.provider.businessName}</h1>\n          <p className=\"text-lg text-muted-foreground mt-2\">{data.provider.description}</p>\n        </div>\n      )}\n\n      <div>\n        <h2 className=\"text-3xl font-bold border-b pb-2 mb-6\">Menu</h2>\n        {data?.menuItems && data.menuItems.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {data.menuItems.map((item: any) => (\n              <div key={item.id} className=\"border p-4 rounded-lg flex justify-between items-center\">\n                <div>\n                  <h3 className=\"text-xl font-semibold\">{item.name}</h3>\n                  <p className=\"text-sm text-muted-foreground\">{item.description}</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-lg font-bold\">â‚¹{item.price}</p>\n                  <Button size=\"sm\" className=\"mt-2\">Order</Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <p>No menu items found for this vendor.</p>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":2733},"client/src/pages/provider-onboarding.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n  FormDescription,\n} from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Briefcase, MapPin, CheckCircle } from \"lucide-react\";\n\nconst profileSchema = z.object({\n  businessName: z.string().min(2, \"Business name must be at least 2 characters\"),\n  categoryId: z.string().min(1, \"Please select a service category\"),\n  description: z.string().optional(),\n  experience: z.string().transform(Number),\n  address: z.string().min(5, \"Address is required\"),\n  latitude: z.string().optional().transform((val) => val ? Number(val) : undefined),\n  longitude: z.string().optional().transform((val) => val ? Number(val) : undefined),\n  specializations: z.string().optional(),\n});\n\ntype ProfileFormValues = z.infer<typeof profileSchema>;\n\nexport default function ProviderOnboarding() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const { data: categories, isLoading: categoriesLoading } = useQuery({\n    queryKey: [\"/api/service-categories\"],\n  });\n\n  const form = useForm<ProfileFormValues>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      businessName: \"\",\n      categoryId: \"\",\n      description: \"\",\n      experience: \"0\",\n      address: \"\",\n      latitude: \"\",\n      longitude: \"\",\n      specializations: \"\",\n    },\n  });\n\n  const createProfileMutation = useMutation({\n    mutationFn: async (data: ProfileFormValues) => {\n      const profileData = {\n        ...data,\n        specializations: data.specializations \n          ? data.specializations.split(',').map(s => s.trim()).filter(Boolean)\n          : [],\n      };\n      \n      const response = await apiRequest(\"POST\", \"/api/provider/profile\", profileData);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Profile Created!\",\n        description: \"Your service provider profile is now active.\",\n      });\n      setLocation(\"/provider/dashboard\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Profile Creation Failed\",\n        description: error.message || \"Could not create profile\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ProfileFormValues) => {\n    createProfileMutation.mutate(data);\n  };\n\n  if (categoriesLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p>Loading...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-2xl mx-auto\">\n        <Card>\n          <CardHeader className=\"space-y-1\">\n            <div className=\"flex items-center justify-center mb-4\">\n              <Briefcase className=\"h-10 w-10 text-primary\" />\n            </div>\n            <CardTitle className=\"text-2xl text-center\">Complete Your Provider Profile</CardTitle>\n            <CardDescription className=\"text-center\">\n              Tell us about your business to start receiving service requests\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                <FormField\n                  control={form.control}\n                  name=\"businessName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Business Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"e.g., Quick Fix Electricals\"\n                          {...field}\n                          data-testid=\"input-business-name\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"categoryId\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Service Category</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-category\">\n                            <SelectValue placeholder=\"Select your service type\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {categories?.map((category: any) => (\n                            <SelectItem key={category.id} value={category.id}>\n                              {category.name}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Description (Optional)</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"Describe your services and expertise...\"\n                          className=\"resize-none\"\n                          {...field}\n                          data-testid=\"input-description\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        Tell customers about your experience and what makes you stand out\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"experience\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Years of Experience</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          min=\"0\"\n                          placeholder=\"e.g., 5\"\n                          {...field}\n                          data-testid=\"input-experience\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"address\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <MapPin className=\"h-4 w-4\" />\n                        Business Address\n                      </FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"Enter your business address\"\n                          className=\"resize-none\"\n                          {...field}\n                          data-testid=\"input-address\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"specializations\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Specializations (Optional)</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"e.g., AC Repair, Wiring, Installation (comma-separated)\"\n                          {...field}\n                          data-testid=\"input-specializations\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        List your areas of expertise, separated by commas\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"bg-muted p-4 rounded-lg\">\n                  <div className=\"flex items-start gap-3\">\n                    <CheckCircle className=\"h-5 w-5 text-primary mt-0.5\" />\n                    <div className=\"text-sm\">\n                      <p className=\"font-medium mb-1\">What happens next?</p>\n                      <ul className=\"list-disc list-inside text-muted-foreground space-y-1\">\n                        <li>Your profile will be visible to customers</li>\n                        <li>You'll start receiving booking requests</li>\n                        <li>You can manage bookings from your dashboard</li>\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={createProfileMutation.isPending}\n                  data-testid=\"button-create-profile\"\n                >\n                  {createProfileMutation.isPending ? \"Creating profile...\" : \"Create Profile & Get Started\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10116},"client/src/pages/OrderSuccess.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { CheckCircle2 } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function OrderSuccess() {\n  return (\n    <div className=\"max-w-2xl mx-auto py-16 px-4 text-center\">\n      <Card>\n        <CardContent className=\"p-8 md:p-12\">\n          <CheckCircle2 className=\"h-16 w-16 text-green-500 mx-auto mb-6 animate-pulse\" />\n          <h1 className=\"text-3xl md:text-4xl font-bold\">Order Placed Successfully!</h1>\n          <p className=\"text-muted-foreground mt-4 mb-8\">\n            Thank you for your order. You will receive a confirmation and delivery updates shortly.\n          </p>\n          <div className=\"flex justify-center gap-4\">\n            <Link href=\"/\">\n              <Button>Go to Homepage</Button>\n            </Link>\n            <Link href=\"/my-bookings\">\n              <Button variant=\"outline\">Track Your Order</Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":1055},"client/src/pages/signup.tsx":{"content":"// client/src/pages/signup.tsx (THE COMPLETE & FINAL CODE)\n\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\"; // useQueryClient import karo\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Network, User, Briefcase } from \"lucide-react\";\n\nconst signupSchema = z.object({\n  username: z.string().min(3, \"Username must be at least 3 characters\"),\n  email: z.string().email(\"Invalid email address\"),\n  phone: z.string().optional(),\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n  confirmPassword: z.string(),\n  role: z.enum([\"customer\", \"provider\"], {\n    required_error: \"Please select a role\",\n  }),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype SignupFormValues = z.infer<typeof signupSchema>;\n\nexport default function Signup() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient(); // queryClient ko initialize karo\n\n  const form = useForm<SignupFormValues>({\n    resolver: zodResolver(signupSchema),\n    defaultValues: {\n      username: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      role: \"customer\",\n    },\n  });\n\n  const signupMutation = useMutation({\n    mutationFn: (data: SignupFormValues) => {\n      const { confirmPassword, ...signupData } = data;\n      return apiRequest(\"POST\", \"/api/auth/signup\", signupData);\n    },\n    onSuccess: async (response) => { // Isko 'async' banao\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || \"Signup failed\");\n      }\n      const data = await response.json();\n\n      toast({\n        title: \"Account Created!\",\n        description: `Welcome to ServiceHub, ${data.user.username}!`,\n      });\n\n      // App ko force kar rahe hain ki pehle user ki details refresh kare.\n      await queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      await queryClient.refetchQueries({ queryKey: ['/api/auth/me'] });\n\n      // Ab jab app ko pata hai ki user logged in hai, tab redirect karo.\n      if (data.user.role === \"provider\") {\n        setLocation(\"/provider-onboarding\");\n      } else {\n        setLocation(\"/\");\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Signup Failed\",\n        description: error.message || \"Could not create account.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: SignupFormValues) => {\n    signupMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background py-12 px-4 sm:px-6 lg:px-8\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center justify-center mb-4\">\n            <Network className=\"h-10 w-10 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl text-center\">Create Account</CardTitle>\n          <CardDescription className=\"text-center\">\n            Join ServiceHub as a customer or service provider\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"role\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>I want to</FormLabel>\n                    <FormControl>\n                      <RadioGroup\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                        className=\"grid grid-cols-2 gap-4\"\n                      >\n                        <div>\n                          <RadioGroupItem\n                            value=\"customer\"\n                            id=\"customer\"\n                            className=\"peer sr-only\"\n                          />\n                          <label\n                            htmlFor=\"customer\"\n                            className=\"flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary [&:has([data-state=checked])]:border-primary cursor-pointer\"\n                            data-testid=\"role-customer\"\n                          >\n                            <User className=\"mb-3 h-6 w-6\" />\n                            <span className=\"text-sm font-medium\">Find Services</span>\n                          </label>\n                        </div>\n                        <div>\n                          <RadioGroupItem\n                            value=\"provider\"\n                            id=\"provider\"\n                            className=\"peer sr-only\"\n                          />\n                          <label\n                            htmlFor=\"provider\"\n                            className=\"flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary [&:has([data-state=checked])]:border-primary cursor-pointer\"\n                            data-testid=\"role-provider\"\n                          >\n                            <Briefcase className=\"mb-3 h-6 w-6\" />\n                            <span className=\"text-sm font-medium\">Provide Services</span>\n                          </label>\n                        </div>\n                      </RadioGroup>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"username\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Username</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"Choose a username\"\n                        {...field}\n                        data-testid=\"input-username\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"your@email.com\"\n                        {...field}\n                        data-testid=\"input-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"phone\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Phone (Optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"+91 98765 43210\"\n                        {...field}\n                        data-testid=\"input-phone\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Create a password\"\n                        {...field}\n                        data-testid=\"input-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Confirm Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Confirm your password\"\n                        {...field}\n                        data-testid=\"input-confirm-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={signupMutation.isPending}\n                data-testid=\"button-signup\"\n              >\n                {signupMutation.isPending ? \"Creating account...\" : \"Create Account\"}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"mt-6 text-center text-sm\">\n            <span className=\"text-muted-foreground\">Already have an account? </span>\n            <Button\n              variant=\"link\"\n              className=\"p-0 h-auto font-semibold\"\n              onClick={() => setLocation(\"/login\")}\n              data-testid=\"link-login\"\n            >\n              Sign in\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":10222},"client/src/pages/BeautyDetail.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation, useParams } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  ArrowLeft, Star, MapPin, Clock, Plus,\n  ChevronDown,\n} from \"lucide-react\";\nimport {\n  Select, \n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\n// --- BEAUTY ENCYCLOPEDIA DATA REFERENCE (MOCK MENU) ---\nconst NESTED_SERVICES = {\n  \"Hair Services\": [\n    { name: \"Haircut & Styling\", subCategories: [ \n        { name: \"Haircuts & Basic Styling\", items: [ { id: 'wcut', name: \"Women's Haircut\", price: 800, duration: 45, gender: 'Women' } ] },\n        { name: \"Hair Coloring\", items: [ { id: 'fcolor', name: \"Full Color\", price: 3500, duration: 120, type: 'Coloring' } ] },\n      ]\n    },\n    { name: \"Hair Treatments\", services: [ { id: 'keratin', name: \"Keratin Treatment\", price: 5500, duration: 180, gender: 'Unisex' } ] },\n  ],\n  \"Nail Services\": [\n    { name: \"Manicures\", services: [ { id: 'cmani', name: \"Classic Manicure\", price: 600, duration: 40 } ] },\n  ],\n  \"Skincare Services\": [\n    { name: \"Facials\", services: [ { id: 'basic', name: \"Basic Cleansing Facial\", price: 900, duration: 60 } ] },\n    { name: \"Hair Removal\", services: [ { id: 'wax', name: \"Waxing (Various Options)\", price: 500, duration: 30, gender: 'Women' } ] },\n  ],\n};\n\nconst MAIN_CATEGORIES = Object.keys(NESTED_SERVICES);\n\n// Mock Parlor List (Used to find the specific parlor)\nconst mockBeautyParlors = [\n    {\n        id: \"1\",\n        name: \"Glamour Beauty Lounge (Top Rated)\",\n        description: \"Expert services for hair, skin, and nails. Our priority is hygiene and quality.\",\n        image: \"https://images.unsplash.com/photo-1560066984-138dadb4c035?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=400\",\n        rating: 4.7, reviews: 234, address: \"Sector 22, Near Metro Station\", distance: \"1.2 km\",\n    },\n    {\n        id: \"2\",\n        name: \"Sparkle & Shine Studio\",\n        description: \"Modern salon with latest treatments.\",\n        image: \"https://images.unsplash.com/photo-1522335613345-cd4468f7f7c6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&h=400\",\n        rating: 4.5, reviews: 150, address: \"Sector 18, City Center\", distance: \"3.5 km\",\n    }\n];\n\n// Helper component to display a single service item\nconst ServiceItemCard = ({ parlorId, service, subCategoryName }: { parlorId: string, service: any, subCategoryName: string }) => {\n    const [, setLocation] = useLocation();\n\n    const handleBook = (service: any) => {\n        setLocation(`/book/beauty?parlorId=${parlorId}&serviceId=${service.id}`);\n    };\n\n    const isWomenOnly = service.gender === 'Women' && subCategoryName.includes('Hair Removal');\n\n    return (\n        <Card className=\"flex items-center justify-between p-4 hover:shadow-md transition-shadow\">\n            <div>\n                <p className=\"font-semibold text-base text-primary\">{service.name}</p>\n                <p className=\"text-xs text-muted-foreground flex items-center mt-1\">\n                    <Clock className=\"h-3 w-3 mr-1\" />\n                    {service.duration || 'Varies'} {service.duration !== 'Multi-day' && service.duration !== 'Full Day' && 'mins'}\n                    {isWomenOnly && <Badge variant=\"destructive\" className=\"ml-2 h-4 px-1\">Women Only</Badge>}\n                </p>\n            </div>\n            <div className=\"flex items-center space-x-3\">\n                <p className=\"font-bold text-lg\">â‚¹{service.price}</p>\n                <Button size=\"sm\" onClick={() => handleBook(service)}>\n                    Book\n                </Button>\n            </div>\n        </Card>\n    );\n};\n\n\nexport default function BeautyDetail() {\n    const [, setLocation] = useLocation();\n    const params = useParams();\n    const parlorId = params.parlorId as string;\n\n    const [selectedMainCat, setSelectedMainCat] = useState<string | null>(null);\n    const [selectedSubCat, setSelectedSubCat] = useState<string | null>(null);\n\n    // 1. Fetch Parlor Details (MOCKING API CALL)\n    const { data: parlorDetail, isLoading: parlorLoading } = useQuery({\n        queryKey: [\"parlor-detail\", parlorId],\n        queryFn: () => {\n            // FIX: Find the correct parlor by ID from the list\n            const foundParlor = mockBeautyParlors.find(p => p.id === parlorId);\n\n            if (foundParlor) {\n                // Attach the menu data to the found parlor\n                return Promise.resolve({ ...foundParlor, menuData: NESTED_SERVICES });\n            }\n            // If ID not found, return null\n            return Promise.resolve(null); \n        },\n        enabled: !!parlorId, // Only run if parlorId exists\n    });\n\n    const parlorMenu = parlorDetail?.menuData || {};\n\n    // 2. Derive Sub-Categories based on selected Main Category\n    const subCategories = useMemo(() => {\n        if (!selectedMainCat || !parlorMenu[selectedMainCat]) return [];\n        return parlorMenu[selectedMainCat]; \n    }, [selectedMainCat, parlorMenu]);\n\n    // 3. Derive Final Services based on selected Sub-Category\n    const finalServices = useMemo(() => {\n        if (!selectedSubCat || subCategories.length === 0) return [];\n\n        const selectedSubCatObject = subCategories.find((cat: any) => cat.name === selectedSubCat);\n\n        if (!selectedSubCatObject) return [];\n\n        if (selectedSubCatObject.subCategories) {\n            // Handle nested sub-categories (like Haircuts inside Haircut & Styling)\n            return selectedSubCatObject.subCategories.flatMap((nestedCat: any) => nestedCat.items);\n        }\n\n        // Handle flat services (like Keratin Treatment inside Hair Treatments)\n        return selectedSubCatObject.services || [];\n\n    }, [selectedSubCat, subCategories]);\n\n\n    if (parlorLoading) {\n        return <div className=\"text-center py-20\"><p className=\"text-muted-foreground\">Loading parlor details...</p></div>;\n    }\n\n    // FIX: Error check to display \"not found\" state\n    if (!parlorDetail && !parlorLoading) { \n        return (\n            <div className=\"text-center py-20\">\n                <p className=\"text-red-500 font-semibold text-xl\">\n                    Parlor not found or invalid ID. ðŸ˜ž\n                </p>\n                <p className=\"text-muted-foreground mt-2\">\n                    Check the URL or return to the listing page.\n                </p>\n                <Button onClick={() => setLocation(\"/beauty\")} className=\"mt-4\">\n                    Go Back to Listing\n                </Button>\n            </div>\n        );\n    }\n\n    const handleMainCatChange = (value: string) => {\n        setSelectedMainCat(value);\n        setSelectedSubCat(null); // Reset sub-category\n    };\n\n    const handleSubCatChange = (value: string) => {\n        setSelectedSubCat(value);\n    };\n\n    return (\n        <div className=\"py-8 md:py-12 bg-gray-50 min-h-screen\">\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n\n                {/* Header and Back Button */}\n                <Button\n                    variant=\"ghost\"\n                    className=\"mb-6 flex items-center space-x-2\"\n                    onClick={() => setLocation(\"/beauty\")}\n                    data-testid=\"button-back\"\n                >\n                    <ArrowLeft className=\"h-4 w-4\" />\n                    <span>Back to Parlor List</span>\n                </Button>\n\n                {/* Parlor Banner/Detail Header */}\n                <Card className=\"mb-8 p-0 overflow-hidden\">\n                    <img src={parlorDetail.image} alt={parlorDetail.name} className=\"w-full h-48 object-cover\"/>\n                    <CardContent className=\"p-6\">\n                        <div className=\"flex justify-between items-start\">\n                            <div>\n                                <h2 className=\"text-3xl font-bold mb-1\">{parlorDetail.name}</h2>\n                                <p className=\"text-sm text-muted-foreground\">{parlorDetail.description}</p>\n                            </div>\n                            <Badge variant=\"default\" className=\"text-base flex items-center px-3 py-1\">\n                                <Star className=\"h-4 w-4 fill-current mr-1\" /> {parlorDetail.rating}\n                            </Badge>\n                        </div>\n                        <div className=\"flex items-center space-x-4 mt-3 text-sm text-muted-foreground\">\n                            <div className=\"flex items-center space-x-1\">\n                                <MapPin className=\"h-4 w-4\" />\n                                <span>{parlorDetail.address}</span>\n                            </div>\n                            <span>â€¢</span>\n                            <span>{parlorDetail.distance}</span>\n                        </div>\n                    </CardContent>\n                </Card>\n\n                {/* FILTERING SECTION (Electrician Style Dropdowns) */}\n                <Card className=\"mb-8\">\n                    <CardContent className=\"p-6\">\n                        <h3 className=\"text-xl font-semibold mb-4\">Book a Service</h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n\n                            {/* 1. Main Category Dropdown (Hair, Nail, Skin) */}\n                            <div>\n                                <label className=\"text-sm font-medium mb-1 block\">Main Category</label>\n                                <Select onValueChange={handleMainCatChange} value={selectedMainCat || \"\"}>\n                                    <SelectTrigger>\n                                        <SelectValue placeholder=\"Select Category (e.g., Hair Services)\" />\n                                    </SelectTrigger>\n                                    <SelectContent>\n                                        {MAIN_CATEGORIES.map((catName) => (\n                                            <SelectItem key={catName} value={catName}>\n                                                {catName}\n                                            </SelectItem>\n                                        ))}\n                                    </SelectContent>\n                                </Select>\n                            </div>\n\n                            {/* 2. Sub-Category Dropdown (Haircut & Styling, Treatments) */}\n                            <div>\n                                <label className=\"text-sm font-medium mb-1 block\">Sub Category</label>\n                                <Select \n                                    onValueChange={handleSubCatChange} \n                                    value={selectedSubCat || \"\"} \n                                    disabled={!selectedMainCat}\n                                >\n                                    <SelectTrigger>\n                                        <SelectValue placeholder={selectedMainCat ? \"Select Sub Category\" : \"Select Main Category First\"} />\n                                    </SelectTrigger>\n                                    <SelectContent>\n                                        {subCategories.map((subCat: any) => (\n                                            <SelectItem key={subCat.name} value={subCat.name}>\n                                                {subCat.name}\n                                            </SelectItem>\n                                        ))}\n                                    </SelectContent>\n                                </Select>\n                            </div>\n\n                            {/* 3. Empty Slot (Optional: Can be used for Gender/Price Filter) */}\n                            <div className=\"flex items-end\">\n                                <Button variant=\"secondary\" className=\"w-full\">\n                                    <ChevronDown className=\"h-4 w-4 mr-2\" /> More Filters\n                                </Button>\n                            </div>\n                        </div>\n                    </CardContent>\n                </Card>\n\n                {/* SERVICE LISTING (Filtered Results) */}\n                <div>\n                    <h3 className=\"text-2xl font-bold mb-4\">\n                        {selectedSubCat || \"Full Service Menu\"} Menu ({finalServices.length})\n                    </h3>\n\n                    <div className=\"space-y-4\">\n                        {finalServices.length === 0 && selectedSubCat ? (\n                            <Card><CardContent className=\"p-6 text-center text-muted-foreground\">No services found in this sub-category. Please try a different selection.</CardContent></Card>\n                        ) : finalServices.length === 0 && !selectedSubCat ? (\n                            // Show initial prompt when no filter is selected\n                             <Card><CardContent className=\"p-6 text-center text-muted-foreground\">Please use the dropdowns above to browse the specific services offered by the parlor.</CardContent></Card>\n                        ) : (\n                            finalServices.map((service: any) => (\n                                <ServiceItemCard \n                                    key={service.id} \n                                    parlorId={parlorId} \n                                    service={service} \n                                    subCategoryName={selectedSubCat || \"Services\"}\n                                />\n                            ))\n                        )}\n\n                        {/* Beautician Add Option at the bottom */}\n                        <div className=\"pt-4 border-t border-dashed border-gray-300\">\n                             <Button size=\"sm\" variant=\"outline\" className=\"text-primary hover:bg-primary/10\">\n                                <Plus className=\"h-4 w-4 mr-2\" /> Add New Service (Beautician View)\n                            </Button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}","size_bytes":14039},"client/src/pages/login.tsx":{"content":"// client/src/pages/login.tsx (THE ULTIMATE FINAL FIX)\n\nimport React from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Link, useLocation } from \"wouter\";\nimport { useQueryClient } from '@tanstack/react-query';\nimport { Loader2 } from 'lucide-react';\n\nconst loginSchema = z.object({\n  username: z.string().min(1, { message: \"Username is required.\" }),\n  password: z.string().min(1, { message: \"Password is required.\" }),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nconst Login: React.FC = () => {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const queryClient = useQueryClient();\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n    },\n  });\n\n  const onSubmit = async (data: LoginFormData) => {\n    try {\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", data);\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        // Yeh line \"Invalid Credentials\" ka error toast me dikhayegi\n        throw new Error(errorData.message || \"Login failed\");\n      }\n\n      const responseData = await response.json();\n      const loggedInUser = responseData.user;\n\n      if (loggedInUser) {\n        toast({ title: \"Success\", description: \"Logged in successfully!\" });\n\n        // User ki details ko refresh karo\n        await queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n        await queryClient.refetchQueries({ queryKey: ['/api/auth/me'] });\n\n        // Aur phir redirect karo\n        if (loggedInUser.role === 'provider') {\n          setLocation(\"/provider/dashboard\");\n        } else {\n          setLocation(\"/\");\n        }\n      } else {\n        // Yeh case tabhi aayega jab server se 'user' object na mile\n        throw new Error(\"User data not found in login response.\");\n      }\n\n    } catch (error: any) {\n      // Yeh catch block ab har tarah ke error ko pakdega aur jhootha login nahi hone dega\n      console.error(\"Login error caught:\", error);\n      toast({\n        title: \"Login Failed\",\n        description: error.message || \"An unknown error occurred.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"flex items-center justify-center min-h-[calc(100vh-theme(spacing.16))]\">\n      <div className=\"w-full max-w-md p-8 space-y-6 bg-card text-card-foreground rounded-lg shadow-md\">\n        <h2 className=\"text-2xl font-bold text-center\">Login</h2>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"username\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Username</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Enter your username\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n            <FormField\n              control={form.control}\n              name=\"password\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Password</FormLabel>\n                  <FormControl>\n                    <Input type=\"password\" placeholder=\"********\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n            <Button type=\"submit\" className=\"w-full\" disabled={form.formState.isSubmitting}>\n              {form.formState.isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              {form.formState.isSubmitting ? 'Logging in...' : 'Login'}\n            </Button>\n          </form>\n        </Form>\n        <div className=\"text-center text-sm text-muted-foreground\">\n          Don't have an account?{\" \"}\n          <Link href=\"/signup\" className=\"text-primary hover:underline\">\n            Sign Up\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;","size_bytes":4474},"client/src/pages/PostProperty.tsx":{"content":"// src/pages/PostProperty.tsx\n\nimport { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { ArrowLeft } from \"lucide-react\";\n\nexport default function PostProperty() {\n    const [, setLocation] = useLocation();\n\n    return (\n        <div className=\"py-12 max-w-xl mx-auto\">\n            <Button variant=\"ghost\" onClick={() => setLocation(\"/rental\")} className=\"mb-6\">\n                <ArrowLeft className=\"h-4 w-4 mr-2\" /> Back to Rentals\n            </Button>\n            <h2 className=\"text-3xl font-bold mb-4\">List Your Property for Free</h2>\n            <p className=\"text-muted-foreground\">This is the form where owners will input property details, rent, and photos.</p>\n            {/* TO DO: Add your property submission form here */}\n        </div>\n    );\n}    ","size_bytes":808},"client/src/hooks/use-auth.tsx":{"content":"import { createContext, useContext, ReactNode } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\n\ninterface User {\n  id: string;\n  username: string;\n  email: string;\n  phone?: string;\n  role: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  logout: () => Promise<any>; // Changed to return a Promise\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [, setLocation] = useLocation();\n  const queryClient = useQueryClient();\n\n  const { data, isLoading } = useQuery({\n    queryKey: [\"/api/auth/me\"],\n    queryFn: async () => {\n        // Using fetch to get the current user\n        const res = await fetch(\"/api/auth/me\", { credentials: \"include\" });\n        if (!res.ok) {\n            // If the status is 401 (not authenticated), we don't throw an error,\n            // we just return null because it's an expected state.\n            if (res.status === 401) {\n                return null;\n            }\n            throw new Error(\"Failed to fetch user\");\n        }\n        return res.json();\n    },\n    retry: false, // Don't retry on failure\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // ðŸ’¥ BUG FIX #2 IS HERE ðŸ’¥\n  // This is the corrected logout mutation logic.\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      // We use standard 'fetch' for maximum reliability.\n      const response = await fetch(\"/api/auth/logout\", {\n        method: \"POST\",\n        // 'credentials: \"include\"' is essential for sending the session cookie.\n        credentials: \"include\",\n      });\n\n      // If the server gives an error, we throw an error to be caught by the caller.\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ message: 'Logout request failed' }));\n        throw new Error(errorData.message || 'Failed to logout');\n      }\n\n      // If everything is okay, return the server's response.\n      return response.json();\n    },\n    onSuccess: () => {\n      // On success, we manually set the user's data to 'null' in the client's cache.\n      // This instantly updates the UI without causing a confusing refetch.\n      queryClient.setQueryData([\"/api/auth/me\"], null);\n    },\n    onError: (error) => {\n      // For debugging, we log any errors that occur during the mutation.\n      console.error(\"Logout mutation error:\", error);\n    }\n  });\n\n  const user = data?.user || null;\n  const isAuthenticated = !!user;\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isLoading,\n        isAuthenticated,\n        // We now export 'mutateAsync' so the header component can 'await' it.\n        logout: () => logoutMutation.mutateAsync(),\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}","size_bytes":3133},"server/cloudinary.ts":{"content":"import { v2 as cloudinary } from 'cloudinary';\nimport { Readable } from 'stream';\n\n// Yeh code Replit Secrets se keys uthaakar Cloudinary se connection banayega\ncloudinary.config({ \n  cloud_name: process.env.CLOUDINARY_CLOUD_NAME, \n  api_key: process.env.CLOUDINARY_API_KEY, \n  api_secret: process.env.CLOUDINARY_API_SECRET,\n  secure: true,\n});\n\n// Yeh function file buffer lega aur usko Cloudinary par upload karega\nexport const uploadToCloudinary = (fileBuffer: Buffer): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    const uploadStream = cloudinary.uploader.upload_stream(\n      {\n        resource_type: 'image',\n        // Hum har photo ko optimize kar rahe hain taaki space bache\n        transformation: [{ width: 800, height: 800, crop: 'limit', quality: 'auto:good' }],\n      },\n      (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        if (result) {\n          resolve(result.secure_url); // Upload hone ke baad photo ka URL return karega\n        }\n      }\n    );\n\n    // Buffer ko stream me convert karke upload stream me bhej do\n    const readableStream = new Readable();\n    readableStream._read = () => {};\n    readableStream.push(fileBuffer);\n    readableStream.push(null);\n    readableStream.pipe(uploadStream);\n  });\n};","size_bytes":1295},"client/src/hooks/use-cart-store.ts":{"content":"// client/src/hooks/use-cart-store.ts (FIXED)\n\nimport { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\n// Define the type for a single item in the cart\ninterface CartItem {\n  id: string;\n  name: string;\n  price: number;\n  imageUrl?: string;\n  quantity: number;\n}\n\n// Define the state and actions for our cart store\ninterface CartState {\n  items: CartItem[];\n  addItem: (item: Omit<CartItem, 'quantity'>) => void;\n  removeItem: (itemId: string) => void;\n  // --- YEH NAINA ACTION ADD KIYA ---\n  updateQuantity: (itemId: string, amount: number) => void; \n  clearCart: () => void;\n  getItemCount: () => number;\n  getTotalPrice: () => number;\n}\n\nexport const useCartStore = create<CartState>()(\n  persist(\n    (set, get) => ({\n      items: [],\n\n      // Action to add an item to the cart\n      addItem: (newItem) => {\n        const existingItem = get().items.find((item) => item.id === newItem.id);\n\n        if (existingItem) {\n          // Agar item pehle se hai, toh updateQuantity ko call karo\n          get().updateQuantity(newItem.id, 1);\n        } else {\n          // Naya item hai, quantity 1 ke saath add karo\n          set((state) => ({\n            items: [...state.items, { ...newItem, quantity: 1 }],\n          }));\n        }\n      },\n\n      // Action to remove an item from the cart\n      removeItem: (itemId) => {\n        set((state) => ({\n          items: state.items.filter((item) => item.id !== itemId),\n        }));\n      },\n\n      // --- YEH HAI POORA NAYA LOGIC ---\n      // Action to update quantity (increase or decrease)\n      updateQuantity: (itemId, amount) => {\n        set((state) => ({\n          items: state.items\n            .map((item) => {\n              if (item.id === itemId) {\n                const newQuantity = item.quantity + amount;\n                // Agar quantity 0 ya usse kam ho jaye, toh item ko remove kar do\n                if (newQuantity <= 0) {\n                  return null; // Isko baad me filter kar denge\n                }\n                return { ...item, quantity: newQuantity };\n              }\n              return item;\n            })\n            .filter((item): item is CartItem => item !== null), // null items ko hata do\n        }));\n      },\n      // --- NAYA LOGIC YAHAN KHATAM ---\n\n      // Action to clear the entire cart\n      clearCart: () => {\n        set({ items: [] });\n      },\n\n      // Function to get the total number of items in the cart\n      getItemCount: () => {\n        return get().items.reduce((total, item) => total + item.quantity, 0);\n      },\n\n      // Function to calculate the total price of all items\n      getTotalPrice: () => {\n        return get().items.reduce((total, item) => total + item.price * item.quantity, 0);\n      },\n    }),\n    {\n      name: 'cart-storage', // This name is used for saving the cart in local storage\n    }\n  )\n);","size_bytes":2850},"client/src/components/forms/MenuItemForm.tsx":{"content":"// client/src/components/forms/MenuItemForm.tsx (FIXED API CALLS)\n\nimport React, { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport * as z from \"zod\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport api from \"@/lib/api\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Loader2 } from \"lucide-react\";\n\n// --- Schemas and Options (Yeh sab waise hi rahenge) ---\nconst beautyCategories = [ { value: \"Hair\", label: \"Hair Services\" }, { value: \"Skin\", label: \"Skin Care\" }, { value: \"Nails\", label: \"Nail Care\" }, { value: \"Makeup\", label: \"Makeup\" }, { value: \"Spa\", label: \"Spa & Massage\" }, { value: \"Bridal\", label: \"Bridal Services\" }, ];\nconst beautySubCategories = { Hair: [{ value: \"Haircut_Men\", label: \"Haircut (Men)\" }, { value: \"Haircut_Women\", label: \"Haircut (Women)\" }, { value: \"Hair_Spa\", label: \"Hair Spa\" }, { value: \"Hair_Color\", label: \"Hair Color\" }], Skin: [{ value: \"Facial_Gold\", label: \"Facial (Gold)\" }, { value: \"Facial_Fruit\", label: \"Facial (Fruit)\" }, { value: \"Cleanup\", label: \"Cleanup\" }, { value: \"Bleach\", label: \"Bleach\" }], Nails: [{ value: \"Manicure\", label: \"Manicure\" }, { value: \"Pedicure\", label: \"Pedicure\" }], };\nconst foodCategories = [ { value: \"Snacks\", label: \"Snacks\" }, { value: \"Main_Course\", label: \"Main Course\" }, { value: \"Beverages\", label: \"Beverages\" }, { value: \"Desserts\", label: \"Desserts\" }, ];\nconst spicyLevels = [ { value: \"Mild\", label: \"Mild\" }, { value: \"Medium\", label: \"Medium\" }, { value: \"Hot\", label: \"Hot\" }, { value: \"Extra_Hot\", label: \"Extra Hot\" }, ];\nconst cakeCategories = [ { value: \"Birthday\", label: \"Birthday Cakes\" }, { value: \"Anniversary\", label: \"Anniversary Cakes\" }, { value: \"Wedding\", label: \"Wedding Cakes\" }, { value: \"Custom\", label: \"Custom Cakes\" }, { value: \"Cupcakes\", label: \"Cupcakes & Pastries\" }, ];\nconst restaurantCategories = [ { value: \"Starters\", label: \"Starters\" }, { value: \"Main_Course\", label: \"Main Course\" }, { value: \"Desserts\", label: \"Desserts\" }, { value: \"Beverages\", label: \"Beverages\" }, { value: \"Soups\", label: \"Soups\" }, ];\n\n// --- YEH NAYA SCHEMA HAI 'GROCERY' KE LIYE ---\nconst groceryCategories = [ { value: \"fruits\", label: \"Fruits\" }, { value: \"vegetables\", label: \"Vegetables\" }, { value: \"dairy\", label: \"Dairy\" }, { value: \"bakery\", label: \"Bakery\" }, { value: \"snacks\", label: \"Snacks\" }, { value: \"beverages\", label: \"Beverages\" }, { value: \"staples\", label: \"Staples\" }, { value: \"toiletries\", label: \"Toiletries\" }, { value: \"personal-care\", label: \"Personal Care\" }, ];\n\nconst baseSchema = z.object({ name: z.string().min(2, { message: \"Name must be at least 2 characters.\" }), description: z.string().optional(), imageUrl: z.string().url({ message: \"Invalid URL\" }).optional().or(z.literal(\"\")), price: z.string().regex(/^\\d+(\\.\\d{1,2})?$/, { message: \"Invalid price format\" }), });\nconst beautySchema = baseSchema.extend({ duration: z.string().regex(/^\\d+$/, { message: \"Duration must be a number in minutes.\" }).optional().or(z.literal(\"\")), category: z.enum(beautyCategories.map(c => c.value) as [string, ...string[]], { message: \"Please select a category.\" }), subCategory: z.string().optional(), });\nconst foodSchema = baseSchema.extend({ isVeg: z.boolean().default(true).optional(), spicyLevel: z.enum(spicyLevels.map(s => s.value) as [string, ...string[]]).optional(), category: z.enum(foodCategories.map(c => c.value) as [string, ...string[]], { message: \"Please select a category.\" }), });\nconst cakeSchema = baseSchema.extend({ category: z.enum(cakeCategories.map(c => c.value) as [string, ...string[]], { message: \"Please select a category.\" }), });\nconst restaurantSchema = baseSchema.extend({ isVeg: z.boolean().default(true).optional(), category: z.enum(restaurantCategories.map(c => c.value) as [string, ...string[]], { message: \"Please select a category.\" }), cuisine: z.string().optional(), });\n\n// --- YEH NAYA SCHEMA HAI 'GROCERY' KE LIYE ---\nconst grocerySchema = baseSchema.extend({\n  category: z.enum(groceryCategories.map(c => c.value) as [string, ...string[]], { message: \"Please select a category.\" }),\n  weight: z.string().optional(),\n  unit: z.string().optional(),\n  inStock: z.boolean().default(true).optional(),\n  stockQuantity: z.string().regex(/^\\d+$/, { message: \"Stock must be a number.\" }).optional().or(z.literal(\"\")),\n});\n\ntype FormValues = z.infer<typeof baseSchema> & z.infer<typeof beautySchema> & z.infer<typeof foodSchema> & z.infer<typeof cakeSchema> & z.infer<typeof restaurantSchema> & z.infer<typeof grocerySchema>;\ntype MenuItemFormProps = { providerId: string; categorySlug: string; initialData?: any; onSuccess: () => void; };\n\nconst MenuItemForm: React.FC<MenuItemFormProps> = ({ providerId, categorySlug, initialData, onSuccess }) => {\n  const { toast } = useToast();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [currentSubCategories, setCurrentSubCategories] = useState<{value: string; label: string;}[]>([]);\n\n  const getSchema = () => {\n    switch (categorySlug) {\n      case \"beauty\": return beautySchema;\n      case \"street-food\": return foodSchema;\n      case \"cake-shop\": return cakeSchema;\n      case \"restaurants\": return restaurantSchema;\n      case \"grocery\": return grocerySchema; // --- 'GROCERY' ADD KIYA ---\n      default: return baseSchema;\n    }\n  };\n\n  // Default values ko bhi update kiya\n  const form = useForm<FormValues>({\n    resolver: zodResolver(getSchema()),\n    defaultValues: initialData ? {\n        ...initialData,\n        price: initialData.price?.toString(),\n        duration: initialData.duration_minutes?.toString(),\n        stockQuantity: initialData.stockQuantity?.toString(),\n        isVeg: initialData.isVeg ?? true,\n        inStock: initialData.inStock ?? true,\n    } : { isVeg: true, inStock: true },\n  });\n\n  useEffect(() => {\n    form.reset(initialData ? {\n        ...initialData,\n        price: initialData.price?.toString(),\n        duration: initialData.duration_minutes?.toString(),\n        stockQuantity: initialData.stockQuantity?.toString(),\n        isVeg: initialData.isVeg ?? true,\n        inStock: initialData.inStock ?? true,\n    } : { isVeg: true, inStock: true });\n\n    if (categorySlug === \"beauty\" && initialData?.category) {\n        setCurrentSubCategories(beautySubCategories[initialData.category as keyof typeof beautySubCategories] || []);\n    }\n  }, [initialData, categorySlug, form]);\n\n  const selectedCategory = form.watch(\"category\");\n  useEffect(() => {\n    if (categorySlug === \"beauty\" && selectedCategory) {\n      setCurrentSubCategories(beautySubCategories[selectedCategory as keyof typeof beautySubCategories] || []);\n      if (!initialData || selectedCategory !== initialData.category) {\n        form.setValue(\"subCategory\", \"\");\n      }\n    } else {\n      setCurrentSubCategories([]);\n    }\n  }, [selectedCategory, categorySlug, form, initialData]);\n\n  // --- BUG FIX 3: onSubmit FUNCTION POORA FIX KAR DIYA ---\n  const onSubmit = async (values: FormValues) => {\n    setIsSubmitting(true);\n    try {\n      // Common payload banaya\n      const payload: any = {\n        name: values.name,\n        description: values.description || null,\n        imageUrl: values.imageUrl || null,\n        price: parseFloat(values.price),\n        category: values.category || null,\n      };\n\n      // Category-specific payload add kiya\n      if (categorySlug === \"beauty\") {\n        payload.duration_minutes = values.duration ? parseInt(values.duration) : null;\n        payload.subCategory = values.subCategory || null;\n      } else if (categorySlug === \"street-food\" || categorySlug === \"restaurants\") {\n        payload.isVeg = values.isVeg;\n        if (categorySlug === \"street-food\") {\n          payload.spicyLevel = values.spicyLevel || null;\n        }\n        if (categorySlug === \"restaurants\") {\n          payload.cuisine = values.cuisine || null;\n        }\n      } else if (categorySlug === \"grocery\") {\n        payload.weight = values.weight || null;\n        payload.unit = values.unit || null;\n        payload.inStock = values.inStock;\n        payload.stockQuantity = values.stockQuantity ? parseInt(values.stockQuantity) : 0;\n      }\n\n      // API call ko theek kiya\n      if (initialData) {\n        // --- YEH HAI FIX (Update) ---\n        await api.patch(`/provider/menu-items/${categorySlug}/${initialData.id}`, payload);\n        toast({ title: \"Success\", description: \"Menu item updated.\" });\n      } else {\n        // --- YEH HAI FIX (Create) ---\n        await api.post(`/provider/menu-items/${categorySlug}`, payload);\n        toast({ title: \"Success\", description: \"Menu item added.\" });\n      }\n      onSuccess(); // Yeh function Dialog ko band karega aur list refresh karega\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.response?.data?.message || \"Failed to save.\",\n        variant: \"destructive\",\n      });\n    } finally {\n        setIsSubmitting(false);\n    }\n  };\n\n  return (\n    // Form JSX poora copy paste kiya hai (sirf 'grocery' ke fields add kiye hain)\n    <div className=\"max-h-[70vh] overflow-y-auto pr-6 pl-2 -ml-2\">\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Name</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"Service or Item Name\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Description</FormLabel>\n                  <FormControl>\n                    <Textarea placeholder=\"Describe the service/item\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"imageUrl\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Image URL (Optional)</FormLabel>\n                  <FormControl>\n                    <Input placeholder=\"https://...\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"price\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Price (â‚¹)</FormLabel>\n                  <FormControl>\n                    <Input type=\"text\" placeholder=\"e.g., 500.00\" {...field} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* --- Category Specific Fields --- */}\n\n            {categorySlug === \"beauty\" && (\n              <>\n                <FormField\n                  control={form.control}\n                  name=\"duration\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Duration (minutes)</FormLabel>\n                      <FormControl>\n                        <Input type=\"number\" placeholder=\"e.g., 60\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select a category\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {beautyCategories.map((cat) => (\n                            <SelectItem key={cat.value} value={cat.value}>\n                              {cat.label}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                {currentSubCategories.length > 0 && (\n                  <FormField\n                    control={form.control}\n                    name=\"subCategory\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Sub-Category</FormLabel>\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <FormControl>\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select a sub-category\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            {currentSubCategories.map((subCat) => (\n                              <SelectItem key={subCat.value} value={subCat.value}>\n                                {subCat.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                )}\n              </>\n            )}\n\n            {/* --- YEH NAYA BLOCK HAI 'GROCERY' KE LIYE --- */}\n            {categorySlug === \"grocery\" && (\n              <>\n                <FormField\n                  control={form.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select a category\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {groceryCategories.map((cat) => (\n                            <SelectItem key={cat.value} value={cat.value}>\n                              {cat.label}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <div className=\"grid grid-cols-2 gap-4\">\n                    <FormField\n                    control={form.control}\n                    name=\"weight\"\n                    render={({ field }) => (\n                        <FormItem>\n                        <FormLabel>Weight (Optional)</FormLabel>\n                        <FormControl>\n                            <Input placeholder=\"e.g., 500g\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                        </FormItem>\n                    )}\n                    />\n                    <FormField\n                    control={form.control}\n                    name=\"unit\"\n                    render={({ field }) => (\n                        <FormItem>\n                        <FormLabel>Unit (Optional)</FormLabel>\n                        <FormControl>\n                            <Input placeholder=\"e.g., kg, pack\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                        </FormItem>\n                    )}\n                    />\n                </div>\n                 <FormField\n                  control={form.control}\n                  name=\"stockQuantity\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Stock Quantity</FormLabel>\n                      <FormControl>\n                        <Input type=\"number\" placeholder=\"e.g., 100\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"inStock\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                      <div className=\"space-y-0.5\">\n                        <FormLabel>In Stock?</FormLabel>\n                      </div>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n              </>\n            )}\n            {/* --- NAYA BLOCK KHATAM --- */}\n\n\n            {(categorySlug === \"street-food\" || categorySlug === \"restaurants\") && (\n              <>\n                <FormField\n                  control={form.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select a category\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {(categorySlug === \"street-food\" ? foodCategories : restaurantCategories).map((cat) => (\n                            <SelectItem key={cat.value} value={cat.value}>\n                              {cat.label}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"isVeg\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                      <div className=\"space-y-0.5\">\n                        <FormLabel>Vegetarian?</FormLabel>\n                      </div>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n              </>\n            )}\n\n            {categorySlug === \"street-food\" && (\n              <FormField\n                control={form.control}\n                name=\"spicyLevel\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Spicy Level</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select spicy level\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {spicyLevels.map((level) => (\n                          <SelectItem key={level.value} value={level.value}>\n                            {level.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            )}\n\n            {categorySlug === \"restaurants\" && (\n              <FormField\n                control={form.control}\n                name=\"cuisine\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Cuisine</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"e.g., Indian, Chinese\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            )}\n\n            {categorySlug === \"cake-shop\" && (\n              <FormField\n                control={form.control}\n                name=\"category\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Category</FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select a cake category\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {cakeCategories.map((cat) => (\n                          <SelectItem key={cat.value} value={cat.value}>\n                            {cat.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            )}\n\n            <Button type=\"submit\" className=\"w-full\" disabled={isSubmitting}>\n              {isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              {initialData ? \"Update Item\" : \"Add Item\"}\n            </Button>\n          </form>\n        </Form>\n    </div>\n  );\n};\n\nexport default MenuItemForm;","size_bytes":22612},"client/src/lib/api.ts":{"content":"// client/src/lib/api.ts (OVERWRITE THIS FILE)\nimport axios from \"axios\";\n\n// Ek standard axios instance create kar rahe hain\nconst api = axios.create({\n  baseURL: \"/api\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n  withCredentials: true, // Yeh session cookies (login) ko bhej ne ke liye important hai\n});\n\n// Response interceptor error handling ke liye\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    // Agar server se error message aata hai, toh usko throw karo\n    if (error.response && error.response.data && error.response.data.message) {\n      return Promise.reject(new Error(error.response.data.message));\n    }\n    // Warna default error\n    return Promise.reject(error);\n  }\n);\n\n// Hum 'api' ko as a default export bhej rahe hain\nexport default api;","size_bytes":803},"server/razorpay-client.ts":{"content":"// server/razorpay-client.ts (NEW FILE)\n\nimport Razorpay from 'razorpay';\nimport crypto from 'crypto';\n\nif (!process.env.RAZORPAY_KEY_ID || !process.env.RAZORPAY_KEY_SECRET) {\n  console.warn('!!! Razorpay environment variables (KEY_ID, KEY_SECRET) not set. Payment API will fail.');\n}\n\nexport const razorpayInstance = new Razorpay({\n  key_id: process.env.RAZORPAY_KEY_ID!,\n  key_secret: process.env.RAZORPAY_KEY_SECRET!,\n});\n\n/**\n * Verifies the Razorpay payment signature\n * @param orderId - The Razorpay Order ID\n * @param paymentId - The Razorpay Payment ID\n * @param signature - The signature received from frontend\n * @returns boolean\n */\nexport function verifyPaymentSignature(orderId: string, paymentId: string, signature: string): boolean {\n  const hmac = crypto.createHmac('sha256', process.env.RAZORPAY_KEY_SECRET!);\n  hmac.update(orderId + \"|\" + paymentId);\n  const generatedSignature = hmac.digest('hex');\n\n  return generatedSignature === signature;\n}\n\n/**\n * Verifies the Razorpay webhook signature\n * @param rawBody - The raw request body\n * @param signature - The signature from 'X-Razorpay-Signature' header\n * @returns boolean\n */\nexport function verifyWebhookSignature(rawBody: string, signature: string): boolean {\n  if (!process.env.RAZORPAY_WEBHOOK_SECRET) {\n    console.warn('RAZORPAY_WEBHOOK_SECRET not set. Webhook verification will fail.');\n    return false;\n  }\n\n  const hmac = crypto.createHmac('sha256', process.env.RAZORPAY_WEBHOOK_SECRET!);\n  hmac.update(rawBody);\n  const generatedSignature = hmac.digest('hex');\n\n  return generatedSignature === signature;\n}","size_bytes":1589}},"version":2}